如何手工打造一款公平的年会抽奖软件（一）

副标题：祝你年年中奖，天天好运~



又到年底了，要和2020年说再见了。

小伙伴儿们，你们年初立的 flag 完成得如何？

这个问题有点扎心哈，不过别伤心，还有其他能让你开心的事儿，比如年会抽奖。

嘿嘿，是不是立刻衣可赛艇起来了呢？



没错，每逢公司年会，各路神仙哥哥姐姐们都会从四面八方汇集亲临现场，互相鼓励互相祝福。

那一幕幕感人至深的画面，和各自的小心思形成了巨大的反差，其实他们都自带一把小算盘，只希望天下最幸运的是自己，哪还有别人的份儿啊。

理想很丰满，现实很骨干，为什么中奖的总不是我呢？

内心的呼唤，无情的呐喊，然而公司却依然保持着它独有的原生态抽奖方式--直接用手抓纸条。



终于，有那么一天，员工们都站了起来，表情紧张、严肃。

不是桌上的饭菜不可口，而是打心里强烈表示不服：“抓个鬼哦，怪不得老子总是中不了奖！”

事后，公司领导痛定思痛，下定决心势必要改变这惨痛的现状，向着文明迈出坚实的步伐。

一咬牙一跺脚，宁可酒桌上少吃几口菜少喝几盅酒，说什么也要把公平抽奖软件搞出来！

还多说什么呢，这么关乎员工利益和公司声誉的头等大事，当然要我亲自来挑担子了。

在此我们谢过领导，我谢谢你们！





好了，我们差不得该回到正题，说说这个令人向往的公平抽奖软件吧。

公平抽奖软件，首先它得是个抽奖软件，对吧？

那么它至少要具备以下几项特点。

1、有一个华丽的界面

2、人员和奖项的数据导入

3、抽奖结果的导出和重置

4、开始和停止抽奖的触发动作



行了，基本的思路有了，先搭个架子出来看看吧。

我用VB搞了一个窗体作抽奖界面，背景弄得张灯结彩，煞是喜庆。

图1



然后再来了几个菜单项，先是数据导入。

图2



再有结果重置导出。

图3



除了上面这些基本功能外，还必需加些其他功能。

比如界面上这些个控件的坐标，不同的显示器（投影）高矮胖瘦都不一样，总归是要调整一番才有个可人的模样。

图4



##### 

还有抽奖时数字滚动的效果，不用多说，这个等待摇奖停止的过程才是最让人激动，最让人感觉生活还是挺有盼头的。

最简单的数字滚动效果。

先定义一个 `Timer` 控件，命名为 `tmrLuckDraw` ，然后随机生成9位数字，显示到标签 `lblCardID` 上。

当 `tmrLuckDraw.Interval = 1` 时即可触发滚动效果，这个数值越大，数字滚动得越慢。

```vb
On Error Resume Next

If booStart = False Then tmrLuckDraw.Interval = 0: Exit Sub

lngRndCircle = Format(RndNum(999999999), "000000000")
lblCardId.Caption = lngRndCircle
lblCardId.Refresh
```




