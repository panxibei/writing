B4X

副标题：

英文：

关键字：



`Visual Basic` 简称 `VB` ，曾经是微软出品的一款非常流行、非常经典的编程语言。

即使现在来说有点过时，但提起它的大名，可以说是无人不知无人不晓啊！

想当年微软可以说是倾注了相当大的心血才造就了经典的 `VB` ，然而时过境迁，由于各种缘由微软不得不忍痛放弃了这个当年大力培养的优秀孩子。

但是经典就是经典，盖不住它的光芒，至今 `VB` 仍有大批拥趸，而且官方也明里暗里地表示新登场的 `Windows 11` 也将继续支持 `VB` 。



然而 `VB` 即使堪称经典，但使用上各种的不如意也时常被众多网友所诟病，这些现实问题使得 `Visual Basic` 完全成为一个既让人爱又让人恨的存在。

因此，一时间打着 `Visual Basic` 旗号的各种不同来路的“山寨”编程语言如雨后春笋般地冒了出来。

这不前一阵有小伙伴向我推荐了一款名叫 `B4X` 的同样是号称 `Visual Basic` 的编程语言。

也不知道是不是蹭 `Visual Basic` 名气，还是说的确是真 `Visual Basic` 而有点东西。

于是我就找来相关资料体验了起来......



### 官网及简介

打开官网首页，看到关于 `B4X` 的介绍。

> https://www.b4x.com

图f01



`B4X` 是一款套件工具的总称，支持多个跨平台系统，支持 `Visual Basic` 语法，简洁而强大。

哦，原来这个 `B4X` 是一组编程工具的组合，支持的操作系统还挺多，包括 `Windows` 、 `Linux` 和 `MacOS` ，甚至是 `Android` 、`iOS` 等等更多。

相应的工具软件就有 `B4A` 、`B4i` 、 `B4J` 以及 `B4R` 。

* `B4A` - 安卓
* `B4i` - `iOS`
* `B4J` - 桌面系统、服务器系统或树莓派等（`Windows` 、 `Linux` ）
* `B4R` - `Arduino & ESP8266 boards`

图f02



这个就比较牛了，没想到 `Visual Basic` 还能这么玩跨平台啊！

看来的确应该尝试一下了。

这里需要多说一嘴，这老几位有的免费有的要收费。

比如 `B4J` 就是免费的，而 `B4A` 原先是收费的，现在已经免费使用了。



虽然 `B4A` 现在免费了，我们可以用它来写安卓程序了，不过为了给小伙伴们做演示，我还是用 `B4J` ，也就是在 `Windows` 平台上的 `B4X` 吧！



### 下载

来到 `B4X` 官网，点击顶部菜单的产品 `PRODUCTS` 一项，找到 `B4J` 并点击。

在下载页面直接下载完整版即可。

图f03



**B4J.exe(18M)**

下载链接：





### 安装

虽然我们下载的 `B4J.exe` 是个可执行文件，但是千万不要直接双击它安装。

为啥？因为我们需要先安装其他组件：`Java` 。

哈哈，是不是瞬间明白了？

没错，可能有的小伙伴已经猜出来了，这个 `B4X` 就是依赖 `Java` 实现跨平台的。



组件安装有两种方法，一种是 `JDK 11` + `OpenJFX 11` ，还有一种是 `JDK 8` 。

两种方法择其一即可，如果你想要成功编译出 `exe` 程序，建议安装前者。

我们下载官网提供的打包程序 `jdk-11.0.1.zip` ，这个包比较大，也可以下载我保存在本地的备份。

注意哦，这个 `Java 11+` 包如果不是从 `B4X` 官网下载的将无法正常工作！



**jdk-11.0.1.zip(253.85M)**

下载链接：



下载完成后，将其解压缩到某处，比如 `C:\jdk-11.0.1` 。

接下来我们就可以安装 `B4J.exe` 了，过程是灰常简单。

图a01

图a02

图a03

图a04

图a05





### 使用前的准备

OK，安装完成！

我们启动它看看！

图b01



查看关于，简介上赫然写着“哪都能用”！

图b02



英文界面太伤眼？这样换！

点击顶部菜单 `Tools` ，依次找到 `IDE Options` > `Language` > `Simplified Chinese(简体中文)` 。

图b03



最后就是这个样子，眼前瞬间清爽了很多啊！

图b04



好了，这样子我们就可以开始使用了吗？

No No，我们还有一点点小工作要做，还记得前面安装的 `Java` 组件吗？

是的，我们要给 `B4J` 指明 `Jdk` 路径。



点击顶部菜单 `工具` ，找到并点击 `配置路径(F)` 。

图c01



浏览并填写 `javac.exe` 在所在路径并确定。

注：此处路径指定的是 `jdk1.8` ，实际上你应该填写 `jdk11` ，至于为啥这样，后面会有解释。

图c02



### 用用看，代码跑得起来吗？

找一个示例代码，编译看看，程序正常启动，果然没问题哈！

图c03

图c04



这是一个猜数字游戏示例代码，更多的示例代码可以到官网找到。

我这有一份找到的 `B4X` 示例代码集，提供给需要学习的小伙伴们。



**B4X_Examples.zip(44.9K)**

下载链接：



### 尝试自己写代码

我们新建一个项目，点击菜单 `文件` > `新建` ，选择 `界面设计（JAVAFX）` 。

图d01



给新建项目找个合适的地方，并且起个好听的名字吧！

图d02



项目建立好了，编辑窗口中就已经为我们准备好了部分代码。

图d03



我们点击快捷工具栏中的运行图标，程序跑起来了！

点击按钮，弹出提示信息。

图d04



我们依葫芦画瓢，修改消息内容。

图d05

图d06



话说既然打着 `Virtual Basic` 的旗号，那么界面设计是怎么整的呢？

在这儿呢！

点击顶部菜单 `设计器` ，找到 `启动内部设计器(D)` 。

图d07



很快， `B4X` 为我们打开了可视化设计器。

图d08



我们看到当前的 `Form` 就在这里，那怎么操作窗体上的控件呢？

原来在左侧栏内有各个控件，我们可以点击它们来设定它们的属性。

比如修改按钮的 `Text` 属性，将按钮文字由 `Click Me` 改成中文的 `点击我！` 。

图d09

图d10



还有，现在窗体上只有一个按钮孤零零的，我想添加其他控件怎么整呢？

点击菜单上的 `添加控件(A)` ，好家伙，原来都在这儿呢！

我们尝试添加一个文本框看看。

图d11

图d12



回到代码窗口，我们用代码给刚才添加的文本框赋值。

图d13



运行程序，果然OK哈！真心简单有木有！

图d14





### 构建独立软件包

当我们的代码测试OK没有任何问题后，接下来所要做的自然就是将程序打包发布了。

怎么打包呢？

很简单，依次点击菜单项 `项目` > `构建独立的软件包` 。

图e01



接下来就坐等程序编译完成？

NO NO，你想错了！

它很有可能会给你脸色看！

图e02



需要 `Java 11+` 是什么鬼？

猛查资料，才发现要想打包成功，必须安装 `Java 11` 以上的版本，否则不好使！

其实前面在安装的时候，我们就已经建议大家直接安装 `jdk11` 了，这也正是选择它的原因了。



好吧，从网上下载到了打包好的 `Java 11` 程序包，将不需要的 `Java` 版本卸载删除，然后把下载好的 `Java 11` 给解压缩，并放到某个地方。

比如我将它放在了 `C` 盘根目录。

```
C:\jdk-11.0.1
```

然后别忘了重新设定一下 `配置路径` 。

图e03



设定好后，我们再来尝试编译打包，可以看到 `B4J` 正用着 `Java 11` 努力干活呢！

图e04



稍等数十秒后，终于编译成功，没有任何错误。

图e05



最后我们生成的可执行文件被放到了什么地方了呢？

通常它在这儿。

```
C:\项目所在文件夹\Objects\temp\build
```

图e06



获取到可执行文件是件很酷的事情，对不对？

不过我们可能高兴得有点早，生成的 `exe` 文件好像并不能单独被使用。

它并不可以像其他编译程序那样，能生成独立的单一文件。

换句话说，就是我们必须将整个 `build` 复制下来才行。





