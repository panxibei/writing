小白是这样打造图书管理系统的（二）

副标题：数据结构设计很重要~



接上文书



## 第二部分：设计数据库

#### 一、数据表结构



###### 1、创建数据库

在 Windows 系统命令控制台上，输入以下命令。

```shell
# 新建目录 C:\BMS2020\DATA，用于放置数据库文件
mkdir -p C:\BMS2020\DATA
```



在 SSMS 查询窗口中执行以下命令。

```mssql
-- 创建数据库 BMS2020
USE [master]
GO

/****** Object:  Database [BMS2020]    Script Date: 07/07/2020 10:10:10 ******/
CREATE DATABASE [BMS2020] ON  PRIMARY 
( NAME = N'BMS2020', FILENAME = N'C:\BMS2020\DATA\BMS2020.mdf' , SIZE = 6144KB , MAXSIZE = UNLIMITED, FILEGROWTH = 1024KB )
 LOG ON 
( NAME = N'BMS2020LOG', FILENAME = N'C:\BMS2020\DATA\BMS2020.ldf' , SIZE = 1024KB , MAXSIZE = 2048GB , FILEGROWTH = 10%)
GO
```

图1



右击 SSMS 左侧数据库一项，刷新后点开 `BMS2020` > 表，可以看到还没有用户表。

图2



###### 2、创建数据表

使用以下SQL语句构建数据表。

```mssql
USE [BMS2020]

-- 图书数据表
CREATE TABLE [dbo].[bms_book](
	[book_ID] [nchar](20) NULL,
	[book_title] [nchar](50) NULL,
	[book_Press] [nchar](20) NULL,
	[book_Author] [nchar](20) NULL,
	[book_ISBN] [nchar](20) NULL,
	[book_PublishTime] [datetime] NULL,
	[book_Price] [nchar](10) NULL,
	[book_DateStorage] [datetime] NULL,
	[book_BeLent] [tinyint] NULL,
	[book_BeLentCounts] [int] NULL,
	[book_Remark] [text] NULL
) ON [PRIMARY]

-- 借阅者数据表
CREATE TABLE [dbo].[bms_reader](
	[reader_ID] [nchar](15) NULL,
	[reader_Name] [nchar](10) NULL,
	[reader_Gender] [nchar](10) NULL,
	[reader_BeLent] [tinyint] NULL,
	[reader_BeLentCounts] [int] NULL
) ON [PRIMARY]

-- 日志数据表
CREATE TABLE [dbo].[bms_log](
	[log_ID] [nchar](20) NULL,
	[log_Reader_ID] [nchar](15) NULL,
	[log_Reader_Name] [nchar](10) NULL,
	[log_Book_ID] [nchar](20) NULL,
	[log_Book_Title] [nchar](50) NULL,
	[log_Date_Lent] [datetime] NULL,
	[log_Date_Return] [datetime] NULL
) ON [PRIMARY]
```



数据表生成了。

图3



如果你在设计数据表结构时，发现无法保存更改，那么就需要在选项中修改设定。

图4



SSMS菜单的 `工具` > `选项` ，找到左侧 `设计器` > `表设计器和数据库设计器` ，把右侧 `阻止保存要求重新创建表的更改` 一项的钩去掉即可。

图5









#### 二、填充数据

有了数据表，接下来就要操作这些表了。

我们要管理图书，当然系统中先要有图书，所以我们需要先录入图书信息。

```mssql
-- 填充图书数据
USE [BMS2020]

INSERT INTO [dbo].[bms_book]
           ([book_ID]
           ,[book_title]
           ,[book_Press]
           ,[book_Author]
           ,[book_ISBN]
           ,[book_PublishTime]
           ,[book_Price]
           ,[book_DateStorage]
           ,[book_BeLent]
           ,[book_BeLentCounts])
     VALUES
           ('B20130605161450'
           ,'中国茶道-茶'
           ,'内蒙古人民出版社'
           ,'陈虹'
           ,'9787204084500'
           ,'2006-06-01 00:00:00.000'
           ,'30'
           ,'2013-06-04 19:21:25.000'
           ,0
           ,0),
		   ('B20130605161451'
           ,'江南--不沉之舟'
           ,'中国文联出版社'
           ,'祝勇'
           ,'9787507962712'
           ,'2006-01-03 00:00:00.000'
           ,'22'
           ,'2013-06-04 20:02:14.000'
           ,0
           ,0),
           ('B20130605161452'
           ,'放弃是一种有效选择'
           ,'中国纺织出版社'
           ,'韩岊'
           ,'9787506440806'
           ,'2013-06-07 00:00:00.000'
           ,'18'
           ,'2013-06-04 19:21:25.000'
           ,0
           ,0)
```



其次，我们需要读者信息。

```mssql
-- 填充读者信息
USE [BMS2020]

INSERT INTO [dbo].[bms_reader]
           ([reader_ID]
           ,[reader_Name]
           ,[reader_Gender]
           ,[reader_BeLent]
           ,[reader_BeLentCounts])
     VALUES
           ('R00001'
           ,'胡闹闹'
           ,'男'
           ,0
           ,0),
		   ('R00002'
           ,'亚历特山大'
           ,'男'
           ,0
           ,0),
           ('R00003'
           ,'安妮卡烈尼不娜'
           ,'女'
           ,0
           ,0)
```



最后，是读者借阅图书的记录信息。

```mssql
-- 填充借阅记录信息
USE [BMS2020]

INSERT INTO [dbo].[bms_log]
           ([log_ID]
           ,[log_Reader_ID]
           ,[log_Reader_Name]
           ,[log_Book_ID]
           ,[log_Book_Title]
           ,[log_Date_Lent]
           ,[log_Date_Return])
     VALUES
           ('L20130705153849'
           ,'R00001'
           ,'胡闹闹'
           ,'B20130605161452'
           ,'放弃是一种有效选择'
           ,'2020-07-05 15:43:09.000'
           ,'2020-07-15 15:43:09.000')
```



#### 三、界面设计