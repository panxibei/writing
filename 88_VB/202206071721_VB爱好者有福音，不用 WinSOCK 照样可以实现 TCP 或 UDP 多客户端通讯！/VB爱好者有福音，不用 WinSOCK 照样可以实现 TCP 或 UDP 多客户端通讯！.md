VB爱好者有福音，不用 WinSOCK 照样可以实现 TCP 或 UDP 多客户端通讯！

副标题：

英文：

关键字：vb,winsock,tcp,udp,vbrichclient,rc5,rc6,server,client



各位爱好 `VB` 小伙伴们，大家好！

说起使用 `VB` 来编写各种小程序、小工具，可以说是手到擒来，非常容易上手。

往窗体上拖几个按钮、文本框，不一会儿就能做个像模像样的小程序了，内心的成就感也得到了满足。

不过如果要让各位写一个 `TCP/UDP` 的网络通讯程序，可能 `VB` 就有点那个啥不太自信了。



呵呵，不是说 `VB` 写不了网络程序，写是也能写，不过通常的作法非常麻烦。

大部分的操作是，往窗体上拖几个 `WinSock` 控件，然后在 `WinSock` 的事件上写代码。

虽然这样做没什么问题，只是当客户端数量猛增时，我们就不得不同时增加 `WinSock` 控件的数量。

如果能猜出来有几个客户端还好说，要是猜不出来，那么就完蛋了！

图a01



总不能无限制地增加 `WinSock` 控件的数量吧？

于是有些聪明的小伙伴想出了一个好办法，那就是用数组，对，控件数组！

好家伙，这一个两个的还好对付，这一下子出来个数组，好像把事件搞得更加复杂了。

并且，也没有摆脱对控件的依赖啊！



好了，啰嗦了这么多，其实这次是来给大家伙献宝的！

没错，你猜对了，接下来我就向小伙伴们介绍一个不用 `WinSock` 照样实现并且还更方便好用的网络通讯解决方案。

OK，让我们请出今天的主角：`VbRichClient` ！



### `VbRichClient` 简介

这个 `VbRichClient` 是国外一位大神使用 `VB` 开发的一个 `VB` 环境下的框架程序。

嗯嗯，你没眼花，他就是用 `VB` 写的哈！

这个框架程序可以实现很多超级牛叉的功能，包括图形、数据库等等，其中就有我们今天要讲的网络功能。

多说一句， `VbRichClient` 所包含的网络通讯功能不但稳定性较 `WinSock` 高，并且所需书写的代码量也非常少，最重要的是，我们不再需要拖放控件了！



### 关于 `TCP/UDP`

好了，在正式开始之前，我们先简单复习一下 `TCP/UDP` 这两个好哥们的相关知识吧！

这两个哥们是常见的两种网络通讯协议，也可以说是方式，在这里我们说得简单一些，没必要长篇大论，只讲部分关键所涉及到后面程序的知识就行。



首先，我们来说一说 `TCP` 这位哥哥。

说到 `TCP` ，大家都知道三次握手，不过我们不讲什么晦涩的协议知识，只说它是怎么干活的。

通常 `TCP` 连接方式主要分为服务端和客户端两部分，一般情况下服务端是一个，而客户端则可以是多个，多个客户端去连接一个服务端，然后它们相互可以发送和接收数据。

建立 `TCP` 连接的做法是，客户端先发送一个信号给服务端，然后服务端接收到信号后回送信号给客户端，最后客户端收到服务端的回信后再发送一个信号给服务端。

有点像两个人打招呼哈，互相打完招呼后，服务端和客户端都已经确信对方在线，连接也就成功建立起来了。

由些可见， `TCP` 这位哥哥做事比较严谨，他是两点之间两头跑，必须跑到位，数据送到手里才算完成工作。

因此这种方式也被称为可靠连接，我们可以将这种方式想像成两个人打电话，因为它是点对点的通讯，通常信号传送不会丢失。





其次，我们再说一说 `UDP` 这位弟弟。

`UDP` 这位弟弟就不像它的哥哥那样严谨了，倒是有点像寄送快递，快递现在在哪儿，什么时候送到是一概不关心，离开手就不管了。

当一台电脑发送（广播）信号出去后，这个信号就会被一个网络中的其他所有电脑接收到，而只有真正需要这个信号数据的电脑才会真正的接收到，其他电脑会丢弃信号。

看这不靠谱的样子， `UDP` 有时也被称为不可靠连接，因为它并没有真正的与其他通讯对象建立连接，而且所发送出去的信号数据也存在中途丢失的风险。

虽然 `UDP` 看上去工作不咋地，其实它也是有些用场的，比如在无法明确建立点对点连接的前提下，又比一对多或多对多的通讯时，`UDP` 就可以施展拳脚了。







### `VbRichClient` 如何实现 `TCP/UDP` 通讯

有了前面的基础知识，我们运用 `VbRichClient` 也就更加容易一些了。







