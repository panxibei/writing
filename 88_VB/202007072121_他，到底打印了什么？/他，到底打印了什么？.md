他，到底打印了什么？

副标题：让打印内容再现~







一、寻找后台打印文件夹

为了寻找Windows10的后台打印文件夹，按以下步骤。

1、依次点击 `开始菜单` > `设置` > `设备` 。

2、找到 `打印机和扫描仪` ，点击 `打印服务器属性` 。

图1

3、选择 `高级` 选项卡，可以看到 `后台打印文件夹` 实际路径。

Windows10的后台打印文件夹默认位于 `C:\Windows\System32\Spool\Printers` 。

图2

4、如果想要更改，可以点击按钮 `更改高级设置` 。



这个后台打印文件夹其实是所有打印机的默认设置。

当有多台不同的打印机时，也可以分别设置各自不同的后台打印文件夹。

方法很简单，只要修改相应打印机的注册表项即可。

```shell
# 比如打印名称为 Microsoft Print to PDF
# 修改 SpoolDirectory 键值为自定义文件夹，默认为空（C:\Windows\System32\Spool\Printers）
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Printers\Microsoft Print to PDF]
"SpoolDirectory"=""
```

图3



注意事项：

1. `SpoolDirectory` 必须指定非根目录的实际目录路径，如果指定了根目录路径（如：`C:\`），那么系统自动恢复为默认设置（即 `C:\Windows\System32\Spool\Printers` ）。
2. 如果 `SpoolDirectory` 所在驱动器为NTFS文件系统，需要保证给予可访问的权限。





二、加载打印机列表

引用 `Microsoft WMI Scripting V1.2 Library` 。



```vb
'加载打印机
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
Set wmiObjSet = objWMIService.InstancesOf("Win32_Printer")

'获取所有打印机名称
cboPrinters.Clear
For Each wmiObj In wmiObjSet
    cboPrinters.AddItem wmiObj.DeviceID
    'cboPrinters.AddItem wmiObj.KeepPrintedJobs '打印机保留文档的状态 True or False
Next

Set wmiObj = Nothing
Set wmiObjSet = Nothing
Set objWMIService = Nothing
```







