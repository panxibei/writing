202005100951_VB+Sqlite组合，真香！（一）

副标题：对，就是这个味儿！



小伙伴们看到这个标题是不是很奇怪呢？

老掉牙的VB和“玩具”数据库Sqlite搞在一起是个什么玩意？

待我慢慢道来。。。



Sqlite嘛众所周知，是个文件数据库，小而快，号称世界上使用最广泛的数据库（官网描述没有“之一”）。

的确，这东东虽小，但优点很多，但使用场景却有一定范围。

一般使用在单机场景下，或者是嵌入式设备中。

出于兴趣，简单地学习了一下 `Sqlite`。

一次偶然，从网上某位大神那里得到了一个sqlite的VB调用库，从此开启VB访问数据库的飞速之旅。

（出处已不可考，在此向大神致敬！）



Sqlite和Access的性能对比，请小伙伴们自行百度，差得不是一点半点。

我自己测试过，同样导入500条记录，sqlite耗时1秒都不到，而Access却要用36秒之多，真是令人瞠目！

使用其他高级语言可以很简单的调用Sqlite，但VB似乎有些困难。

不过现在好了，通过sqlite调用库，VB也能自由地访问Sqlite了。

小伙伴们的毕业设计是不是有希望了呢，想想都有些小激动啊！



好了，让我们丢开Access，投入Sqlite的怀抱吧！

接下来我们看看怎么玩转 `VB+Sqlite` 组合。



首先，我们得建个数据库。

先从网上找个Sqlite数据库工具软件，我用的是 `SQLite Expert Personal`，个人版免费，你也可以用其他的，网上有很多。

图1

建立一个数据库名称为 `db_user.db`，再建一个表 `tbl_user`，保存文件为 `user.db`。

```sqlite
-- 建立tbl_user表
CREATE TABLE tbl_user(id integer primary key,value text);
```

很简单吧！



其次，打开VB编辑器，新建工程，导入模块 `ModSQLite.bas`。

接下来演示数据库的连接访问及CRUD的方法。

1、连接

```vb
'打开数据库
Private lngDB as long
ite_open App.Path + "\test.db", lngDB
```





