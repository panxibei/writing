误删文件不要慌，请出 Windows File Recovery 来帮忙

副标题：微软出品，目前免费~



我们之前曾经分享过关于文件整理和查找的文章。

在一堆文件中，想要找出最新版本的那一个，还要挨个反复地打开查看，费时费力不说，还不一定能找对。

有了网管小贾的文件查找器，即使不如炙手可热的 `Everything` ，那也可以让菜鸟小白们轻易可以上手。

> 《别慌，文件找不到时我们应该这样做（二）》
>
> 文章链接：https://www.sysadm.cc/index.php/vbbiancheng/797-how-should-we-do-when-the-document-can-not-be-found-2



不过不知道小伙伴们有没有碰到过另外一种情况，就是当你找文件找得正欢的时候，你又想顺便整理整理这些乱糟糟的文件，结果不小心手滑把该删的和不该删的都给删除了。

该删的也就算了，那不该删的可得赶紧找回来啊！

扔在回收站的好说，立马能还原回来，要是像我这样手残直接 `Shift+Delete` ，那就只能以头抢地了！



怎么办，又能怎么办，我们知道文件删除本质上只是在文件头做了个删除标记，文件本体还在，不过因为被标记为删除状态，所以文件本体随时可能会被覆盖。

所以，在文件本体被覆盖前还能有一线生机可以找回想要的文件。

好了，还是得赶快找工具恢复啊！

可是网上眼花缭乱的文件恢复软件多如牛毛，有收费的也有免费的，但总觉得都不怎么靠谱。

现在好了，在去年（2020年）微软发布了一款免费的恢复文件小工具，它叫 `Windows File Recovery` 。

不管怎么说，微软自家的软件至少安全风险要小很多不是，既然来了，就先看看再走呗！





#### 一、先来个简介

`Windows File Recovery` 是一款微软在 Windows 10 应用商店上架的免费数据删除恢复工具。

它可以帮助你恢复你想要找回的文件，比如照片、文档、视频、音乐，支持各种硬盘、U盘、SD卡等存储，总之功能很强大的样子。（但它不支持网络驱动器）

官方下载地址：https://www.microsoft.com/zh-cn/p/windows-file-recovery/9n26s50ln705?activetab=pivot:overviewtab

当然你也可以在 Windows 应用商店中直接搜索 `Windows File Recovery` 后下载。

图1



安装它的系统要求是要满足 `Windows 10` 版本 `19041.0` 或更高版本。

图2



点击“获取”，开始在线安装，根据网速一般大概不到十分钟安装完成。



这个 `Windows File Recovery` 小工具在使用时只有一个命令：`winfr` ，所有的操作都是围绕着这个命令来的。

一开始我很自信地打开一个命令提示符窗口，熟练地输入 `winfr` 并回车，没想到需要管理员权限的警告猝不及防地怼了我一脸。

图3



想想也是，读写磁盘文件这么高级的操作当然是需要管理员权限的，所以我立马以管理员身份又打开了一个新的命令提示符窗口，紧接着还是输入这条命令后回车，这次程序正常输出了说明文字。

图4





#### 二、试用 `Windows File Recovery`

`winfr` 命令的基本语法虽然简单，但参数比较多。

```
C:\> winfr source-drive: desination-folder [/switches]
```

对于不熟悉命令行的小伙伴们可能比较麻烦，不过不用担心，我决定做一个傻瓜参数整合器程序来服务新手小白们。

> 参考文章：《尝试制作 Windows File Recovery 文件恢复便捷工具》
>
> 文章链接：



详细参数等使用方法可以参考如下官方的文档。

文档链接：https://support.microsoft.com/zh-cn/help/4538642/windows-10-restore-lost-files



为了简化测试过程，我们就举个简单的例子吧。

比如我不小心删除了 `E` 盘中的一个 `Excel` 文档，然后我老后悔了想把它找回来。

所以，根据 `winfr` 的基本语法，那么对我来说已知的信息之一就是文件的扩展名为 `xlsx` 。

好，先尝试第一个参数使用文件夹路径，结果出错提示用盘符。

```
# 第一个参数用法错误，只能是盘符，不能是文件夹路径
winfr e:\xlsx c:\xjrecovery /extensive /n *.xlsx
```

图5



好吧，老老实实用盘符。

不过可能你也能想到，不限定文件夹路径而使用盘符的后果就是会产生很多不一定是你想要找回的恢复文件。

当然，还有其他语法也是可以限定源文件夹路径的，之后会介绍，我们先用扩展名的方式测试。

```
winfr e: c:\xjrecovery /extensive /n *.xlsx
```



命令回车后，屏幕给出了摘要提示，询问是否继续。

图6



果断继续......开始扫描磁盘了......

图7



扫描的快慢与电脑速度有关，也同文件多少有关，我这里因为是做测试文件不多，所以很快就 100% 扫描完了。

一不小心，把秘密都给扫出来了，有点小慌......

这个时间文件应该已经恢复到指定文件夹中的了，程序继续询问是否查看恢复文件。

图8



按下 `y` 会自动打开恢复目标文件夹方便你立刻查看已恢复的文件。

图9



有个小插曲。

如果出现扫描 00% 后立刻就退出程序了，那很有可能是这个磁盘有问题。

不过不用太担心，那也有可能只是系统认为这个盘有问题，也可能实际上是没问题，比如我就时常遇到系统提示说我这个盘需要检查，而我用到着又没啥错误。

但是吧，即使如此，还是建议小伙伴们务必确保自己的磁盘健康正常，否则很可能会对恢复程序带有困扰而无法正常执行恢复操作。

图a6





三、尝试复制出来

我在想，这么好用的一款小工具，它就用个命令就能完成恢复文件的功能，那它应该不会有什么乱七八糟的依赖文件吧。

想到这儿，我决定动手试试，于是找到了 `WinFR.exe` 的所在位置。

```
C:\Program Files\WindowsApps\Microsoft.WindowsFileRecovery_0.1.20151.0_x64__8wekyb3d8bbwe\ntfssalv_cli_exe
```

图a7



就这么一个800多K的小文件嘛，把它拷到一个单独新建的文件夹中，文件夹命名为 `WinFR` 。

按照官方的说法，`Windows File Recovery` 的操作系统版本最低要求是 `19041.0` ，那我就找一台低于这个版本的系统测试呗。

然后我找到一台 `1903 18362.30` 版本的 Win10 ，实际上这个版本已经被巨硬给开除了，官方建议用户应该升级到 `1909` 以上。

好了，我将 `WinFR.exe` 文件连同文件夹 `WinFR` 一起复制到 `D` 盘下，当然看你心情放哪儿都是可以的。

```
D:\WinFR\WinFR.exe
```

最后，最好是在系统变量 `path` 中添加这个文件夹路径，以便今后调用命令。

`此电脑` > `属性` > `高级系统设置` > `环境变量(N)...` ，`系统变量(S)` 中找到 `Path` 项添加 `D:\WinFR` 。

图a8



设置好后赶快试用一下，打开一个命令提示符窗口，输入命令 `winfr.exe` 回车。

出现了一个协议窗口......

图a9



好像从应用商店里安装后并没有这个东东啊，不管了，直接点击“同意”。

哎，命令窗口出现了相关的命令参数说明，之后再执行这个命令那个协议窗口就再也没有出现过了。

那么这个命令和应用商店安装的能一样吗，能正常使用吗？

我也做了和前面测试一样的操作，答案是能正常使用。

至于是否因为测试的范围还不够广，那我就不能100%确信是否正常可用了，小伙伴们有兴趣有时间可以用用看。

至少我用下来没问题，也就是说，如果你还在运行着老版本的 Win10 系统，那么你有福了，可以通过这个方法来使用 `Windowns File Recovery` 了。

我已经打包好了，免费下载哦~

下载链接：https://www.90pan.com/b2250581

提取码：f4ea





WeChat@网管小贾 | www.sysadm.cc

