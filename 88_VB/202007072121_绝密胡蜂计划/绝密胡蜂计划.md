绝密胡蜂计划

副标题：完美截获绝密计划~



叶冲双眉紧锁，目光凝视着前方，思索着白天的一切，生怕有哪个细节出错。

今天一大早他就来到了军政厅，发现所有的工作人员比之前更加忙碌。

而从佐藤将军办公室出来的机要秘书见了他也只是草草地打了个招呼，行色匆匆地走开了，叶冲顿时生起一丝不祥的预感，心思敏锐的他不由得警觉起来。

自从宫本那家伙在佐藤面前打小报告，作为当前香岛军政厅最高领导的佐藤也慢慢对叶冲起了疑心。

现在大小事情都交由宫本处理，而宫本连开会都不通知叶冲。

宫本似乎手里也拿着相似的文件夹，难道有什么计划行动吗？

叶冲被机要秘书通知去开会。

得知有一份绝密胡蜂计划，而这项计划是要暗杀我方爱国抗日人士。

暗杀名单只保存在佐藤一个人用的U盘中，每次只通过打印名单的方式交给行动队。

而U盘被藏在某个秘密地点，除了佐藤任何人都不知道在哪里。



事态紧急，查找U盘下落已不可能！

电脑里植入程序窃取名单，也行不通，因为很容易被发现。

思考再三，唯一的办法就是截获打印内容，叶冲决定拼一下。









一、寻找后台打印文件夹

为了寻找Windows10的后台打印文件夹，按以下步骤。

1、依次点击 `开始菜单` > `设置` > `设备` 。

2、找到 `打印机和扫描仪` ，点击 `打印服务器属性` 。

图1

3、选择 `高级` 选项卡，可以看到 `后台打印文件夹` 实际路径。

Windows10的后台打印文件夹默认位于 `C:\Windows\System32\Spool\Printers` 。

图2

4、如果想要更改，可以点击按钮 `更改高级设置` 。



这个后台打印文件夹其实是所有打印机的默认设置。

当有多台不同的打印机时，也可以分别设置各自不同的后台打印文件夹。

方法很简单，只要修改相应打印机的注册表项即可。

```shell
# 比如打印名称为 Microsoft Print to PDF
# 修改 SpoolDirectory 键值为自定义文件夹，默认为空（C:\Windows\System32\Spool\Printers）
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Control\Print\Printers\Microsoft Print to PDF]
"SpoolDirectory"=""
```

图3



注意事项：

1. `SpoolDirectory` 必须指定非根目录的实际目录路径，如果指定了根目录路径（如：`C:\`），那么系统自动恢复为默认设置（即 `C:\Windows\System32\Spool\Printers` ）。
2. 如果 `SpoolDirectory` 所在驱动器为NTFS文件系统，需要保证给予可访问的权限。









二、加载打印机列表

引用 `Microsoft WMI Scripting V1.2 Library` 。



```vb
'加载打印机
Set objWMIService = GetObject("winmgmts:\\" & strComputer & "\root\cimv2")
Set wmiObjSet = objWMIService.InstancesOf("Win32_Printer")

'获取所有打印机名称
cboPrinters.Clear
For Each wmiObj In wmiObjSet
    cboPrinters.AddItem wmiObj.DeviceID
    'cboPrinters.AddItem wmiObj.KeepPrintedJobs '打印机保留文档的状态 True or False
Next

Set wmiObj = Nothing
Set wmiObjSet = Nothing
Set objWMIService = Nothing
```







