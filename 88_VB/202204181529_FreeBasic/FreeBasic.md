FreeBasic

副标题：

英文：

关键字：







### 啥是 `WinFBE` ？



在 `Windows` 上的 `FreeBASIC` 编辑器。

> 官网传送门：https://github.com/PaulSquires/WinFBE



* `FreeBASIC` - 编译器
* `FBE` - 代码编辑器
* `FBX` - 专为 `FreeBASIC` 打造的 `Windows` 框架



特征： 

- 开启 `Unicode` 支持，中文不再乱码。 
- 支持 `32` 位和 `64` 位版本。 
- 高 `DPI` 可感知任何显示器分辨率。 
- 语言本地化，基于 `English.lang` 文件轻松创建语言文件。 
- 本地化支持 11 种语言： 
  - 英语、法语、西班牙语、德语、捷克语、意大利语、中文、俄语、乌克兰语、葡萄牙语、波兰语 
- 基于工程或非工程的编辑。 
- 用于 `GUI` 应用程序开发的内置可视化设计器。 
- 轻松集成基于控制台或 `GUI` 的代码。 
- 增量编译定义为“模块”的代码。 
- 只需指定哪个源代码文件是资源即可轻松包含 `Windows` 资源文件。 
- `FreeBasic` 编译器（`32` 位和 `64` 位）的无缝集成。 
- 代码提示弹出窗口和自动完成。 



不过有一点我感觉挺奇怪的，这个 `WinFBE` 最多使用的语言居然是 `HTML` ，占比 `74.3%` ！

用 `C++` 之类的实现可以理解，但这个 `HTML` 是用来干啥的呢，有点不可思议哈！

图a01



### 下载 `WinFBE`

从项目官网上下载 `WinFBE` 最新安装包，为了省事，我们直接下载 `winfbe_suite_setup.exe` 。

图a02



当然，我们如果下载那个 `WinFBE_Suite.zip` 也是可以的，直接解压缩后就能用。

从它们的名字上我们也能看出，`suite` 是指套装，就是打包好的整套程序。

官方已经帮我们将所有我们需要的组件都打包在里面了，包括 `FreeBASIC` 编译器、示例程序、`Windows` 框架以及编辑环境等等。



本地下载

**winfbe_suite_setup.exe**



### 安装 `WinFBE`

为了避免出现一些不可描述的问题，我们直接使用 `winfbe_suite_setup.exe`  来安装吧！

很简单，基本上一路耐可斯特。

图b01

图b02

图b03

图b04

图b05

图b06

图b07



安装好后，不管你选择的是 32 位版本还是 64 位版本，第一次打开它应该是这个样子的。

图c01



怎么是英文界面？

别慌，有办法搞成中文的哦！

按图示，点击顶部菜单 `Options` ，选择 `Environment Options...` 。

图c02



接着在出现的窗口左侧选择 `Localization` ，在右侧点击 `Select` 按钮。

图c03



按以下路径找到中文语言包 `chinese.lang` 文件。

```
C:\WinFBE_Suite\Languages
```

图c04



点击 `OK` 按钮后，提示重启程序后生效。

图c05



再次打开 `WinFBE` ，界面瞬间顺眼多了！

图c06



### 怎么用 `WinFBE` ？

界面改成中文了，接下来就可以写代码了吧？

别急，我们还需要再做一步动作才行！



点击顶部菜单 `选项` ，选择 `环境选项...` 。

图d01



在出现的窗口左侧点选 `编译设置` ，在右侧填写好 `FBC` 编译器的位置，32位和64位都要写好。

如果你是默认安装的话，那么它的位置应该是在 `C:\WinFBE_Suite\FreeBASIC-1.07.2-gcc-5.2` 。

图d02

图d03



我们设定好了 `FBC` 编译器，接下来写好代码就可以直接编译运行了。

OK，我来写几行代码简单测试一下吧！



`WinFBE` 是支持单文件编译的，也就是说，我们不用大张旗鼓非得先建个项目才行。

因此我们新建一个文件，取个文件名叫 `*.bas` 即可，代码大致参考如下。

```
#define _WIN32_WINNT &h0602
# INCLUDE ONCE "Afx\CWindow.inc"
Using Afx

Dim a As String
a="Welcome to Sysadm.cc!!"
MessageBox 0, a, "", MB_OK
```

图d04



代码写好后，我们点击工具栏的 `编译并运行` 按钮。

图d07



如果没有任何错误的话，我们就会看到正常的程序输出。

图d05



只要经过正常编译没有任何问题，那么在源代码目录中就会生成 `exe` 可执行文件，以后直接拿来用就行了，非常方便。

图d06



从前面的测试代码中，我们可以看到程序引用了 `Afx\CWindow.inc` 这个 `Windows` 下的库文件。

这个库正是由 `WinFBX` 这个专为 `FreeBASIC` 打造的 `Windows` 框架，你把它理解为 `.Net` 就行了，差不多的意思。



好了，我们再来看看它带有的示例程序吧！

主程序目录中的 `Examples` 目录含有大量的示例程序，我们可以参考学习。

在 `Examples` 目录中还有作为项目的示例程序，就放在了 `Sample_Projects` 子目录中。

我找了两个例子给小伙伴们演示一下。



其一是 `TaskDisalog` ，这个是演示对话框的程序，前面的测试代码也是我参考了这个写的。

图e01

图e02

图e03



其二是电子琴程序 `FBPiano` ，可见 `FreeBASIC` 能写很多复杂的程序。

图e04

图e05



的确很强大是不是，不过程序好像没说支持中文吧？

哎，其实它是支持的，只不过要注意一下是不是 `UTF` 编码，瞧下面！

图f01



这样一来就可以保证中文不会乱码了！

图f02



嗯，可能有的小伙伴会突然想起来，不是说好了可以支持 64 位程序的吗？

是的，`FreeBASIC` 完全可以玩 64 位程序，只要我们在 `WinFBE` 中选择相应的模式就行了。

就像下图那样，和玩一样，随意切换！

图h01

图h02



### 还有国产 `WinFBE` ？

这个 `WinFBE` 其实是一帮老外搞出来的，为的就是方便大家伙高效利用 `FreeBASIC` 。

真的方便了吗？

的确方便好用，可惜毕竟是老外搞出来的，只是支持中文还有使用方式啥的好像都不怎么符合中国人品味习惯，因此终于有国内大神蚌埠住了！

就在此种背景之下，我们姑且称之为国产 `WinFBE` 的 `VisualFreeBasic` 横空出世！

图h05

图h06



这个 `VFB` 就是在 `WinFBE` 基础上二次创作，为的就是让国人更方便灵活地开发程序之用，完全免费，用的人还真不少。

话说回来，大家千万别误会哈，不是说你在 `Windows` 上用 `FreeBASIC` 开发程序就得用这个 `VFB` ，实际上你完全可以直接使用 `WinFBE` 的，没有任何问题，只是 `VFB` 可能加入一些更加本地化的内容，其中的示例程序也中文化了，更方便我们参考学习。

我就简单试用了一下，还不是特别熟悉，为了避免广告嫌疑也就不过多做介绍了，有兴趣的小伙伴可以自行研究。



### 在 `Ubuntu` 上玩 `FreeBASIC`

前面说的 `WinFBE` 是在 `Windows` 上玩的，它特意强调了 `Windows` ，那么我们自然也应该会猜到，`FreeBASIC` 实际上也完全可以在 `Linux` 上玩得转。

没错，`FreeBASIC` 它居然是跨平台的！

这就比较牛了，因此我就进一步研究了一下 `FBC` 在 `Linux` 下的玩法。

以下就拿大家比较常用的 `Ubuntu` 来测试吧！



##### 安装所需要组件

```
apt-get install gcc
apt-get install libc6-dev 
apt-get install ncurses-dev

/* X11非终端显示情况下需要安装以下几项支持 */ 
apt-get install libx11-dev
apt-get install libxext-dev
apt-get install libxpm-dev
apt-get install libxrandr-dev
apt-get install libxrender-dev

/* 默认安装路径为 /usr/local */
./install.sh -i [安装路径]
```



##### 下载 `Ubuntu` 版本的 `FreeBASIC` 编译器



**FreeBASIC-1.09.0-ubuntu-20.04-x86_64.tar.gz**

下载链接：





##### 新建一个测试文件 `test.bas`

打开你喜欢的文本编辑器，输入以下内容并保存为 `test.bas` 。

```
Screen 13
Print "Welcome to Sysadm.cc!! 网管小贾！！"
SLEEP
END
```

图g01



##### 编译 `test.bas` 文件

很简单，只要指明编译器路径，并不用带任何参数即可。

```
# 当前目录下
fbc test.bas

# 指明编译器路径
/usr/local/fbc test.bas

# 加上-v可交互输出编译结果，用于查看错误
fbc -v test.bas
```

图g02



##### 运行编译后程序

我们可以在 `test.bas` 文件同目录下直接找到编译好的程序 `test` ，运行它试试吧！

```
./test
```



不知缺少啥组件，在图形界面下中文会乱码。

图g03



将代码第一行注释掉，像这样 `'Screen 13` 。

很奇怪的是，在终端下中文却很正常地输出了。

我猜测有可能是程序库支持的问题，有懂的小伙伴请教教我。

图g04



##### 找个代码编辑器

简单的代码我们随便找个文本编辑器来凑合写写也没啥，但要是代码文件多了就不怎么方便了，看来还是要找个 `FreeBASIC` 的专属编辑器。

像 `Windows` 下就有 `WinFBE` ，那么 `Linux` 下也有类似的吗？

答案是，可能有，但不太好搞，比较复杂。



我找了一个专门可用于 `FreeBASIC` 编译的代码编辑器 `Geany` 。

图h03

图h04



`Geany` 可以通过 `apt-get` 命令安装，很简单，基本上 `Linux` 够用了。

不过它似乎并不支持 `GUI` 开发，有些遗憾。

如果你想实现带有 `GUI` 开发功能的编辑器，那么可能需要安装 `GTK` 库和 `glade` 之类的东西。

这个就涉及到 `Linux` 的图形方式的知识了，我也不是太懂，所以就不展开说明了，大家可以到网上搜索看看。





### 写在最后





**扫码关注@网管小贾，阅读更多**

网管小贾的博客 / www.sysadm.cc
