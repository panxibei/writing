LivePaper

副标题：

英文：

关键字：



最近一档综艺节目《一年一度喜剧大赛》正在热播，颇受时下年轻人的追捧。

这个节目很有特色，形式年轻化、多玩化，剧本也是脑洞频出、创意无限，收视率自然也是节节攀升。

其中有这么一部被创作者自称为陷阱喜剧的《先生请出山》在播出后突然就在网络上爆火了。

究其原由，主要是这部喜剧的结尾，三位主创也是表演者的魔性舞步。

要是你还没看过，那赶快去看一看！

记住，多看一会儿，保证让你成功洗脑，脑海里甩也甩不掉的魔性舞步和音乐。

怎么说着说着好像跑题了？

其实我也是这魔性舞步的“受害者”，脑海中挥之不去的走位步伐让我无法自拔，甚至到了如痴如醉的地步。

于是我想了一个办法，干脆将这魔性舞步视频当作动态桌面壁纸，有事没事地就欣赏欣赏！



漂亮的壁纸千千万，桌面设定也很简单，可是这视频的壁纸怎么整呢？

网上倒有不少提供动态桌面功能的程序，不过或多或少都有点小问题，比如夹带私货，又比如功能冗余。

看来只好自己动手了，工程量有点大啊！

好在元旦期间休息在家，花了几天的时间研究了一下，没想到就入了坑，摔成了0.5级伤残！

现在就将“工伤事故”汇报给小伙伴们，希望各位少走弯路啊！



### 网上关于桌面壁纸原理的描述

在正式开始了解原理之前，我们需要先请出“窗口句柄抓取工具”：`Microsoft Spy++` 。

当然如果你对此比较熟悉，也是可以用其他一些窗口句柄查看工具的。

不过如果你不太清楚什么是窗口句柄，那也没关系，我简单给你解释一哈，你大概了解了就行，别担心其实我和你一样也是小白，不需要太专业的。

那为啥要用这个工具呢，另外什么是窗口句柄呢？



首先我们要知道，在系统中窗口（或叫作窗体）是最常用最基本的容器载体，在窗口中会有很多各种各样不同的控件，它们都是用来操作系统功能或与用户互动的。

窗口很重要，那么我们如何管理这些窗口呢？

很简单，系统会分配给这些窗口一个ID，这个ID就叫作句柄（Handle）。

这个句柄就像身份证号码一样，当我们想要操作这些窗口时，只要告诉系统它的身份证ID也就是窗口句柄就可以了。



而实际上我们的系统是由很多很多个窗口组成，有的看得见，有的看不见，有的看得见但无法直接访问，而有的即使看不见我们也可以对它进行操作，总之所有的这些窗口堆叠而成最后呈现在我们眼前。

你只要把这些窗口想像成多块不同的玻璃，分别立在了你的面前，有的透明而有的不透明。

那么对于桌面来说，它也是算是一个窗口，只是它有些特殊，里面还套着几个子窗口。

因此，我们使用

我们来看看下面的句柄树，就可以了解到桌面窗口里面是怎么套娃的。

图b01









1、判断操作系统版本
2、如果是Win7，则直接查找 progman 类，在
3、将程序窗体放到一个可见的、非隐藏的，并且是非SysListView32所在的WorkerW下。