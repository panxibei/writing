【快速全面掌握 WAMPServer】07.整明白 MySQL 和 MariaDB

副标题：【快速全面掌握 WAMPServer】07.整明白 MySQL 和 MariaDB

英文：master-wampserver-quickly-and-understand-mysql-and-mariadb

关键字：wamp,wampserver,php,apache,mysql,mariadb,js,html



上一篇我们学习了 `PHP` ，今天我们接着来学习了解一下另一位作为 `LAMP` 四剑客之一的 `MySQL/MariaDB` 。

`MySQL/MariaDB` 实际上是指数据库，是一种关系型数据库管理系统，可与 `PHP` 解释器一起配合，作为后台的数据存储和记录工作。

数据库是学习任何编程语言都绕不过去的一道坎，不过也不用太担心，我们初学入门还不算太难的，此处可以有信心哦！



好，有小伙伴可能会问了，这个数据库系统可真怪，怎么叫这个名字？

其实 `MySQL` 和 `MariaDB` 是两个名字，分别是独立的两套系统，你单独使用其中任何一套都可以作为数据库使用。

你可以将他们理解为兄妹两个，`MySQL` 出生早，是哥哥，而 `MariaDB` 晚一些，是妹妹。

关于这兄妹俩的前世今生呢就说来话长了。



`MySQL` 诞生于 `2000` 年左右，然而在他刚满8岁的时候，被一家名叫 `SUN` 的公司给看上了，想让 `MySQL` 跳槽到他们那边搬砖。

可是这非但不是 `MySQL` 走向光明人生的开始，反而在短短一年左右的时间内被另外一家更多大的公司给相中了，这家公司叫 `Oracle` 。

虽然 `MySQL` 进入了大公司工作，个人能力也逐步上升，干着光鲜体面的工作，但他却失去了自由。

从前和他玩得好的一些小伙伴总是约不到他，`MySQL` 呢也很忙，不能完全放开和小伙伴一起愉快地玩耍。

甚至随着时间的推移， `MySQL` 被看得越来越紧，小伙伴们感觉在不久的将来将永久见不到他了。

于是就跑去找 `MySQL` 的爹地商量，而这位 `MySQL` 的爹地他也见不到 `MySQL` 了。

于是这么一来二去，`MySQL` 的爹地也狠下心来，给 `MySQL` 添了个妹妹，就是 `MariaDB` 。

在 `2009` 年，`MariaDB` 呱呱坠地，而最初在她的身体里，曾与她的兄长 `MySQL` 有 `99%` 是高度相似的 `DNA` 。



他俩长这样，哥哥 `MySQL` 是一头海豚，妹妹 `MariaDB` 是一头海狮。

图a02



好了，关于兄妹俩的黑历史，有兴趣的小伙伴可以上网细细查来。

在这里我们只要知道：

1. `MySQL` 和 `MariaDB` 是一个爸爸。
2. `MySQL` 作为商用软件现在已经闭源，众多现有 `Linux` 发行版数据库源也早已将原先的 `MySQL` 切换成了 `MariaDB` 。
3. 而 `MariaDB` 作为开源软件，你可以随便使用，但有一个前提，就是兄妹俩有兼容冲突问题，需要先卸载 `MySQL` 才可正常使用。



敲黑板：同一时间，`MySQL` 或 `MariaDB` 你只能选择其一使用，否则他们是会打架的。

当然了，如果你非要一起使用也不是不可以，可以通过修改他们的服务端口来实现。

具体看下面。





在之前的文章《03.玩转安装和升级》中，小伙伴们应该还记得吧，在选择安装组件时，我们需要选择数据库。

图a01



当我们选择默认安装 `WAMPServer` 时，程序会自动将 `MySQL` 和 `MariaDB` 都给安装上。

这就是我们刚刚说到的兄妹俩共存的情况。

其实质是通过不同的服务端口实现共存，比如 `MySQL` 使用 `3306` 端口，`MariaDB` 则使用 `3307` 端口。

当然话说回来，有的小伙伴就只想用其中之一，那么没关系哈，我们完全可以在安装完成后，将其中一位请出去。



对于同一数据库系统来说，在默认安装时，只能先选择一个版本（比如 `MySQL` 的 `5.7` 和 `8.0` 两个版本）。

如果我就是同时需要这两个版本，测试时来回切换行不行？

答案是可以的，只是你要稍后单独以组件方式安装另一个版本，后面会详细讲到。



从前面的图片中，我们也能看到， `MariaDB` 相较于 `MySQL` 所占磁盘的容量要小得多，前者是 `200` 多M，而后者竟然达到了将近2个G。

至于选择哪个系统以及什么版本，可以根据实际测试程序的场景来定夺。

比如将来要在生产环境部署的是 `MariaDB` ，那么最好就选 `MariaDB` ，以减少兼容适配问题。





在安装时，`WAMPServer` 会帮我们安装好 `PhpMyAdmin` 组件，它是通过 `WEB` 形式来管理 `MySQL/MariaDB` 的软件。

至于为啥有两个版本，那是因为要兼容不同版本的 `PHP` 。

图b01



`WAMPServer` 安装结束后会给我们一个提示，它告诉我们在以下路径中有 `MySQL/MariaDB` 的说明文档。

```
wamp(64)\mariadb_mysql.txt
```

图a03

图a04



这其中的内容非常重要，我们一一道来！



##### 1、关于 `WAMPServer` 的 `MySQL` 和 `MariaDB`

`MySQL` 从 `Wampserver` 的最初就被支持，而 `MariaDB` 是从 `Wampserver 3.0.8` 开始才受到支持的。

对于 `SQL` 连接，不管是 `MySQL` 还是 `MariaDB` ，其默认服务端口是并且始终是 `3306` 。

不管是 `MySQL` 还是 `MariaDB` ，在 `WAMPServer` 中都是由完整安装程序安装的，不存在精简程序的情况。



##### 2、通过 `MariaDB` 或 `MySQL` 连接数据库

默认数据库管理器端口为 `3306` ，未指定端口号的连接将始终位于默认端口上。

如果您要使用的数据库管理器（`MySQL` 或 `MariaDB` ）不是默认的，那么必须在连接请求中指定端口号，因为它不会使用默认端口 `3306` 。

再重复强调一遍，在不指定端口的情况下，它将使用默认端口 `3306` ，则非默认端口情况下，建立连接必须显式指定。



通常，连接脚本不必特别指定要使用的端口。例如：

```
$mysqli=new mysqli('127.0.0.1'，'user'，'password'，'database');
```



或者，在程序代码中：

```
$mysqli=mysqli_connect('127.0.0.1'，'user'，'password'，'database');
```



因此，要与不使用端口 `3306` 的管理器连接，则必须在连接请求中**指定端口号**（比如 `3307` ）：

```
$mysqli=new mysqli('127.0.0.1'，'user'，'password'，'database'，'3307');
```



或者，在程序代码中：

```
$mysqli=mysqli_connect('127.0.0.1'，'user'，'password'，'database'，'3307');
```



要检查 `MySQL` 或 `MariaDB` 数据库管理器上的连接，我们可以使用以下脚本：

```
wamp(64)\www\testmysql.php
```

图a05



请小伙伴注意了，这里并不让你去双击 `testmysql.php` 这个文件，而是要在启动 `WAMP` 之后，在地址栏内访问这个文件。

```
http://localhost/testmysql.php
```

图a06



从图中我们能很清楚地看到，当前数据库是 `MySQL` ，并且版本是 `5.7.36` ，连语言字符集都知道了 `latin1` 。

那我们前面明明也安装了 `MariaDB` ，这里怎么看不到呢？



##### 3、`MySQL` 与 `MariaDB` 之间切换为默认数据系统（ `DBMS` ）

重要提示：如果您想将数据库从MySQL移动到MariaDB或反之，则必须在切换DBMS之前以SQL格式备份数据库（phpMyAdmin->EXPORT）。

这是在MySQL和MariaDB之间传输数据库的唯一可靠方法。

-如果两者都启用（MySQL和MariaDB），则有一个工具可以通过单击来反转默认DBMS：

-如果MySQL是默认DBMS

右键单击Wampmanager图标->工具->反转默认DBMS MySQL

或

-如果MariaDB是默认DBMS

右键单击Wampmanager图标->工具->反转默认DBMS MariaDB<->MySQL

当然，您仍然需要导入以前保存的数据库。













-3-用MySQL替换默认DBMS MariaDB，反之亦然

-4-只有一个数据库管理器-没有DBMS管理器

-5-默认DBMS：无-/！\没有默认DBMS

-6-PhpMyAdmin









`MariaDB` 与 `MySQL` 的版本兼容对照表。

| MySQL | MariaDB        |
| ----- | -------------- |
| 5.1   | 5.1 5.2 5.3    |
| 5.5   | 5.5            |
| 5.6   | 10.1 10.2 10.3 |
| 5.7   | 10.2 10.3 10.4 |
| 8.0   | 10.5 10.6      |



以上并非权威确认，仅供版本迁移时作为有限替代的参考，具体还是要请小伙伴们移驾官网按照实际情况确认。













`PHP` 是 `Hypertext Preprocessor` 即“超文本预处理器”的缩写，是在服务端执行的一种脚本程序语言。

通常它被用于 `Web` 开发，并可以嵌入 `HTML` 中，是具有交互功能的一种动态高级语言。



虽然 `PHP` 历史悠久、应用广泛，在上个世纪的90年代就已经诞生了，但是它有个基金会却是去年（2021年）才刚刚建立的。

难怪网络上充斥着黑色幽默： `PHP` 是世界上最好的语言！

当然在基金会建立之前 `PHP` 就已经是各界小伙伴们茶余饭后的调侃对象。

那这句话是真的吗？

如果你还在纠结这个问题的真假，那只能说明你的确有必要好好学习一下这里的内容。

我们不得不承认，有不少人被绑缚于无尽的纠结而畏首畏尾、束手束脚，最终一事无成。

你管它是不是最好的呢，有用就行，有用就学啊！

而事实上，到目前为止仍有大量的网站是建立在 `PHP` 基础之上。

比如你一直想要拥有的个人主流博客软件之一的 `Wordpress` 就是跑 `PHP` 的。

那么多人在用，你说 `PHP` 有没有用呢？

不要管别人说什么，一个事物总有好的一面和不足的一面，自己看到听到想到的才最真实！

好了，既然来到这儿就已经说明你是个头脑清晰、学习劲头十足的三好学生了，那就开始我们的 `PHP` 学习之路吧！



### 几个重要概念

即使是使用 `WampServer` 这样的方便盒子，我们也有必要先了解一下关于 `PHP` 的一些基础概念。

这将有助于你更深入地掌握使用 `WampSever` 甚至是其他的 `PHP` 环境。



##### `PHP` 的运行模式

`PHP` 有两种运行模式，分别是 `CLI` 模式和 `WEB` 模式。

`CLI` 模式就是终端模式，顾名思义，是指我们在终端输入 `PHP` 命令或语句，它就解释执行并同样在终端输出结果。

`WEB` 模式可能大家就知道了，当我们向 `WEB` 服务器发送请求，`PHP` 就会响应解释执行并通过 `WEB` 方式返回结果到我们的浏览器上。



##### `TS` 和 `NTS`

`TS` 就是 `Thread Safe` 线程安全，是指支持多线程的构建。

`NTS` 就是 `None Thread Safe` 非线程安装，是指仅单线程的构建。

`TS` 应用于多线程的服务端应用编程接口 `SAPI` 方式，而 `NTS` 则用于 `PHP` 作为模块加载到 `WEB` 服务器的方式。



比如 `Linux` 下的 `PHP-FPM` ，是用来解释 `PHP` 代码的 `FastCGI` 管理器，它就是使用的 `NTS` 。

图01



而在 `Windows` 上跑的 `WampServer` 就是用的多线程 `SAPI` ，因此使用的是 `TS` 。

图02



以上可以在 `phpinfo` 上查看到，`WampServer` 可通过在浏览器中输入以下链接查看。

```
http://localhost/?phpinfo=-1
```



如果你实在记不住也没关系，我们只要简单大概地记得，在 `Linux` 上一般是 `NTS` ，而在 `Windows` 上一般是 `TS` 。

这有什么用吗？

当我们选择 `PHP` 扩展时就会知道，这些扩展 `DLL` 分 `TS` 或 `NTS` ，可不要选错了哦，否则服务可跑不起来！



##### `PECL`

`PHP` 扩展社区托管库的简称，有很多扩展库就放在这里。

当我们需要某个扩展支持时，就可以到这里来淘一淘。

比如 `Redis` 缓存扩展，双比如第三方数据库扩展等等。

> http://pecl.php.net/



##### VC15 & VS16

较新版本的 `PHP` 是使用 `VC15` 或 `VS16` （分别指 `Visual Studio 2017` 或 `2019` 编译器）构建的。

`VC15` 和 `VS16` 版本需要安装 `C++ Redistributable for Visual Studio 2015-2019 x64/x86` 。

需要记住的是，以后只要我们看到 `VC` 或 `VS` 字样，自然而然就应该想到，这里所指的 `PHP` 是在 `Windows` 上跑的。

而不同版本的 `PHP` 应该对应不同版本的 `VC` 或 `VS` 。

我们使用的 `WampServer` 中的 `PHP` 正是需要相应的 `VC` 组件，并且通常 `x64` 和 `x86` 版本的都要安装，这在前面的安装篇教程中已经说明过了，道理就在这儿。



### `Apache` 是如何调用 `PHP` 的

如果我们只安装了一个 `httpd` （也就是 `Apache` ），那么我们也只能得到一个静态网站，什么交互功能都不能做。

因此我们要想办法，在我们访问网站时让 `Apache` 调用 `PHP` 来解析相应的程序文件，以此来响应交互信息。

通常最原始的访问方法是，我们建立一个以 `php` 为后缀的文件，将其放到网站上，那么它应该识别这个文件是含有交互信息的，而不是单纯地将它的所有内容以 `html` 形式显示在浏览器上。

OK，我们前面说过，在 `Windows` 下它应该是通过连接 `SAPI` （服务端应用程序编程接口）来实现的。

那具体是怎么做的呢？

分两步走。



**第一步，交给它武器（枪），让 `Apache` 加载 `PHP` 模块。**

我们以 `WampServer` 为例，打开 `Apache` 的配置文件 `httpd.conf` ，找到加载 `PHP` 模块的位置。

如下图，我们可以很清楚地看到，`Apache` 当前加载了 `php7.4` 的模块，这个模块文件名就是 `php7apache2_4.dll` 。

```
PHPIniDir "${APACHE_DIR}/bin"
LoadModule php7_module "${INSTALL_DIR}/bin/php/php7.4.26/php7apache2_4.dll"
```

图03



**第二步，教它使用武器（学会开枪），让 `Apache` 识别 `.php` 扩展名。**

光加载模块还不够，还要让 `Apache` 知道如果碰到 `.php` 的文件就去找模块解析才行。

同样我们以 `WampServer` 为例，还是在配置文件 `httpd.conf` 中，查找识别文件类型的设定。

```
    AddType application/x-httpd-php .php
    AddType application/x-httpd-php .php3
```

图04



经过以上两步，我们可以自己做一个简单的 `PHP` 文件来测试。

将以下代码保存为一个文件，比如 `phpinfo.php` ，然后将它放到网站根目录中。

```
<?php phpinfo(); ?>
```



如果打开浏览器访问这个文件能够正常看到 `PHP` 信息，那么恭喜你 `PHP` 环境安装成功了！

```
http://localhost/phpinfo.php
```



### `WampServer` 中的 `PHP`

既然我明白了前面的原理，那么接下来再看 `WampServer` 中的 `PHP` 就会清晰很多。



##### `PHP` 版本

首先我们来看一下 `PHP` 版本，在 `WampServer` 中安装有很多不同的版本。

图05



从图中我们可以看到，当前有效版本是 `7.4.26` 。

目前为止，`7.4` 版本还是在有效维护周期内的，不过今年（2022年）年底也即将过期。

通常一个版本它的维护周期是三年，具体可以查看官方说明。

> https://www.php.net/supported-versions.php

图06



`WampServer` 中之所以保留部分旧版本，实际上是为了兼容适应部分老旧系统。

如果你有一个 `PHP` 的系统挺好用的，但它是用 `PHP 5.6` 写的，所以即使这个版本早已不被官方维护，但我们还是可以继续使用的。

`WampServer` 提供了多个版本的 `PHP` ，并且我们可以随时切换版本，只需要点下鼠标即可，真心方便啊！



##### `PHP` 设置

`WampServer` 为我们提供了方便的 `PHP` 设置，我们可以在菜单中直接进行编辑，只需要点击鼠标选择，或是直接写入新参数值。

图07



不过即使很方便，但我还是建议小伙伴们尽可能地编辑 `PHP.ini` 配置文件，这样会对搞懂 `PHP` 更有帮助。



##### `PHP` 扩展

`PHP` 在安装之初就已经集成了一部分扩展，不过有的是有效（被勾选）有的则无效（没被勾选）。

注意啦，这里显示出来的，仅仅是配置文件中所罗列出来的扩展。

如果你没有将扩展写进配置文件，那么它只能是默默无闻地呆在原地哭泣而无人知晓了。

图08



此外，如果你还需要其他诸如第三方的扩展，那么就需要将下载下来的扩展文件放到指定的目录中。

这里需要注意的是，存放扩展文件的目录务必要对应好相应的 `PHP` 版本号，可别放错了哦！

比如，当前我们使用的是 `PHP 7.4.26` ，那么真正生效的扩展目录是这个。

```
C:\wamp64\bin\php\php7.4.26\ext
```

图09



我们将扩展文件放到目录中后，就像前面所说还需要在配置文件中加载这个扩展。

具体做法是，打开配置文件 `php.ini` ，然后找到 `extension` 字样的行，照猫画虎新起一行后将扩展的名称添加进去。

```
extension=xxx
```

图10



注意，在 `WampServer` 中，扩展的文件名应该是 `php_xxx.dll` ，而配置文件中应该写成 `xxx` ，请小心了！

好了，现在你可以去菜单中的 `PHP 扩展` 看看了，如果它还没有出现，那就重启一下服务再看看。



##### `PHP` 错误日志

和 `Apache` 一样，对于 `PHP` 配置是否正确、工作是否正常，我们可以通过查看错误日志来进一步判断问题所在。

在以后不管是添加扩展功能，还是判断用户连接问题等等，都需要我们灵活运用这个错误日志。

图11



##### `php.ini` 的正确位置

作为非常重要的配置文件 `php.ini` ，它的位置难道不应该是在 `PHP` 相关目录下吗？

没错，但是吧在 `WampServer` 中可能有点不太一样。

实际上在 `WampServer` 中的 `PHP` 目录里，`php.ini` 被重命名为 `phpForApache.ini` 了。

与此同时，在 `Apache` 的 `bin` 目录中却有一个名字叫 `php.ini` 快捷方式文件。

其实这个快捷方式文件指向的就是前者 `phpForApache.ini` 。

图12



我们在使用菜单项工具操作修改 `php.ini` 时，实际上是修改了 `phpForApache.ini` 这个文件。

**如果要手动修改配置的话，那么就找 `phpForApache.ini` 即可，可千万不要去直接修改 `PHP` 目录中的 `php.ini` 哦！**

这个坑我踩得痛苦万分，至今记忆犹新，小伙伴们请谨记啊！



### 浅谈在 `CLI` 中运用 `PHP`

前面说过 `CLI` 就是命令行方式，或者说是终端模式也可以，与图形模式相对，现在我们简单聊一聊以命令行方式运行 `PHP` 的问题。



实际上我们可以像用 `DOS` 命令一样来使用 `PHP` ，这一点很重要，因为两点。

一是有些场合，代码可能会以 `CLI` 方式在后台运行，而你必须学会区分它。

比如我有一次在使用著名的 `Swoole` 框架时，它并没有将结果返回到浏览器，而是输出到了终端，让我困惑了好一阵。



二是一些比如扩展或依赖库的安装需要用到 `Composer` 这样的命令来完成。

关于第二点我们会在以后的教程中专用来讲解。

我们先来了解第一点。



我们打开一个命令提示符窗口，然后进入当前版本的 `PHP` 所在目录中。

```
cd C:\wamp64\bin\php\php7.4.26
```

接着我们输入以下命令查看。

```
php -v

```

输出结果是当前 `PHP` 的版本信息，以及编译所需的环境组件。

图13



我们可以从中看到 `cli` 的字样，这就是在终端模式中使用 `PHP` 。

接下来我们可以尝试解析 `php` 文件。

保存以下内容到一个新建文件中，并将其命名为 `test.php` ，保存目录无所谓。

```
<?php echo 'Hello！欢迎关注网管小贾！！'; ?>

```



保存好文件后，我们使用如下命令执行看看。

```
php <目录>\test.php

```

这样便可以在终端中得到 `PHP` 解析后的结果，说明一切OK。

图14



说到这儿，我不得不讲一下，在 `WampServer` 中还存在一个坑。

实际上默认情况下，`PHP` 的 `CLI` 模式使用的是 `5.6` 版本而非当前的 `7.4` 版本，因此可能会给使用者造成一些困扰。

从图中我们也能看到，`CLI` 版本是 `5.6` ，而 `WEB` 版本是 `7.4` 。

图15



想要清除这个问题困扰，我们需要右键点击 `WampServer` 图标，记住是右键点击哦！

然后在 `工具` 一项中找到 `更改 PHP CLI 版本` 这一设定。

图16



### 教程小结

本文简单地介绍了关于 `PHP` 的一些知识，旨在让小伙伴们对 `PHP` 的使用有个初步的印象。

其中最主要还是我们在使用 `WampServer` 期间，与 `PHP` 相关的一些注意点。

即使 `WampServer` 是个很方便高效的集成盒子，但是我们还是要多多少少了解一些原理性的东西才能更好地驾驭它。

要想熟练地操作 `PHP` ，还需要我们平时多看多做，将基础打牢，以后会越来越熟练。

那么除了我们可以利用 `PHP` 制作具有交互功能的网页程序之外，其实我们还需要一样东西来锦上添花，那就是数据库。

毕竟动态交互的反馈信息和结果都是需要数据库来帮忙的，否则只靠 `PHP` 也是独木难支、寸步难行。

在下一期教程，我们将继续为小伙伴们介绍 `LAMP` 中的 `M` ，也就是数据库 `MySQL/MariaDB` 。

想必大家都知道数据库的重要性，那么 `WampServer` 中又是如何操作数据库的呢？

下一期教程敬请各位期待吧！



*PS：《【小白PHP入坑必备系列】快速全面掌握 WAMPServer》教程列表：*

* *【快速全面掌握 WAMPServer】01.初次见面，请多关照*
* *【快速全面掌握 WAMPServer】02.亲密接触之前你必须知道的事情*
* *【快速全面掌握 WAMPServer】03.玩转安装和升级*
* *【快速全面掌握 WAMPServer】04.人生初体验*
* *【快速全面掌握 WAMPServer】05.整明白 Apache*
* *【快速全面掌握 WAMPServer】06.整明白 PHP*
* *【快速全面掌握 WAMPServer】07.整明白 MySQL 和 MariaDB*
* *【快速全面掌握 WAMPServer】08.想玩多个站点，你必须了解虚拟主机的创建和使用*
* *【快速全面掌握 WAMPServer】09.如何在 WAMPServer 中安装 Composer*
* *【快速全面掌握 WAMPServer】10.HTTP2.0时代，让 WampServer 开启 SSL 吧！*
* *【快速全面掌握 WAMPServer】11.安装 PHP 扩展踩过的坑*
* *【快速全面掌握 WAMPServer】12.WAMPServer 故障排除经验大总结*
* *【快速全面掌握 WAMPServer】13.PHP调试麻烦？请 xDebug 来帮忙！*
* *【快速全面掌握 WAMPServer】14.各种组件的升级方法*



**扫码关注@网管小贾，阅读更多**

网管小贾的博客 / www.sysadm.cc