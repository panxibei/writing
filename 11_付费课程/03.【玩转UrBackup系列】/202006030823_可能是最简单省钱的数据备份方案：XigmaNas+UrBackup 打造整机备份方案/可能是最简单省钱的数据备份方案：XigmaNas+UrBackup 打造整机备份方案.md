可能是最简单省钱的数据备份方案：XigmaNas+UrBackup 打造整机备份方案

副标题：小白们的数据终于有保障啦~

英文：xigmanas-plus-urbackup-create-a-solution-of-pc-image-backups

关键字：xigmanas,nas,urbackup,image,backup



这个世上有很多很多备份软件，有高级专业的也有一般普通给个人用的，好一些的通常要收费。

今天你来对了，在这儿给小伙伴们介绍一款开源的备份软件 `UrBackup` ，号称简单、快速，而且还支持中文，最最关键它是免费的哦！

> 官网链接：www.urbackup.org

图01



在官网上有一张世界地图，上面是世界各地使用 `UrBackup` 的分布图，可以看得出欧洲和美国使用频率最高，其他国家和地区用得少一些，而我们大中国使用得却寥寥无几。

是 `UrBackup` 不好用吗？

显然不是的嘛，真相只有一个，国人还未发现它的好，说你来对了吧！

图02



那这个好东东怎么用呢？

我的公众号上有相关的管理手册可供小伙伴们参考，是中文版的哦！

不过免费版的文章只是翻译官方手册的内容，而且有些言不达意，还是建议小伙伴们下载 `PDF` 付费版中文管理手册。

**墙裂推荐 `PDF` 付费版本：《UrBackup Server 2.4.x 管理手册中文版（网管小贾高级进阶版）》**

**<关注网管小贾微信公众号，发送 000946 获取>**



好了，在介绍如何使用 `UrBackup` 之前，我们不得不先要提一下我们之前使用过的 `XigmaNAS` ，它是一套非常好用的 `NAS` 存储方案。

哎，等等，一个是用于备份，另一个是用于存储，嘿嘿，你发现了什么没？

没错！备份软件和存储很配嘛！

那能不能把 `XigmaNAS` 和 `UrBackup` 组合起来，实现个人整机的备份方案呢？

肯定可以哈，要不我就写不下去啦，哈哈！

好，那就赶快一起看看我怎么编...呸...写的吧！



#### 一、在 `XigmaNas` 上安装 `UrBackup` 

我们都知道这个 `XigmaN` 就是个 `NAS` 存储系统，在它上面怎么安装 `UrBackup` 呢？

其实，不管你是什么存储系统，你总应该有个操作系统平台吧。

而 `XigmaNAS` 它的前身就是 `NAS4Free` ，和 `FreeNAS` 是差不多的，它的操作系统其实都一样就是 `FreeBSD` 。

这就好办了，上官网查看文档，找到在 `FreeNAS` 上安装一项，按上面介绍的做就是了。

图03



##### 1、登录到 `XigmaNAS` 控制台，选择 `6) Shell` 一项进入命令控制台。

图04



##### 2、依次输入命令

```shell
// 更新升级包
xigmanas: ~# pkg update

// 安装urbackup服务端
xigmanas: ~# pkg install urbackup-server

// 设定urbackup服务开机自启动
xigmanas: ~# sysrc urbackup_server_enable=YES
```

图05



安装完成后的一些提示信息：

* 手动启动服务 `servcie urbakcup_server start`
* 配置文件 `/usr/local/etc/urbackup/urbackupsrv.conf`
* WEB访问地址 `http://IP:55414`

图06



##### 3、修改配置文件

由于我们使用了 `root` 用户来安装了 `UrBackup` ，所以需要修改配置文件。

```shell
# 修改配置文件 /usr/local/etc/urbackup/urbackupsrv.conf
# 由 USER="urbackup" 修改为 USER="root"
USER="root"
```



##### 4、启动服务

就像上面写到的，你可以手动启动服务，当然也可以干脆一点直接重启。

等到服务启动后，在浏览器中输入 `http://IP:55414` 回车。

页面打开后你会看到有一个错误提示，其实是还没有指定**备份路径**。

接下来轮到 `XigmaNas` 本尊正式登场啦~

图07



#### 二、`XigmaNAS` 建立备份存储空间

要想备份数据，总归是要先有个存放备份的地方吧。

`XigmaNas` 主要功能就是存储，我们建立一个硬盘挂载点，然后告诉 `UrBackup` 这个挂载点就可以了。

如图，`硬盘` > `挂载点` > `编辑` ，挂载点名称输入你喜欢的名称，建立好后就是 `/mnt/urbakcup`。

图08



你是不是想说，这个挂载点是从哪儿来的？

这个问题具体就涉及到建立存储的问题了，涉及的内容非常多，这里就不赘述了。

如果小伙伴们有需要，可以留言给我，我会另外制作教程。

总之，不管是以什么形式使用存储，在此之前都必须先建立一个挂载点，然后就可以利用这个挂载点再来实现具体的存储访问形式。



#### 三、`UrBackup` 备份数据到 `XigmaNAS`

备份路径有了，我们就可以放开手开始备份数据了。

回到 `UrBackup` 的WEB页面，点击 `设置` ，在 `备份路径` 一项中输入刚才建立的挂载点路径，比如：`/mnt/urbackup` 。

在这里我们只作为测试引导大家入门学习，配置上如无修改必要，一般都选择默认设置。

图09



##### 1、安装客户端程序

我们来到一台 `Win10` 客户端，安装 `UrBackup` 客户端程序。

这个简单吧，没必要多说，安装完成后，右下角通知栏会出现红色图标，表示系统还未曾备份。

图10图标



##### 2、指定所需备份

第一次运行，它会问你哪些文件需要备份。

我这里选择 `自定义所需备份文件` 和 `备份系统卷（推荐）` 。

图11



随便指定一个需要备份的文件夹，当然，`C` 盘作为系统盘默认是会被备份的，这被称为磁盘映像备份。

图12



##### 3、设置备份服务器

右击图标，点击 `设置` ，在设置界面的 `互联网` 一项中填入服务器主机的 `IP` 地址。

图13



##### 4、测试备份

右击图标，点击 `状态` ，你会看到当前状态是空闲的。

不过我这边没过一会儿，状态就变成正在备份中，图标变成黄色。

图14图标

图15



在指定好备份路径后，似乎就开始自动备份了。

回到 `WEB` 页面，在状态界面已经自动添加了我们的客户端，状态也是正在备份中。

图16



最后备份完成，图标也变成了白色。

图17图标

图18



可以看到，`C` 盘作为磁盘映像已经被成功备份了，其中还包括 `ESP` 分区以及 `SYSVOL` 系统卷。



#### 四、查看备份

到目前为止，备份已经成功完成，而且在 `WEB` 控制台上也能管理备份。

但是如果你想直接看到这些备份文件应该怎么办呢？

作为补充内容，下面就来说一下通过挂载点共享来直接查看备份文件。



##### 1、`XigmaNas` WEB界面上，`服务` > `SMB` > `设置` ，启用SMB服务。

图19



##### 2、在 `服务` > `SMB` > `分享区` 中添加共享。

名称和注释任意，路径一定要选择之前的硬盘挂载点，这里应该是 `/mnt/urbackup` 。

如果没有权限要求，可以 `启用访客访问` 。

如果有权限要求，关闭 `启用访客访问` ，然后到访问选项中追加用户，具体可参考 `SMB` 设定。

这里选择 `启用访客访问` ，其他默认。

图20



##### 3、重启 `SMB` 服务，在自己的PC资源管理器地址栏内输入 `\\IP\urbackup` 回车。

如果你是用的 `Win10` 系统，打开时可能会报错。

这可能是因为 `Win10` 无法访问匿名共享，这时需要修改注册表。

```
[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanWorkstation\Parameters]
"AllowInsecureGuestAuth"=dword:00000001
"EnableSecuritySignature"=dword:00000000
"RequireSecuritySignature"=dword:00000000
```



成功打开共享后，你就可以方便地查看和操作这些备份文件啦！

图21



### 写在最后

好了，`XigmaNAS` + `UrBackup` 打造个人整机备份方案就介绍到这里。

小伙伴们，你们感觉如何？

虽然除欧美地区外，`UrBackup` 使用频率不是很高，但对于个人用户和中小企业而言，其开源免费、支持中文等特点也是非常值得尝试的。

如果你囊中羞涩，而工作站上又有很多很重要的数据，那么这套备份方案还是比较适合的。

OK，时间不多了，俺又要去搬砖了，如果小伙伴们在使用过程中有什么问题，欢迎留言讨论哦！

**墙裂推荐 `PDF` 付费版本：《UrBackup Server 2.4.x 管理手册中文版（网管小贾高级进阶版）》**

**<关注网管小贾微信公众号，发送 000946 获取>**



**扫码关注@网管小贾，个人微信：sysadmcc**

网管小贾 / sysadm.cc