Putty用户手册

副标题：

英文：

关键字：



> https://the.earth.li/~sgtatham/putty/0.78/htmldoc/





# `PuTTY` 用户手册

`PuTTY` 是一款免费的（ `MIT` 许可） `Telnet` 及 `SSH` 客户端软件。

本手册记录了 `PuTTY` 及其配套实用程序 `PSCP` ， `PSFTP` ， `Plink` ， `Pageant` 和 `PuTTYgen` 的相关内容。



*`Unix`用户注意：*本手册目前主要记录了 `Windows` 版本的 `PuTTY` 实用程序，因此提到了 `Unix` 版本中没有的一些选项。

`Unix` 版本具有此处未描述的功能，并且也未描述其相关的命令行和实用程序。

目前唯一存在的特定于 `Unix` 的文档是 `man` 手册页。



本手册版权为 `1997-2022 Simon Tatham`，保留所有权利。

您可以在 `MIT` 许可下分发本文档，许可证全文见[附录D](AppendixD.html#licence)。



- 第 1 章 `PuTTY` 简介
  - 1.1 什么是 `SSH` ， `Telnet` ， `Rlogin` 和 `SUPDUP` ？
  - 1.2 `SSH` 、`Telnet` 、`Rlogin` 和 `SUPDUP` 有何不同？
- 第 2 章：`PuTTY` 入门
  - 2.1 启动一个会话
  - 2.2 验证主机密钥（仅限 `SSH` ）
  - 2.3 登录
  - 2.4 登录之后
  - 2.5 注销
- 第 3 章：使用 `PuTTY`
  - 3.1 会话期间
  - 3.2 创建会话的日志文件
  - 3.3 更改字符集配置
  - 3.4 在 `SSH` 中使用 `X11` 转发
  - 3.5 在 `SSH` 中使用端口转发
  - 3.6 连接到本地串行线路
  - 3.7 建立原生 `TCP` 连接
  - 3.8 使用 `Telnet` 协议进行连接
  - 3.9 使用 `Rlogin` 协议进行连接
  - 3.10 使用 `SUPDUP` 协议进行连接
  - 3.11 `PuTTY` 命令行
- 第 4 章：配置 `PuTTY`
  - 4.1 会话面板
  - 4.2 日志记录面板
  - 4.3 终端面板
  - 4.4 键盘面板
  - 4.5 响铃面板
  - 4.6 特性面板
  - 4.7 窗口面板
  - 4.8 外观面板
  - 4.9 行为面板
  - 4.10 转换面板
  - 4.11 选择面板
  - 4.12 复制面板
  - 4.13 颜色面板
  - 4.14 连接面板
  - 4.15 数据面板
  - 4.16 代理面板
  - 4.17 `SSH` 面板
  - 4.18 密钥面板
  - 4.19 主机密钥面板
  - 4.20 加密面板
  - 4.21 认证面板
  - 4.22 凭据面板
  - 4.23 `GSSAPI` 面板
  - 4.24 `TTY` 面板
  - 4.25 `X11` 面板
  - 4.26 通道面板
  - 4.27 查错和更多查错面板
  - 4.28 `裸ssh连接` 协议
  - 4.29 串口面板
  - 4.30 `Telnet` 面板
  - 4.31 `Rlogin` 面板
  - 4.32 `SUPDUP` 面板
  - 4.33 将配置存储在文件中
- 第 5 章：使用 PSCP 安全地传输文件
  - [5.1 启动 PSCP](Chapter5.html#pscp-starting)
  - [5.2 PSCP 的使用](Chapter5.html#pscp-usage)
- 第 6 章：使用 `PSFTP` 安全地传输文件
  - 6.1 启动 `PSFTP`
  - 6.2 运行 `PSFTP`
  - 6.3 通过 `PSFTP` 使用公钥身份验证
- 第 7 章：使用命令行连接工具 `Plink`
  - 7.1 启动 `Plink`
  - 7.2 使用 `Plink`
  - 7.3 在批处理文件和脚本中使用 `Plink`
  - 7.4 将 `CVS` 与 `Plink` 结合使用
  - 7.5 将 `Plink` 与 `WinCVS` 结合使用
- 第 8 章：使用公钥进行 `SSH` 身份验证
  - 8.1 公钥认证 - 简介
  - 8.2 使用 `PuTTYgen` - `PuTTY` 密钥生成器
  - 8.3 准备公钥认证
- 第 9 章：使用 `Pageant` 进行身份验证
  - 9.1 `Pageant` 入门
  - 9.2 `Pageant`  主窗口
  - 9.3 `Pageant`  命令行
  - 9.4 使用代理转发
  - 9.5 不解密加载密钥
  - 9.6 安全注意事项
- 第 10 章：常见错误消息
  - 10.1 未为此服务器缓存主机密钥
  - 10.2 警告 - 潜在的安全漏洞！
  - 10.3 此服务器提供了由其他证书颁发机构签名的认证主机密钥......
  - 10.4 我们的配置需要 `SSH` 协议版本 `2` ，但远程仅提供了（旧的、不安全的）`SSH-1`
  - 10.5 服务器支持的第一个密码是...低于配置的警告阈值
  - 10.6 远程端发送断开连接消息类型 `2`（协议错误）：”`root` 身份验证失败次数过多“
  - 10.7 内存不足
  - 10.8 内部错误、内部故障、断言失败
  - 10.9 无法使用密钥文件、无法加载私钥、无法加载此密钥
  - 10.10 服务器拒绝了我们的密钥、服务器拒绝了我们的公钥、密钥被拒绝
  - 10.11 “访问被拒绝、身份验证被拒绝”
  - 10.12 “没有可用的身份验证方法”
  - 10.13 “数据包上收到的MAC不正确”或“数据包上收到的 `CRC` 不正确”
  - 10.14 “传入数据包在解密时出现乱码”
  - 10.15 “`PuTTY X11` 代理：*各种错误*”
  - 10.16 “网络错误：软件导致连接中止”
  - 10.17 “网络错误：对等方重置连接”
  - 10.18 “网络错误：连接被拒绝”
  - 10.19 “网络错误：连接超时”
  - 10.20 “网络错误：无法分配请求的地址”
- 附录 A：`PuTTY` 常见问题解答
  - A.1 引言
  - A.2 `PuTTY` 支持的功能
  - A.3 移植到其他操作系统
  - A.4 在其他程序中嵌入 `PuTTY`
  - A.5 `PuTTY` 的运营细节
  - A.6 操作方法问题
  - A.7 故障排除
  - A.8 安全问题
  - A.9 行政问题
  - A.10 杂项问题
- 附录 B：反馈和错误报告
  - B.1 一般准则
  - B.2 报告错误
  - B.3 报告安全漏洞
  - B.4 请求额外功能
  - B.5 请求已请求的功能
  - B.6 支持请求
  - B.7 网络服务器管理
  - B.8 请求许可
  - B.9 镜像 `PuTTY` 网站
  - B.10 赞美和赞美
  - B.11 电子邮件地址
- 附录C：`PPK` 文件格式
  - C.1 概述
  - C.2 外层
  - C.3 私钥编码
  - C.4 密钥派生
  - C.5 旧版本的 `PPK` 格式
- 附录 D：`PUTTY` 许可证
- 附录E：`PuTTY` 黑客指南
  - E.1 跨操作系统可移植性
  - E.2 多个后端同等对待
  - E.3 某些平台上每个进程多个会话
  - E.4 `C` ，不是 `C++`
  - E.5 安全意识编码
  - E.6 特定编译器的独立性
  - E.7 小代码尺寸
  - E.8 单线程代码
  - E.9 尽可能发送到服务器的击键
  - E.10 `640×480` 配置面板的友好性
  - E.11 协议代码中的协程
  - E.12 实现特征的显式 `vtable` 结构
  - E.13 照我们说的做，而不是照我们做的做
- 附录 F：`PuTTY` 下载密钥和签名
  - F.1 公钥
  - F.2 安全细节
  - F.3 密钥翻转
- 附录 G：为 `PuTTY` 指定的 `SSH-2` 名称
  - G.1 连接协议通道请求名称
  - G.2 密钥交换方法名称
  - G.3 加密算法名称
  - G.4 代理扩展请求名称
- 附录H：`PuTTY` 认证插件协议
  - H.1 要求
  - H.2 运输和配置
  - H.3 数据格式和编组
  - H.4 协议版本控制
  - H.5 事件概述和顺序
  - H.6 消息格式
  - H.7 参考文献
- Index





# 第1章 `PuTTY` 简介

`PuTTY` 是一个免费的 `SSH` ，`Telnet` ，`Rlogin` 和 `SUPDUP` 客户端，用于 `Windows` 系统。

## 1.1 什么是 `SSH` ，`Telnet` ，`Rlogin` 和 `SUPDUP` ？

如果您已经知道什么是 `SSH` ，`Telnet` ，`Rlogin` 和 `SUPDUP` ，则可以安全地跳到下一部分。

`SSH` ，`Telnet` ，`Rlogin` 和 `SUPDUP` 是执行相同操作的四种方法：通过网络从另一台计算机登录到多用户计算机。

多用户操作系统，通常是 `Unix` 系列（如 `Linux` ，`MacOS` 和 `BSD` 系列），通常向用户提供命令行界面，非常类似于 `Windows` 中的“命令提示符”或“MS-DOS提示符”。

系统将显示一个提示，您就可以键入系统将遵循的命令。



使用这种类型的界面，您无需坐在键入命令的同一台计算机面前。

命令和响应可以通过网络传送，因此您可以坐在一台计算机上，向另一台甚至多台计算机发出命令。



`SSH` ，`Telnet` ，`Rlogin` 和 `SUPDUP` 是允许您执行此操作的网络协议。

在您所在的计算机上，运行一个客户端，该客户端将与其他计算机（服务器）建立网络连接。

此网络连接会将您的铵键和命令从客户端传送到服务器，并将服务器的响应传输回给您。



这些协议还可用于其他类型的基于键盘的交互式会话。

特别是有很多公告板、交谈系统和 `MUDs`（多用户泥巴游戏）等等支持使用 `Telnet` 进行访问。

甚至有一些还支持 `SSH` 。



如下情况，您可能希望用到 `SSH` 、`Telnet` 、`Rlogin` 或 `SUPDUP` ：

- 您在 `Unix` 系统（或其他一些多用户操作系统，如 `VMS` 或 `ITS` ）上有一个帐户，您希望能够从其他地方访问该帐户。

- 您的互联网服务提供商为您提供网络服务器上的登录帐户。

  （这也可能称为 `shell` 帐户，`shell`  是指在服务器上运行并为您解释命令的程序。

- 您想通过使用 `Telnet` 来访问的公告板系统，交谈系统或 `MUD` 。



如下情况，您可能**不想**使用 `SSH` 、`Telnet` 、`Rlogin` 或 `SUPDUP` ：

- 你只使用 `Windows` ，`Windows` 计算机之间有自己的网络方式，除非您正在做一些相当不寻常的事情，否则您将不需要使用这些远程登录协议中的任何一种。



## 1.2 `SSH` 、`Telnet` 、`Rlogin` 和 `SUPDUP` 有何不同？

此列表总结了 `SSH` ，`Telnet` ，`Rlogin` 和 `SUPDUP` 之间的一些差异。

- `SSH`（代表“安全外壳” `secure shell` ）是最近设计的一个高安全性协议。

  它使用强大的加密技术来保护您的连接免受窃听、劫持和其他攻击。

  `Telnet` ，`Rlogin` 和 `SUPDUP` 均仅提供最低安全性的旧协议。

- `SSH` 和 `Rlogin` 都允许您无需键入密码即可登录到服务器。

  （ `Rlogin` 执行此操作的方法不安全，并可能允许攻击者访问您在服务器上的帐户。

  `SSH` 的方法要安全得多，通常破坏安全性需要攻击者获得对实际客户端计算机的访问权限。）

- `SSH` 允许您连接到服务器并自动发送命令，以便服务器运行该命令然后断开连接。

  因此，您可以在自动化处理中使用它。



互联网是一个充满敌意的环境，安全是每个人的责任。

如果您通过开放的互联网进行连接，那么我们建议您使用 `SSH` 。

如果要连接的服务器不支持 `SSH` ， 那么尝试说服管理员安装它可能是值得的 。

如果您的客户端和服务器都在同一个（状态良好）防火墙后面，则使用 `Telnet` 、`Rlogin` 或 `SUPDUP` 有可能是安全的，但我们仍然建议您使用 `SSH` 。





# 第 2 章：`PuTTY` 入门

本章提供了使用 `PuTTY` 最简单类型的交互式登录会话的快速指南。

## 2.1 启动会话

启动 `PuTTY` 时，您将看到一个对话框，此对话框允许您控制 `PuTTY` 可以执行的所有操作。

请参阅[第 4 章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config)，了解您可以控制的所有事物的详细信息。



通常不需要更改大多数配置选项。

要启动最简单的会话，您需要做的就是输入一些基本参数。

在“***主机名称（或 `IP` 地址）***”框中，输入要连接到的服务器的因特网主机名，您的登录帐户提供商应该已经告诉您这一点。

图a01



现在，从“***连接类型***”控件中选择要使用的登录协议。

对于登录会话，您应该选择 `SSH` 、`Telnet` 、`Rlogin` 或 `SUPDUP` 。

图a02



有关这些协议之间差异的描述，以及有关使用哪一种协议的建议，请参阅[第 1.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter1.html#which-one)。

原始协议不用于交互式登录会话，您通常会使用它来调试其他 `Internet` 服务（请参阅[第 3.7 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-rawprot)）。

串口选项用于连接到本地串口线路，其工作原理略有不同：有关此内容的更多信息，请参见第 [3.6 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-serial)。



更改所选协议时，“***端口***”框中的数字将更改。

这是正常的：发生这种情况是因为服务器通常在不同的网络端口上提供各种登录服务。

大多数服务器将使用标准端口号，因此您无需更改端口设置。

如果您的服务器在非标准端口上提供登录服务，则系统管理员应该告诉您是哪一个。

例如，许多 `MUD` 在 `23` 端口以外的端口上运行 `Telnet` 服务。

填写“主机名称”、“连接类型”以及可能的“端口”设置后，即可进行连接。

按对话框底部的“***打开***”按钮，`PuTTY` 将开始尝试连接到服务器。



## 2.2 验证主机密钥（仅限 `SSH` ）

如果不使用 `SSH` 协议，则可以跳过此部分。

如果您是第一次使用 `SSH` 连接到服务器，您可能会看到如下所示的消息：

```
The host key is not cached for this server:
 ssh.example.com (port 22)
You have no guarantee that the server is the computer you think it is.
The server's ssh-ed25519 key fingerprint is:
 ssh-ed25519 255 SHA256:TddlQk20DVs4LRcAsIfDN9pInKpY06D+h4kSHwWAj4w
If you trust this host, press "Accept" to add the key to PuTTY's
cache and carry on connecting.
If you want to carry on connecting just once, without adding the key
to the cache, press "Connect Once".
If you do not trust this host, press "Cancel" to abandon the connection.
```



图a03



这是 `SSH` 协议的一项功能，它旨在保护您免受称为***欺骗***（ `spoofing` ）的网络攻击。

欺骗网络攻击会秘密地将您的连接重定向到另一台计算机，以便误导您将密码发送到错误的计算机。

使用此技术，攻击者将能够获取到您登录帐户的密码，之后就可以像您一样登录系统并将该帐户用于自己的非法目的。



为了防止这种攻击，每个服务器都有一个唯一的标识代码，称为***主机密钥***。

这些密钥的创建方式可防止一台服务器伪造另一台服务器的密钥。

因此，如果您连接到服务器并且它向您发送了与您期望的主机密钥不同的主机密钥，`PuTTY` 可以警告您服务器可能已被切换，并且可能正在进行欺骗攻击。





`PuTTY` 在 `Windows` 注册表中记录您连接到的每个服务器的主机密钥。

每次连接到服务器时，它都会检查服务器提供的主机密钥是否与上次连接时的主机密钥相同。

图a05



如果不是，您将看到更强烈的警告，并且您将有机会在输入任何私人信息（例如密码）之前放弃连接。（请参阅[第 10.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter10.html#errors-hostkey-wrong)以了解其外观。

图a04



但是，当您连接到以前未连接的服务器时，`PuTTY` 无法判断主机密钥是否正确。

因此，它会给出上面显示的警告，并询问您是否要信任此主机密钥。



是否信任主机密钥取决于您的选择。

如果在公司网络中进行连接，您可能会觉得所有网络用户都在同一端，并且不太可能发生欺骗攻击，因此您可以选择不检查而信任密钥。

如果您通过恶意网络（如 `Internet` ）进行连接，则应通过电话或亲自与系统管理员联系。

（验证指纹时，请注意可能相互混淆的字母和数字：比如 `0` 和 `O` 、`1` 和 `I` 和 `l` 等等。）



许多服务器具有多个主机密钥。

如果系统管理员向您发送多个指纹，则应确保 `PuTTY` 显示的指纹在列表中，但哪一个并不重要。



如果您没有任何看起来像示例的指纹（ `SHA256:` 后跟一长串字符），而是有成对的字符，用冒号分隔，例如 `a4:db:96:a7:...`，那么请尝试按“**更多信息...**”按钮，看看您是否有与“MD5指纹”匹配的指纹。

图a06



这是汇总相同基础主机密钥的较旧且安全性较低的方法。

攻击者可以使用相同的指纹创建自己的主机密钥。

因此，除非您别无选择，否则您应该避免依赖这种指纹格式。

“**更多信息...**”对话框还显示完整的主机公钥，相较而言这个比指纹更容易对比。



有关管理主机密钥的高级选项，请参见[第 4.19 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-hostkey)。



## 2.3 登录

连接并验证服务器的主机密钥后，系统将要求您登录，可能需要使用到用户名和密码。

您的系统管理员应该为您提供这些。

（相反，如果您的系统管理员要求您提供或向您提供“公钥”或“密钥文件”，请参阅[第 8 章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter8.html#pubkey)。）



`PuTTY` 将显示一个文本窗口（“终端窗口” – 除非您更改了默认值，否则它将具有黑色背景），并提示您在该窗口中输入用户名和密码。

（这些提示将包括 `PuTTY` 图标，以将它们与服务器在同一窗口中发送的任何文本区分开来。)



输入用户名和密码，服务器应授予您访问权限并开始会话。

如果您输入了错误的密码，大多数服务器会给您几次正确输入密码的机会。



当您键入密码时，您通常不会看到光标在窗口中移动，但 `PuTTY` *正在*注册您键入的内容，并在您按回车时发送它。

（它的工作原理是避免向观看屏幕的任何人透露密码的长度。）



如果您使用的是 `SSH` ，请注意不要输入错误的用户名，因为按回车键后您将没有机会更正它。

许多 `SSH` 服务器不允许您使用不同的用户名进行两次登录尝试。

如果您输入了错误的用户名，则必须关闭 `PuTTY` 并重新开始。



如果您的密码被拒绝，但您确定键入正确，请检查是否未启用字母大小写键 `Caps Lock` 。

许多登录服务器，尤其是 `Unix` 计算机，在检查密码时将大写和小写视为不同，因此，如果 `Caps Lock` 处于打开状态，您的密码可能会被拒绝。



## 2.4 登录后

登录服务器后，接下来会发生什么取决于服务器！

大多数服务器将打印某种登录消息，然后显示提示，您可以在其中键入服务器将执行的命令。

一些服务器将为您提供在线帮助，其他服务器可能不会。

如果您对下一步操作有疑问，请咨询您的系统管理员。



## 2.5 注销

完成会话后，应通过键入服务器自己的注销命令来注销。

这可能因服务器而异，如有疑问，请尝试 `logout` 或 `exit` ，或咨询手册或系统管理员。

当服务器处理注销命令时，`PuTTY` 窗口应自动关闭。



您可以使用窗口边框中的“关闭”按钮关闭 `PuTTY` 会话，但这可能会使服务器感到困惑 - 有点像在对话过程中意外挂断电话。

我们建议您不要这样做，除非服务器已停止响应您，并且您无法以任何其他方式关闭窗口。







# 第 3 章：使用 `PuTTY`

本章对 `PuTTY` 一些更高级的功能进行了一般性介绍。

如出于极端细节的参考目的，[第4章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config)可能包含更多信息。



## 3.1 会话期间

`PuTTY` 的许多复杂特性和功能都在配置面板中体现。

一旦你按照自己的方式开启了一个会话，之后的事情应该相当简单。

不过，还有一些更有用的功能可以利用。



### 3.1.1 复制和粘贴文本

通常在 `PuTTY` 会话中，您会在终端屏幕上找到要再次输入的文本。

与大多数其他终端模拟器一样，`PuTTY` 允许您复制和粘贴文本，而不必反复键入。

此外，复制和粘贴使用 `Windows` 剪贴板，以便您可以将 `URL` 粘贴（例如）到 `Web` 浏览器中，或者从文字处理器或电子表格粘贴到终端会话中。

默认情况下，`PuTTY` 的复制和粘贴完全可以通过鼠标来操作。

（对于有过使用 `Unix` 经验的人来说，这并不陌生。

为了将文本复制到剪贴板，您只需在终端窗口中单击鼠标左键，然后拖动并选择文本。

松开按键时，文本会***自动复制***到剪贴板，您并不需要按 `Ctrl-C` 或 `Ctrl-Ins` 。

事实上，如果您确实按下了 `Ctrl-C` ，`PuTTY` 会在您的会话中将一个 `Ctrl-C` 字符发送到服务器，这可能会导致进程中断。（译者按：`Ctrl-C` 通常被视作中断指令。）



粘贴操作 `PuTTY` 是使用右键完成的（或鼠标中键，如果您有三键鼠标并已设置它;请参阅[第 4.11.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-mouse)）。

（按下 `Shift-Ins` ，或按下 `Ctrl` 加右键，再单击上下文菜单中选择“粘贴”，都具有相同的效果。）

当您单击鼠标右键时，`PuTTY` 将读取 `Windows` 剪贴板中的任意内容并将其粘贴到您的会话中。

默认情况下，其行为与在键盘上键入剪贴板内容的行为*完全相同*。

因此，请注意将格式化文本粘贴到执行自动缩进的编辑器中，因为您可能会发现从剪贴板粘贴的空格，加上编辑器添加的空格，加起来太多的空格会破坏格式设置。

（某些远程应用程序可以要求 `PuTTY` 识别正在粘贴的文本，以避免此类问题，但如果应用程序不这样做，则 `PuTTY` 无法避免这种情况。）



如果双击鼠标左键，`PuTTY` 将选择整个单词。

如果双击，并按住第二次单击同时拖动鼠标，`PuTTY` 将选择整个单词序列。

（您可以精确调整 PuTTY 认为是单词一部分的内容;请参阅[第 4.12.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-charclasses)。）

（译者按：如何理解双击并拖动鼠标的操作呢？

其实与单击对比我们就可以明白，单击拖动是一个字母一个字母地选择，而双击拖动则是一个单词一个单词地选择。）

如果单击*三次*或单击三次并拖动，则 `PuTTY` 将选择整行或行序列。



点击鼠标左键并拖动效果。

图b18



双击鼠标左键并拖动效果。

图b19



三击鼠标左键效果。

图b20



如果要选择矩形区域而不是包含每行末尾的多行选择，则可以通过在进行选择时先按住 `Alt` 来执行此操作。

您还可以将矩形选择配置为默认值，然后按住 `Alt` 将改为原来正常的操作行为：有关详细信息，请参见[第 4.11.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-rectselect)。



（在某些 `Unix` 环境中，`Alt` 加拖动的操作会被窗口管理器截获。

`Shift+Alt+拖动` 也应该适用于矩形选择，所以你可以尝试一下到底哪个可用。）



如果您有鼠标中键，则可以在选择微小错误的内容后使用它来调整现有选择。

（如果已将鼠标中键配置为粘贴，则鼠标右键将执行此操作。）

在屏幕按下中键，您可以调整被选择内容的最近（左右）一侧，并将其拖动到合适正确的地方。

（译者按：这里需要再次解释一下，意思是，先用鼠标左键选取一段或一个区域的内容，如果你感觉选取的范围有误，那么可以接着按下中键再次调整。

中键按下后，距离选取内容范围的两边，较近的一侧就会先被调整。）



如果您在 `Unix` 上运行 `PuTTY` 本身（而不仅仅是使用它从 `Windows` 连接到 `Unix` 系统），默认情况下，您可能必须在其他应用程序中使用类似的鼠标操作来粘贴您从 `PuTTY` 复制的文本，并复制文本以粘贴到 `PuTTY` 中。

像 `Ctrl-C` 和 `Ctrl-V` 这样的操作可能不会按预期运行。

[第 4.11.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-clipboards)解释了为什么会这样，以及如何更改行为。

（在 `Windows` 上，只有一个与其他应用程序共享的选择，因此不会出现这种混淆。）



服务器可以请求在 `PuTTY` 窗口本身中处理鼠标单击。

如果发生这种情况，鼠标指针将变成箭头，并且仅当您按住 `Shift` 时才可以使用鼠标进行复制和粘贴。

有关此功能的详细信息以及如何配置，请参阅第 4.6.2 节和第 [4.11.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-mouseshift)。

您可以自定义大部分此类行为，例如，从键盘启用复制和粘贴;请参阅[第 4.11 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-selection)。



### 3.1.2 向后滚动屏幕

`PuTTY` 跟踪从终端顶部向上滚动的文本。

因此，如果屏幕上出现了您想要阅读的内容，但它滚动得太快，并且在您尝试查找它时它已经消失了，您可以使用窗口右侧的滚动条查看会话历史记录并再次找到它。

除了使用滚动条外，您还可以通过按 `Shift+PgUp` 和 `Shift+PgDn` 来上下翻页滚动。

您可以使用 `Ctrl+PgUp` 和 `Ctrl+PgDn` 一次滚动一行，也可以使用 `Ctrl+Shift+PgUp` 和 `Ctrl+Shift+PgDn` 滚动到回滚的顶部/底部。

如果将滚动条配置为不可见，则这些功能仍然可用。

默认情况下，保留从顶部滚动的最后 `2000` 行供您查看。

您可以使用配置框增加（或减少）此值;请参见[第 4.7.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-scrollback)。



### 3.1.3 系统菜单

如果您在 `PuTTY` 终端窗口左上角图标上单击鼠标左键，或在标题栏上点击鼠标右键，您将看到标准 `Windows` 系统菜单，其中包含最小化、移动、大小和关闭等项目。

图b01



`PuTTY` 的系统菜单除了 `Windows` 标准选项外，还包含额外的程序功能，下面将介绍这些额外的菜单命令。

（这些选项也可以在 `PuTTY` 窗口中的任意位置，通过按住 `Ctrl` 并单击鼠标右键来显示的上下文菜单中使用。）



#### 3.1.3.1 `PuTTY` 事件日志

如果从系统菜单中选择“事件日志记录” `Event Log` ，则会弹出一个小窗口，`PuTTY` 在其中记录连接期间的重要事件。

日志中的大多数事件可能会在会话启动期间发生，但少数事件可能发生在会话中的任何时间点，一两个事件发生在会话末尾。

图b02

图b03



您可以使用鼠标选择事件日志的一个或多个行，然后点击 复制 按钮将它们复制到剪贴板。

如果要报告 `bug` ，将事件日志的内容粘贴到 `bug` 报告中通常很有用。



（事件日志与创建会话日志文件的工具不同;第 [3.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-logging)对此进行了介绍。）



#### 3.1.3.2 指定命令

根据用于当前会话的协议，可能会有一个“指定命令”的子菜单。

这些是特定于协议的令牌，例如“中断” `break` 信号，除了正常数据之外，还可以通过连接发送。

图b04



它们的确切效果通常取决于服务器。

目前只有 `Telnet` 、`SSH` 和串行连接具有指定命令。

“中断” `break` 信号也可以通过按下 `Ctrl-Break` 从键盘调用。



在 `SSH` 连接中，可以使用以下指定命令：

- 忽略消息 `IGNORE message`

  将不会有任何效果。

  图b05

  

- 重复密钥交换 `Repeat key exchange`

  仅在 `SSH-2` 中可用。

  立即强制重复密钥交换（并重置关联的计时器和计数器）。

  有关重复密钥交换的更多信息，请参见[第 4.18.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-kex-rekey)。

  图b06

  

- 缓存新的主机密钥类型 ` Cache new host key type `

  仅在 SSH-2 中可用。

  仅当服务器具有 `PuTTY` 尚未缓存的主机密钥类型（因此不用考虑）时，才会显示此子菜单。

  在此处选择一个密钥将允许 `PuTTY` 现在和将来使用该密钥：`PuTTY` 将与所选密钥进行新的密钥交换，并立即将该密钥添加到其永久缓存中（依靠连接开始时使用的主机密钥来交叉认证新密钥）。

  该密钥将用于当前会话的其余部分，它实际上可能不会用于将来的会话，具体取决于您的偏好（请参阅[第 4.19.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-hostkey-order)）。

  

  通常，`PuTTY` 将继续使用它已知的主机密钥，即使服务器提供了 `PuTTY` 本来更喜欢的密钥格式，以避免主机密钥提示。

  因此，如果您已经使用服务器几年了，由于同时服务器升级，您可能仍在使用比新用户使用的更旧的密钥。

  不幸的是，`SSH` 协议没有用于主机密钥迁移和滚动更新的整套有效的工具，但允许您手动更新。

  图b07

  

- 中断 `break`

  仅在 `SSH-2` 中可用，并且仅在会话期间可用。

  属于可选扩展，服务器可能不支持。

  `PuTTY` 会请求获取服务器的默认中断长度。

  

- 信号（信号情报、信号信号等）

  仅在 `SSH-2` 中可用，并且仅在会话期间可用。发送各种 POSIX 信号。并非所有服务器都支持。

  图b08



`Telnet` 中提供了以下指定命令：

- `Are You There` - 你在吗

- `Break` - 中断

- `Synch` - 同步

- `Erase Character` - 擦除字符

  `PuTTY` 也可以配置为在按下退格键时发送此内容;请参见[第 4.30.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-telnetkey)。

  

- `Erase Line` - 擦除行

- `Go Ahead` - 继续

- `No Operation` - 无操作

  将无任何效果。

  

- `Abort Process` - 放弃进程

- `Abort Output` - 放弃输出

- `Interrupt Process` - 中断进程

  `PuTTY` 也可以配置为在键入 `Ctrl-C` 时发送此内容;请参见[第 4.30.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-telnetkey)。

  

- `Suspend Process` - 挂起进程

  `PuTTY` 也可以配置为在键入 Ctrl-Z 时发送此内容;请参见[第 4.30.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-telnetkey)。

  

- 记录结束

  

- 文件结尾



图b11



使用串行连接时，唯一可用的指定命令是“中断” `Break` 。



#### 3.1.3.3 启动新会话

`PuTTY` 的系统菜单提供了一些启动新会话的快捷方式：

- 选择“新会话”将启动一个全新的 `PuTTY` 实例，并正常打开配置框。

- 选择“复制会话”将在新窗口中启动会话，其选项与当前窗口完全相同 - 使用相同的协议连接到同一主机，具有所有相同的终端设置和所有内容。

- 在非活动窗口中，选择“重新启动会话”将与“复制会话”执行相同的操作，但仅在当前窗口中操作。

- “保存的会话”子菜单可让您快速访问之前保存的任何存储会话详细信息集。

  有关如何创建已保存会话的详细信息，请参阅[第 4.1.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-saving)。

图b12



#### 3.1.3.4 更改会话设置

如果从系统菜单中选择“修改设置”，`PuTTY` 将显示其初始配置框的精简版本，这允许您调整当前会话的大多数属性。

您可以更改终端的大小、字体、以及各种按键的操作、颜色等。

图b13

图b14



主配置框中提供的某些选项未显示在缩减的“修改设置”框中。

这些选项通常是用于在会话中途更改不太敏感的选项（例如，您无法在会话中途从 `SSH` 切换到 `Telnet` ）。

您可以从此对话框中将当前设置保存到已保存的会话中以供将来使用。

有关已保存会话的更多信息，请参阅[第 4.1.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-saving)。



#### 3.1.3.5 全部复制到剪贴板

此系统菜单选项提供了一种方便的方式来复制终端屏幕的全部内容（直到最后一个非空行）并一次性回滚到剪贴板。

图b15



#### 3.1.3.6 清除和重置终端

系统菜单上的“清除滚动条” `Clear Scrollback` 选项告诉 `PuTTY` 丢弃从屏幕顶部滚动后保留的所有文本行。

例如，如果您显示敏感信息并希望确保没有人可以越过您的肩膀看到它，这可能很有用。

（请注意，这只能防止临时用户使用滚动条查看信息，不能保证文本不会仍在 `PuTTY` 的内存中。)



“重置终端” `Reset Terminal` 选项会导致终端仿真完全重置。

`VT` 系列终端是一个复杂的软件，很容易进入所有打印的文本都变得不可读的状态。

（例如，如果您不小心将二进制文件输出到终端，则可能会发生这种情况。)

如果发生这种情况，选择重置终端应该会解决它。

图b16



#### 3.1.3.7 全屏模式

如果您发现最大化窗口上的标题栏很丑陋或容易分散注意力，您可以选择全屏模式以尽可能地最大化 `PuTTY` 。

当您选择此选项时，`PuTTY` 将展开以填充整个屏幕，其边框、标题栏和滚动条将消失。

（如果要保留滚动条，可以将滚动条配置为在全屏模式下不消失;请参阅[第 4.7.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-scrollback)。

当您处于全屏模式时，如果您使用鼠标左键单击屏幕最左上角，您仍然可以访问系统菜单，同时可以再次点击“全屏”后退出全屏模式。

图b17



## 3.2 创建会话的日志文件

出于某些目的，您可能会发现您想要记录屏幕上显示的所有内容，您可以使用配置框中的“日志记录”面板执行此操作。

要开始会话日志，请从系统菜单中选择“修改设置”，然后转到“日志记录”面板。

图c01

图c02



输入日志文件名，然后选择日志记录模式。

（您可以记录所有会话输出，包括终端控制序列，也可以只记录可打印的文本，这取决于您想要日志的用途。）

单击“应用”，您的日志将启动。

稍后，您可以返回“日志记录”面板并选择“日志记录完全关闭”以停止日志记录，然后 `PuTTY` 将关闭日志文件，您可以安全地读取它。



有关更多详细信息和选项，请参阅[第 4.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-logging)。



## 3.3 更改字符集配置

如果您发现特殊字符（例如重音字符或画线字符）在 `PuTTY` 会话中未正确显示，则可能是 `PuTTY` 根据错误的字符集解释服务器发送的字符。

有很多不同的字符集可用，`PuTTY` 没有合适的方法知道应该使用哪个，所以这种情况完全有可能发生。



如果单击“修改设置”并查看“转换”面板，您应该会看到大量可以选择的字符集以及其他相关选项。

图c03



现在您所需要的只是找出您想要的那一个！（有关详细信息，请参阅[第 4.10 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-translation)。）



## 3.4 在 `SSH` 中使用 `X11` 转发

`SSH` 协议能够通过加密的 `SSH` 连接安全地转发 `X Window` 系统图形应用程序，以便您可以在 `SSH` 服务器计算机上运行应用程序，并使其窗口在本地计算机上启动，而无需明文发送任何 `X` 网络流量。



为了使用此功能，您需要一个适用于 `Windows` 机器的 `X` 显示服务器，例如 `Cygwin/X` ，`X-Win32` 或 `Exceed` 。

这些程序可能会将自己安装到本地计算机上并将显示编号设定为 `0` 。

如果不是这样，`X` 服务器的手册应该会告诉您它的具体做法。

然后，您应该在开始 `SSH` 会话之前勾选 `X11` 面板中的“启用 `X11` 转发”框（请参阅[第 4.25 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-x11)）。

图c04



默认情况下，“`X` 显示位置” `X display location` 框为空，这意味着 `PuTTY` 将尝试使用合理的默认值，比如当前已安装的 `X` 服务器程序的常用显示位置。

如果需要修改，那么请手动修改它，通常后面要加上 `:0` 。



现在，您应该可以正常登录 `SSH` 服务器了。

要检查在连接启动期间是否已成功协商 `X` 转发，可以检查 `PuTTY` 事件日志（请参阅[第 3.1.3.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-eventlog)）。

通常它应该这么说：

```
2023-12-05 17:22:01 Requesting X11 forwarding
2023-12-05 17:22:02 X11 forwarding enabled
```



如果远程系统是 `Unix` 或类 `Unix` ，您还应该能够看到环境变量已设置为指向 `SSH` 服务器计算机本身上的显示器 `10` 或更高版本：

```
fred@unixbox:~$ echo $DISPLAY
unixbox:10.0
```



如果这有效，那么您应该能够在远程会话中运行 `X` 应用程序，并让它们在您的 `PC` 上显示其程序窗口。



有关 `X11` 转发的更多选项，请参见[第 4.25 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-x11)。



## 3.5 在 `SSH` 中使用端口转发

`SSH` 协议能够通过加密的 `SSH` 连接转发任意网络（ `TCP` ）连接，以避免以明文形式发送网络流量。

例如，您可以使用它从家庭计算机连接到远程计算机上的 `POP-3` 服务器，而网络嗅探器看不到您的 `POP-3` 密码。



要使用端口转发从本地计算机连接到远程服务器上的端口，您需要：

- 在本地计算机上选择一个端口号，`PuTTY` 应在其中侦听传入连接，`3000` 以上可能有很多未使用的端口号。

  （您也可以在此处使用本地环回地址，有关更多详细信息，请参阅下文。）

- 现在，在开始 `SSH` 连接之前，请转到“通道” `Tunnels` 面板（请参阅[第 4.26 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-portfwd)）。

  确保设置了“本地” `Local` 单选按钮。在“源端口” `Source port` 框中输入本地端口号。

  在“目标” `Destination` 框中输入目标主机名和端口号，用冒号分隔（例如，连接到 `POP-3` 服务器`popserver.example.com:110` 。）

- 现在单击“添加” `Add` 按钮。

  端口转发的详细信息应显示在列表框中。



图c05



现在开始您的会话并登录。

（在您登录之前不会启用端口转发，否则很容易执行完全匿名的网络攻击，并访问任何人的虚拟专用网络。）

要检查 `PuTTY` 是否正确设置了端口转发，您可以查看 `PuTTY` 事件日志（请参阅[第 3.1.3.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-eventlog)）。

它应该这样说：

```
2023-12-05 17:22:10 Local port 3110 forwarding to
         popserver.example.com:110
```



现在，如果您连接到本地 `PC` 上的源端口号，您应该会发现它可以完美地给出响应，就好像它是目标计算机上运行的服务一样。

因此，在此示例中，您可以将本地 `PC` 当作 `POP-3` 服务器来配置电子邮件客户端。

（当然，当您的 `PuTTY` 会话关闭时，转发将停止发生。

```
localhost:3110 popserver.example.com:110
```



您还可以向另一个方向转发端口：安排将服务器上的特定端口号转发回您的 `PC` ，作为与 `PC` 上或附近服务的连接。

为此，只需选择“远程” `Remote` 单选按钮而不是“本地” `Local` 单选按钮。

“源端口” `Source port` 框现在将指定服务器上的端口号（请注意，大多数服务器不允许为此目的使用 `1024` 以下的端口号）。

将本地连接转发到远程主机的另一种方法是使用动态 `SOCKS` 代理。

在这种模式下，`PuTTY` 充当 `SOCKS` 服务器，`SOCKS` 感知程序可以连接到该服务器并打开到其所选目标的转发连接，因此这可以替代长列表静态转发。

要使用此模式，您需要选择“动态” `Dynamic` 单选按钮而不是“本地” `Local` ，然后您不应该在“目标” `Destination` 框中输入任何内容（将被忽略）。

然后，`PuTTY` 将侦听您指定端口上的 `SOCKS` 连接。

大多数 `Web` 浏览器都可以配置为连接到此 `SOCKS` 代理服务，此外，您可以通过设置“代理” `Proxy` 控制面板通过它转发其他 `PuTTY` 连接（有关详细信息，请参阅[第 4.16 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-proxy)）。

图c06



转发连接的源端口通常不接受来自除 `SSH` 客户端或服务器计算机本身以外的任何计算机的连接（分别用于本地和远程转发）。

“通道” `Tunnels` 面板中有一些控件可以更改此设置：

- “本地端口接受其他主机的连接” `Local ports accept connections from other hosts` 选项允许您设置本地到远程端口转发（包括动态端口转发），以便客户端 `PC` 以外的计算机可以连接到转发的端口。

- “远程端口接受连接(仅限 `SSH-2` )” `Remote ports do the same (SSH-2 only)` 选项对远程到本地端口转发执行相同的操作（以便 `SSH` 服务器计算机以外的计算机可以连接到转发的端口）。

  请注意，此功能仅在 `SSH-2` 协议中可用，并非所有 `SSH-2` 服务器都支持此功能（例如，在 `OpenSSH` 中，它通常默认处于禁用状态）。



您还可以指定要侦听的 `IP` 地址。

通常要求是 `Windows` 计算机侦听范围内的任何单个 `IP` 地址，这些地址都是仅供本地计算机使用的环回地址。

因此，如果您转发（比如说）到远程计算机的端口，那么您应该按照如此的设定来运行 .

如果连接到转发端口的程序不允许您更改它使用的端口号，这可能很有用。

此功能适用于本地到远程转发端口，`SSH-1` 无法支持远程到本地端口，而 `SSH-2` 理论上可以支持，但服务器不一定会配合。

```
127.*.*.*
127.0.0.5:79
finger fred@127.0.0.5
```



（请注意，如果您使用的是 `Windows XP Service Pack 2` ，则可能需要从 `Microsoft` 获取修补程序才能使用类似 `127.0.0.5` 的地址 - 请参阅[问题 A.7.17](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/AppendixA.html#faq-alternate-localhost)。



有关端口转发的更多选项，请参阅[第 4.26 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-portfwd)。



如果您通过 `SSH` 转发的连接本身是由另一个 `PuTTY` 副本建立的第二个 `SSH` 连接，您可能会发现“逻辑主机名”配置选项可用于警告 `PuTTY` 它应该需要哪个主机密钥。

有关详细信息，请参见[第 4.14.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-loghost)。



## 3.6 连接到本地串行线路

`PuTTY` 可以直接连接到本地串行线路，作为建立网络连接的替代方法。

在此模式下，在 `PuTTY` 窗口中键入的文本将直接从计算机的串行端口发送，通过该端口接收的数据将显示在 `PuTTY` 窗口中。

您可以使用此模式，例如，如果您的串行端口连接到另一台具有串行连接的计算机。



要建立此类型的连接，只需从“会话” `Session` 配置面板上的“连接类型” `Connetion type` 单选按钮中选择“串口” `Serial` （请参阅[第 4.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-hostname)）。

图c07



“主机名”和“端口”框将转换为“串行口” `Serial line` 和“速度” `Speed` ，允许您指定要使用的串行线路（如果您的计算机有多个串行线路）以及传输数据时使用的速度（波特率）。

有关其他配置选项（数据位、停止位、奇偶校验、流量控制），您可以使用“串口” `Serial` 配置面板（请参阅[第 4.29 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-serial)）。



在串行模式下启动 `PuTTY` 后，您可能会发现您必须迈出第一步，方法是从串行线路发送一些数据，以便通知另一端的设备有人在那里与之通信。

这可能取决于设备，如果您启动 `PuTTY` 串行会话并且窗口中没有显示任何内容，请尝试按几次回车键，看看是否有帮助。



串行线没有为连接的一端提供明确定义的方法，以通知另一端连接已完成。

因此，串行模式下的 `PuTTY` 将保持连接状态，直到您使用关闭按钮关闭窗口。



## 3.7 建立原始 `TCP` 连接

许多互联网协议由纯文本形式的命令和响应组成。

例如，`SMTP`（用于传输电子邮件的协议）、`NNTP`（用于传输 Usenet 新闻的协议）和 `HTTP`（用于提供网页的协议）都由可读纯文本格式的命令组成。



有时，通过键入协议命令并观察响应，直接连接到这些服务之一并“手动”声明协议会很有用。

在 `Unix` 机器上，您可以使用系统的命令连接到正确的端口号来执行此操作。

例如，可能使您能够直接与邮件服务器上运行的 `SMTP` 服务通信。

```
telnet mailserver.example.com 25
```



尽管 `Unix` 程序提供了此功能，但所使用的协议并不是真正的 `Telnet` 。

真的根本没有实际的协议，通过连接发送的字节与您键入的字节完全相同，屏幕上显示的字节正是服务器发送的字节。

`Unix` 将尝试检测或猜测它正在与之通信的服务是否是真正的 `Telnet` 服务， `PuTTY` 更喜欢被肯定地回复。



要与此类服务建立调试连接，只需从“会话”  `Session` 配置面板的“协议”按钮中选择第四个协议名称“Raw”。

图c08



（请参阅[第 4.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-hostname)。然后，您可以输入主机名和端口号，并建立连接。



## 3.8 使用 `Telnet` 协议进行连接

`PuTTY` 可以使用 `Telnet` 协议连接到服务器。

在引入 `SSH` 之前，`Telnet` 可能是最流行的远程登录协议。

它足够通用，可供多个服务器操作系统（特别是 `Unix` 和 `VMS` ）使用，并支持许多可选的协议扩展，为特定的服务器功能提供额外的支持。

与 `SSH` 不同，`Telnet` 通过不安全的网络连接运行，因此在充满敌对的 `Internet` 上使用它是一个非常糟糕的主意（尽管截至 `2020` 年它仍然在某种程度上使用）。

图c09



## 3.9 使用 `Rlogin` 协议进行连接

`PuTTY` 可以使用 `Rlogin` 协议连接到服务器。

`Rlogin` 在概念上类似于 `Telnet` ，但更侧重于 `Unix` 机器之间的连接。

它支持无密码登录功能，基于使用“特权端口”（数字低于 `1024` 的端口，`Unix` 传统上不允许用户分配）。

最终，基于服务器信任客户端的 `IP` 地址归它声称的 `Unix` 机器所有，并且该机器将适当地保护其特权端口。

图c10



与 `Telnet` 一样，`Rlogin` 通过不安全的网络连接运行。



## 3.10 使用 `SUPDUP` 协议进行连接

`PuTTY` 可以使用 `SUPDUP` 协议连接到服务器。

`SUPDUP` 是 `1975-1990` 年期间主要由 `PDP-10` 和 `Lisp` 机器使用的登录协议。

像 `Telnet` 和 `Rlogin` 一样，它是不安全的，所以现代系统几乎从不支持它。



要建立此类型的连接，请从“会话” `Session` 面板上的“连接类型”单选按钮中选择“SUPDUP”（请参阅[第 4.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-hostname)）。

有关进一步的配置选项（字符集、更多处理、滚动），您可以使用“SUPDUP”配置面板（请参阅[第 4.32 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-supdup)）。

图c11

图c12



在 `SUPDUP` 中，终端仿真与网络协议的集成程度高于 `SSH` 等其他协议。

因此，`SUPDUP` 协议只能与 `PuTTY` 一起使用，而不能与命令行工具 `Plink` 一起使用。



`SUPDUP` 协议不支持更改终端尺寸，因此在 `SUPDUP` 会话期间禁用了此功能。

`SUPDUP` 没有为连接的一端提供明确定义的方法，以通知另一端连接已完成，因此，`SUPDUP` 模式下的 `PuTTY` 将保持连接状态，直到您使用关闭按钮关闭窗口。



## 3.11 `PuTTY` 命令行

`PuTTY` 可以通过提供命令行参数（例如，从命令提示符窗口或 `Windows` 快捷方式）在没有用户干预的情况下执行各种操作。



### 3.11.1 从命令行启动会话

这些选项允许您绕过配置窗口并直接启动到会话中。



要启动与名为 `host` 的服务器的连接，请执行以下操作：

```
putty.exe [-ssh | -ssh-connection | -telnet | -rlogin | -supdup | -raw] [user@]host
```



如果使用此语法，则设置取自默认设置（请参阅[第 4.1.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-saving)），或者（如果已提供）按照设定覆盖这些设置。



此外，您可以指定一个协议，该协议将覆盖默认协议（请参阅[第 3.11.3.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-cmdline-protocol)）。



对于 `telnet` 会话，支持以下替代语法（这使得 `PuTTY` 适合用作 `Web` 浏览器中 `telnet` 的 `URL` 处理程序）：

```
putty.exe telnet://host[:port]/
```



要启动与串行端口的连接，例如 `COM1` ：

```
putty.exe -serial com1
```



要启动名为 `session name` 现有已保存会话，请使用选项 `-load`（在第 [3.11.3.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-cmdline-load)中描述）。

```
putty.exe -load "session name"
```



### 3.11.2 `-cleanup`

如果调用该选项，而不是正常运行，`PuTTY` 将从本地计算机中删除其注册表项和随机种子文件（在与用户确认后）。

它还将尝试删除存储在 `Windows 7` 及更高版本的“跳转列表”中的最近启动的会话的信息。

```
putty.exe -cleanup
```

图c13



请注意，在多用户系统上， 仅删除与当前登录用户关联的注册表项和文件。



### 3.11.3 标准命令行选项

`PuTTY` 及其相关工具支持一系列命令行选项，其中大多数选项在所有工具中都是一致的。

本节列出了所有工具中的可用选项。

特定工具选项将在有关该工具的章节中介绍。



#### 3.11.3.1 加载保存的会话： `-load`

该选项会导致 `PuTTY` 从保存的会话中加载配置详细信息。

如果这些详细信息包括主机名，则只需此选项即可使 `PuTTY` 启动会话。

```
putty.exe -load "session name"
```



如果会话名称包含空格，则需要在会话名称两边加上双引号。

如果要创建 `Windows` 快捷方式来启动 `PuTTY` 保存的会话，则应使用此选项，快捷方式应调用类似：

```
d:\path\to\putty.exe -load "my session"
```



（请注意，`PuTTY` 本身支持此选项的替代形式，以实现向后兼容性。

如果执行 `putty @sessionname`，它将具有与 `putty -load "sessionname"` 相同的效果。

对于使用 `@` 的形式，不需要双引号，并且 `@` 符号必须处于命令行上的最开头，此形式的选项已弃用。）



#### 3.11.3.2 选择协议： `-ssh` ， `-ssh-connection` ， `-telnet`， `-rlogin`  ，`-supdup` ， `-raw` ， `-serial`

若想选择要连接的协议，可以使用以下选项之一：

- `-ssh` 选择 `SSH` 协议。
- `-ssh-connection  `选择裸 `SSH` 连接协议。（这仅在特殊情况下有用，有关更多信息，请参见第 [4.28 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-psusan)。）
- `-telnet `选择 `Telnet` 协议。
- `-rlogin `选择 `Rlogin` 协议。
- `-supdup` 选择 `SUPDUP` 协议。
- `-raw` 选择原始协议。
- `-serial` 选择串行连接。



这些选项中的大多数在文件传输工具 `PSCP` 和 `PSFTP`（仅适用于 `SSH` 协议和裸 `ssh` 连接协议）中不可用。

这些选项等效于 `PuTTY` 配置框的“会话” `Session` 面板中的协议选择按钮（请参阅[第 4.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-hostname)）。



#### 3.11.3.3 增加详细程度： `-v`

大多数 `PuTTY` 工具都可以通过提供选项 `-v` 来告诉您有关它们正在做什么的更多信息。

如果您在建立连接时遇到问题，或者您只是好奇，您可以打开此开关并希望了解有关正在发生的事情的更多信息。



#### 3.11.3.4 指定登录名： `-l`

您可以使用该选项 `-l` 指定要在远程服务器上登录的用户名。

例如：

```
plink login.example.com -l fred
```



这些选项等效于 `PuTTY` 配置框的“连接”面板中的用户名选择框（请参阅[第 4.15.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-username)）。



#### 3.11.3.5 设置端口转发：`-L` ， `-R` 和 `-D` 

除了在 `PuTTY` 配置中设置端口转发（请参阅[第 4.26 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-portfwd)）外，您还可以在命令行上设置转发。

命令行选项的工作方式与 `Unix` `ssh` 程序中的选项相同。



要将本地端口（例如 `5110`）转发到远程目标（例如 `popserver.example.com` 端口 `110` ），您可以编写如下内容之一：

```
putty -L 5110:popserver.example.com:110 -load mysession
plink mysession -L 5110:popserver.example.com:110
```



要将远程端口转发到本地目标，只需使用选项 `-R` 而不是 `-L` ：

```
putty -R 5023:mytelnetserver.myhouse.org:23 -load mysession
plink mysession -R 5023:mytelnetserver.myhouse.org:23
```



要为通道的侦听端指定 `IP` 地址，请将其附加到参数前面：

```
plink -L 127.0.0.5:23:localhost:23 myhost
```



要在本地端口上设置基于 `SOCKS` 的动态端口转发，请使用选项 `-D` 。

为此，你只需要传递端口号：

```
putty -D 4096 -load mysession
```



有关端口转发的一般信息，请参见[第 3.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-port-forwarding)。

这些选项在文件传输工具 `PSCP` 和 `PSFTP` 中不可用。



#### 3.11.3.6 从文件中读取远程命令或脚本：`-m`

选项 `-m` 执行的功能与 `PuTTY` 配置框的 `SSH` 面板中的“远程命令”框类似（请参阅[第 4.17.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-command)）。

但是，选项 `-m` 需要给定一个本地文件名，它将从该文件读取命令。



对于某些服务器（特别是 `Unix` 系统），您甚至可以在此文件中放置多行并按顺序执行多个命令或整个 `shell` 脚本。

但这可以说是一种滥用，不能指望在所有服务器上都有效。

特别是，已知不适用于某些“嵌入式”服务器，例如思科路由器。

此选项在文件传输工具 `PSCP` 和 `PSFTP` 中不可用。



#### 3.11.3.7 指定端口号：`-P`

选项 `-P` 用于指定要连接到的端口号。

如果您的计算机的端口 `9696` 而不是端口 `23` 上运行 `Telnet` 服务器，例如：

```
putty -telnet -P 9696 host.name
plink -telnet -P 9696 host.name
```



（请注意，此选项在 `Plink` 中比在 `PuTTY` 中更有用，因为在 `PuTTY` 中，您在任何情况下都可以编写 `putty -telnet host.name 9696` 。

此选项等效于` PuTTY` 配置框的“会话” `Session` 面板中的端口号控件（请参阅[第 4.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-hostname)）。



#### 3.11.3.8 指定密码：`-pwfile` 和 `-pw` 

自动远程登录的一种简单方法是在命令行上提供密码。



选项 `-pwfile` 将文件名作为参数，该文件中的第一行文本将用作您的密码。



选项 `-pw` 将密码本身作为参数。

如果其他人使用同一台计算机，这是**不安全**的，因为如果另一个用户列出正在运行的进程，则可能会显示整个命令行（包括密码）。

`-pw` 保留只是为了向后兼容，你应该改用 `-pwfile` 。



请注意，这些选项仅在使用 `SSH` 协议时有效。

由于 `Telnet`、`Rlogin` 和 `SUPDUP` 的基本限制，这些协议不支持自动密码身份验证。



#### 3.11.3.9 控制使用 `Pageant` 进行身份验证：`-agent` 和 `-noagent`

选项 `-agent` 使用 `Pageant` 打开 `SSH` 身份验证，并用 `-noagent` 将其关闭。

仅当您使用 `SSH` 时，这些选项才有意义。



有关 `Pageant` 的一般信息，请参阅[第 9 章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter9.html#pageant)。

这些选项等效于 `PuTTY` 配置框的“身份验证”面板中的代理身份验证复选框（请参阅[第 4.21.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-tryagent)）。



#### 3.11.3.10 控制代理转发：`-A` 和 `-a`

选项 `-A` 将打开 `SSH` 代理转发，并用 `-a` 将其关闭。

仅当您使用 SSH 时，这些选项才有意义。



有关 `Pageant` 的一般信息，请参阅第 [9 章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter9.html#pageant)，有关代理转发的信息，请参阅[第 9.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter9.html#pageant-forward)。

请注意，启用此选项存在安全风险;有关详细信息，请参阅[第 9.6 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter9.html#pageant-security)。



这些选项等效于 `PuTTY` 配置框的“身份验证”面板中的代理转发复选框（请参阅[第 4.21.7 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-agentfwd)）。

这些选项在文件传输工具 `PSCP` 和 `PSFTP` 中不可用。



#### 3.11.3.11 控制 `X11` 转发：`-X` 和 `-x`

选项`-X`在 `SSH` 中打开 `X11` 转发，并用 `-x` 将其关闭。

仅当您使用 `SSH` 时，这些选项才有意义。



有关 `X11` 转发的信息，请参见[第 3.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-x-forwarding)。

这些选项等效于 PuTTY 配置框的 X11 面板中的 X11 转发复选框（请参阅[第 4.25 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-x11)）。



这些选项在文件传输工具 `PSCP`  和 `PSFTP` 中不可用。



#### 3.11.3.12 控制伪终端分配： `-t` 和 `-T`

选项 `-t` 可确保 `PuTTY` 尝试在服务器上分配伪终端，并用 `-T` 阻止其分配伪终端。

仅当您使用 `SSH` 时，这些选项才有意义。

这些选项等效于 `PuTTY` 配置框的 `SSH` 面板中的“不分配伪终端”复选框（请参阅[第 4.24.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-pty)）。

这些选项在文件传输工具 `PSCP` 和 `PSFTP` 中不可用。



#### 3.11.3.13 禁止启动 `shell` 或命令： `-N`

选项 `-N` 可防止 `PuTTY` 尝试在远程服务器上启动 `shell` 或命令。

如果仅使用 `SSH` 连接进行端口转发，并且服务器上的用户帐户无法运行 `shell` ，则可能需要使用此选项。



此功能仅在 `SSH` 协议版本 `2` 中可用（因为版本 `1` 协议假定您始终希望运行 `shell` ）。

此选项等效于 `PuTTY` 配置框的 `SSH` 面板中的“根本不启动 shell 或命令”复选框（请参阅[第 4.17.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-noshell)）。

此选项在文件传输工具 `PSCP` 和 `PSFTP` 中不可用。



#### 3.11.3.14 建立远程网络连接以代替远程 `shell` 或命令：`-nc`

选项 `-nc` 可防止 `Plink`（或 `PuTTY` ）尝试在远程服务器上启动 `shell` 或命令。

相反，它将指示远程服务器打开与您指定的主机名和端口号的网络连接，并将该网络连接视为主会话。



指定主机和端口作为选项 `-nc` 的参数，用冒号分隔主机名和端口号，如下所示：

```
plink host1.example.com -nc host2.example.com:1234
```



如果您尝试与目标主机建立连接，而目标主机只能通过代理主机的 `SSH` 转发来访问，这会很有用。

执行此操作的一种方法是通过端口转发与代理主机建立现有 `SSH` 连接，但如果您希望根据需要按需启动连接，则此方法也可以工作。



但是，这确实取决于*使用代理的程序*能够运行子进程而不是建立网络连接。

`PuTTY` 本身可以使用“本地”代理类型来做到这一点，但有一种内置的更灵活的方式使用“SSH”代理类型。

（有关两者的说明，请参见[第 4.16.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-proxy-type)。）

因此，此功能对于作为最终用户的另一个客户端程序可能最有用。



此功能仅在 `SSH` 协议版本 `2` 中可用（因为版本 `1` 协议假定您始终希望运行 `shell` ）。

它在文件传输工具 `PSCP` 和 `PSFTP` 中不可用。

它在 `PuTTY` 本身中可用，尽管它在 `Plink` 以外的任何工具中都不太可能很有用。

此外，`-nc` 使用与端口转发相同的服务器功能，因此如果服务器管理员禁用了端口转发，它将不起作用。



（该选项以 `Unix` 程序[`nc`](http://www.vulnwatch.org/netcat/)命名，是“netcat”的缩写。

命令 `plink host1 -nc host2:port` 在功能上与 `plink host1 nc host2 port` 非常相似，后者在服务器上调用 `nc` 并告诉它连接到指定的目标。

但是，`Plink` 的内置选项 `-nc` 不依赖于服务器上安装的程序。）



#### 3.11.3.15 启用压缩： `-C`

选项 `-C` 允许压缩通过网络发送的数据。

此选项仅在使用 `SSH` 时才有意义。

此选项等效于 `PuTTY` 配置框的 `SSH` 面板中的“启用压缩”复选框（请参阅[第 4.17.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-comp)）。



#### 3.11.3.16 指定 `SSH` 协议版本：`-1` 和 `-2`

选项 `-1`和 `-2`  强制 `PuTTY` 使用 `SSH` 协议的版本 `1` 或版本 `2` 。

仅当您使用 `SSH` 时，这些选项才有意义。

这些选项等效于在 `PuTTY` 配置框的 `SSH` 面板中选择 `SSH` 协议版本（请参阅[第 4.17.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-prot)）。



#### 3.11.3.17 指定互联网协议版本：`-4` 和 `-6`

选项 `-4` 和 `-6` 强制 `PuTTY` 对大多数传出连接使用较旧的互联网协议 `IPv4` 或较新的 `IPv6` 。

这些选项等效于在 `PuTTY` 配置框的“连接”面板中选择首选的互联网协议版本为“IPv4”或“IPv6”（请参阅[第 4.14.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-address-family)）。



#### 3.11.3.18 指定 `SSH` 私钥：`-i`

选项 `-i` 允许您以 `PuTTY` 将用于向服务器进行身份验证的 `*.PPK` 格式指定私钥文件的名称。

此选项仅在使用 `SSH` 时才有意义。

如果您使用的是 `Pageant` ，您还可以指定一个*公钥*文件（ `RFC 4716` 或 `OpenSSH` 格式）来标识要使用的特定密钥文件。（当然，如果您不运行 `Pageant` ，这将不起作用。）



有关公钥认证的一般信息，请参阅[第 8 章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter8.html#pubkey)。

此选项等效于 `PuTTY` 配置框的“身份验证”面板中的“用于身份验证的私钥文件”框（请参阅[第 4.22.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-privkey)）。



#### 3.11.3.19 指定 `SSH` 证书： `-cert`

选项 `-cert` 允许您指定包含公钥的签名版本的证书文件的名称。

如果指定此选项，`PuTTY` 将在尝试使用匹配的密钥进行身份验证时提供该证书来代替纯公钥。

（无论密钥存储在 `Pageant` 中还是由 `PuTTY` 直接从文件中加载，这都适用。）



此选项等效于 `PuTTY` 配置框的“身份验证”面板中的“与私钥一起使用的证书”框（请参阅[第 4.22.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-cert)）。



#### 3.11.3.20 如果 `SSH` 身份验证成功，则断开连接： `-no-trivial-auth`

如果服务器接受身份验证而从未要求任何类型的密码、签名或令牌，则此选项会导致 `PuTTY` 放弃 `SSH` 会话。

请参阅[第 4.21.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-notrivialauth)，了解您可能想要这样做的原因。



#### 3.11.3.21 指定逻辑主机名： `-loghost`

此选项通过告诉 `PuTTY` 您希望连接最终到达的主机名称来覆盖 `PuTTY` 的正常 `SSH` 主机密钥缓存策略（如果该名称与 `PuTTY` 认为它连接到的位置不同）。

它可以是纯主机名，也可以是后跟冒号和端口号的主机名。

有关此内容的更多详细信息，请参阅[第 4.14.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-loghost)。



#### 3.11.3.22 手动指定预期的主机密钥： `-hostkey`

此选项通过准确告诉 `PuTTY` 所需的主机密钥来覆盖 `PuTTY` 的正常 `SSH` 主机密钥缓存策略，这在注册表中的正常自动主机密钥存储不可用时非常有用。

此选项的参数应为主机密钥指纹或 `SSH-2 key blob` 。

有关更多信息，请参见[第 4.19.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-kex-manual-hostkeys)。

如果要配置要接受的多个密钥，可以多次指定此选项。



#### 3.11.3.23 显示 `PGP` 密钥指纹： `-pgpfp`

此选项会导致 `PuTTY` 工具并不按照常规方式启动，而是显示 `PuTTY PGP` 主密钥的指纹，以帮助验证新版本。

有关详细信息，请参阅[附录 F](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/AppendixF.html#pgpkeys)。



#### 3.11.3.24 指定串行端口配置： `-sercfg`

此选项指定串行端口的配置参数（波特率、停止位等）。

其参数被解释为以逗号分隔的配置选项列表，可以如下所示：

- 从 `5` 到 `9` 的任何一位数都设置数据位数。
- `1` ， `1.5` 或 `2` 设置停止位的数量。
- 任何其他数字字符串都解释为波特率。
- 单个小写字母指定奇偶校验：`n` 表示无，`o` 表示奇数，`e` 表示偶数，`m` 示标记，`s` 表示空格。
- 单个大写字母指定流控制：`N` 表示无，`X` 表示 `XON/XOFF` ，`R` 表示 `RTS/CTS` ，`D` 表示 `DSR/DTR` 。

例如，`-sercfg 19200,8,n,1,N` 表示波特率为 `19200` 、`8` 个数据位、无奇偶校验、`1` 个停止位和无流量控制。



#### 3.11.3.25 启用会话日志记录： `-sessionlog` ， `-sshlog` ， `-sshrawlog`

这些选项会导致 `PuTTY` 网络工具输出日志文件。

它们中的每一个都需要一个文件名作为参数，例如，`-sshlog putty.log` 会导致将 `SSH` 数据包日志写入名为 `putty.log` 的文件。

三个不同的选项选择不同的日志记录模式，所有模式也可从 `GUI` 获得：

- `-sessionlog` 选择“所有会话输出”日志记录模式。
- `-sshlog ` 选择“`SSH` 数据包”日志记录模式。
- `-sshrawlog` 选择“`SSH` 数据包和原始数据”日志记录模式。



有关日志记录配置的更多信息，请参见[第 4.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-logging)。



#### 3.11.3.26 使用现有日志文件控制行为： `-logoverwrite` ， `-logappend`

如果已启用日志记录（在保存的配置中，或通过其他命令行选项），并且指定的日志文件已存在，则这些选项会告知 `PuTTY` 网络工具要执行的操作，以便它们不必询问用户。

有关详细信息，请参见[第 4.2.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-logfileexists)。



#### 3.11.3.27 指定本地代理命令： `-proxycmd`

此选项启用 `PuTTY` 的模式，用于在本地计算机上运行命令并将其用作网络连接的代理。

它需要一个 `shell` 命令字符串作为参数。



有关此内容和其他代理设置的更多信息，请参阅[第 4.16.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-proxy-type)。

特别要注意的是，为了能在参数字符串中理解描述的特殊序列，因此字符反斜杠必须加倍（如果命令中有 `\` ，则必须写成 `\\` ）。



#### 3.11.3.28 限制 `Windows` 进程的 `ACL` ： `-restrict-acl`

此选项（仅在 `Windows` 上）会导致 `PuTTY`（或其他 `PuTTY` 工具）尝试在其自己的进程中锁定操作系统的访问控制。

如果成功，它应该为设法在与 `PuTTY` 进程相同的用户 `ID` 下运行的恶意软件带来额外的障碍，阻止它利用调试器使用相同接口附加到 `PuTTY` ，并从内存中读取敏感信息或劫持其网络会话。



默认情况下不启用此选项，因为 `Windows` 程序之间的这种交互形式有许多合法用途，包括屏幕阅读器等辅助功能软件。

此外，在任何情况下，它都无法针对此类攻击提供完全的安全性，因为 `PuTTY` 只能在启动后锁定自己的 `ACL` ，如果恶意软件攻击启动和锁定之间的进程，它仍然可以进入。

因此，它牺牲了明显的便利性，并且提供的真实安全性低于您的预期。

但是，如果您确实想进行这种权衡，则可以使用该选项。



以 `-restrict-acl` 开头的 `PuTTY` 进程会将其传递给以重复会话、新会话等开头的任何进程。

（但是，如果您要显式调用 `PuTTY` 工具，例如作为代理命令，则需要安排自己传递选项 `-restrict-acl` （如果需要的话）。



如果 `Pageant` 是使用选项 `-restrict-acl` 启动的，并且是从系统托盘子菜单启动的 `PuTTY` 会话，则 `Pageant` 不会默认使用受限 `ACL` 启动的 `PuTTY` 子进程。

这是因为 `PuTTY` 更有可能因 `ACL` 受限而遭受功能减少（例如，屏幕阅读器软件将更需要与之交互），而 `Pageant` 存储更关键的信息（因此从额外的保护中受益更多），因此想要运行 `Pageant` 而不是具有 `ACL` 限制的 `PuTTY` 是合理的。

如果您还设置了选项 `-restrict-putty-acl` ，则可以强制 `Pageant` 使用受限 `ACL` 启动附属 `PuTTY` 进程。



#### 3.11.3.29 启动主机 `CA` 配置： `-host-ca`

如果您使用选项 `-host-ca` 启动 `PuTTY` ，它根本不会启动会话。

相反，它将仅显示主机证书颁发机构的配置对话框，如[第 4.19.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-kex-cert)中所述。

关闭该对话框时，`PuTTY` 将终止。









# 第 4 章：配置 `PuTTY`

本章介绍 `PuTTY` 中的所有配置选项。

`PuTTY` 是使用启动会话之前出现的控制面板配置的。

某些选项也可以在会话过程中通过从窗口菜单中选择“修改设置”来更改。



## 4.1 会话面板

会话配置面板包含您需要指定的基本选项，以便完全打开会话，还允许您保存设置以便稍后重新加载。



### 4.1.1 主机名称部分

“会话”面板上的顶部框标有“指定要连接到的目的地址”，其中包含在 `PuTTY` 可以打开会话之前需要填写的详细信息。

- 在“主机名称”框中，您可以键入要连接到的服务器的名称或 `IP` 地址。

- “连接类型”控件可让您选择要建立的连接类型：`SSH` 网络连接、与本地串行线路的连接或各种其他类型的网络连接。

  - 有关网络远程登录协议 `SSH` 、`Telnet` 、`Rlogin` 和 `SUPDUP` 之间差异的摘要，请参见第 [1.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter1.html#which-one)。

  - 有关使用串口线行的信息，请参见[第 3.6 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-serial)。

  - 有关“RAW”连接的解释，请参见[第 3.7 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-rawprot)。

  - 有关 `Telnet` 的一些信息，请参见第 [3.8 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-telnet)。

  - 有关使用 `Rlogin` 的信息，请参见[第 3.9 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-rlogin)。

  - 有关使用 `SUPDUP` 的信息，请参见[第 3.10 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-supdup)。

  - “连接类型”控件中的“裸 `ssh` 连接”选项适用于不涉及网络连接的专业用途。

    有关它的一些信息，请参阅[第 4.28 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-psusan)。

- “端口”框允许您指定要连接到服务器上的端口号。

  如果您选择 `Telnet` ，`Rlogin` ，`SUPDUP` 或 `SSH` ，此框将自动填充为通常数值，并且只有在您有非标准服务端口时才需要更改它。

  如果您选择原始模式，您几乎肯定需要自行填写“端口”框。



如果从“连接类型”单选按钮中选择“串口”，则“主机名称”和“端口”框将替换为“串行口”和“速度”，有关这些内容的更多详细信息，请参见[第 4.29 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-serial)。



### 4.1.2 加载和存储保存的会话

会话配置面板的下一部分允许您保存首选的 `PuTTY` 选项，以便在您下次启动 `PuTTY` 时自动显示它们。

它还允许您创建保存的会话，其中包含一整套配置选项以及主机名和协议。

保存的会话包含 `PuTTY` 准确启动所需会话所需的所有信息。

图c14



- 要保存默认设置：首先按照您希望保存的方式配置好相应设置。

  然后返回到“会话”面板，在保存的会话列表中选择“默认设置”条目，只需单击一下，然后按“保存”按钮。

  如果要存储一个特定主机的连接，其中包含特定主机的详细信息，则应创建一个单独命名的已保存的会话，该会话将与默认设置分开。

- 要保存会话：首先浏览配置框的其余部分，设置所需的所有选项。

  然后返回到“会话”面板，在“已保存会话”输入框中输入已保存会话的名称。

  服务器名称通常是保存的会话名称的不错选择，然后按“保存”按钮。您保存的会话名称现在应显示在列表框中。

  您也可以在会话中从“修改设置”对话框中保存设置。

  自会话开始以来更改的设置将与其当前值一起保存，除了通过对话框更改的设置外，还包括窗口大小的更改、服务器发送的窗口标题更改等。

- 要重新加载已保存的会话：单击以在列表框中选择会话名称，然后按“加载”按钮。

  您保存的设置应全部显示在配置面板中。

- 要修改已保存的会话：首先如上所述加载它，然后进行所需的更改。

  返回“会话”面板，然后按“保存”按钮，新设置将保存在旧设置之上。

  要以其他名称保存新设置，您可以在“保存的会话”框中输入新名称，或单击以在列表框中选择会话名称以覆盖该会话。

  要保存“默认设置”，您必须在保存前单击名称。

- 要立即启动保存的会话：双击列表框中的会话名称。

- 要删除已保存的会话：单击以在列表框中选择会话名称，然后按“删除”按钮。



每个保存的会话都独立于默认设置配置。

如果更改首选项并更新默认设置，则还必须单独更新每个已保存的会话。



保存的会话存储在注册表中，位于该位置：

```
HKEY_CURRENT_USER\Software\SimonTatham\PuTTY\Sessions
```

如果需要将它们存储在文件中，可以尝试第 [4.33 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-file)中描述的方法。



### 4.1.3 退出时关闭窗口

最后，在“会话”面板中，有一个标有“退出时关闭窗口”的选项。

这可以控制 `PuTTY` 终端窗口是否在其内部会话终止后立即消失。

如果您可能希望在会话终止后将文本复制并粘贴出会话，或重新启动会话，则应安排关闭此选项。

图c15



“退出时关闭窗口”有三个设置。

“总是”意味着总是在退出时关闭窗口。

“从不”表示退出时永不关闭（始终保持窗口打开，但处于非活动状态）。

第三个设置，也是默认设置，是“仅在干净退出时”。

在这种模式下，正常终止的会话将导致其窗口关闭，但因网络故障或来自服务器的混乱消息而意外中止的会话将使窗口保持打开状态。



## 4.2 日志记录面板

日志记录配置面板允许您保存 `PuTTY` 会话的日志文件，以供调试、分析或将来参考。

主要选项是一个单选按钮集，用于指定 `PuTTY` 是否会记录任何内容。

图c16



选项包括：

- “无”。这是默认选项。

  在此模式下，PuTTY 根本不会创建日志文件。

- “可打印输出”。

  在此模式下，将创建并写入日志文件，但只会将可打印的文本保存到其中。

  通常与可打印文本一起通过交互式会话发送的各种终端控制代码将被省略。

  如果您想在文本编辑器中读取日志文件并希望能够理解它，这可能是一个有用的模式。

- “所有会话输出”。

  在此模式下，将记录服务器发送到终端会话的*所有内容*。

  因此，如果您在文本编辑器中查看日志文件，您可能会发现它充满了奇怪的控制字符。

  如果您在 `PuTTY` 的终端处理中遇到问题，这是一种特别有用的模式：您可以记录进入终端的所有内容，以便其他人稍后可以慢动作重播会话并观察出了什么问题。

- “`SSH` 包”。

  在此模式下（仅由 `SSH` 连接使用），通过加密连接发送的 `SSH` 消息数据包将写入日志文件（以及事件日志条目）。

  您可能需要它来调试网络级问题，或者更有可能作为错误报告的一部分发送给 `PuTTY` 作者。

  *请注意*，如果您使用密码登录，密码可能会出现在日志文件中，请参阅[第 4.2.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-logssh)，了解可能有助于在将敏感材料发送给其他任何人之前从日志文件中删除敏感材料的选项。

- “`SSH` 包和 `RAW` 数据”。

  在此模式下，包括解密的数据包（与以前的模式一样），以及原始（加密、压缩等）数据包都会被记录。

  这对于诊断传输中的数据损坏可能很有用。（当然，与前一种模式相同的警告也适用。）



请注意，非 `SSH` 日志记录选项（“可打印输出”和“所有会话输出”）仅适用于 `PuTTY` 。

在没有终端仿真的程序（例如 `Plink` ）中，即使通过保存的设置启用，它们也不会生效。



### 4.2.1 日志文件名

在此编辑框中，输入要将会话记录到的文件的名称。

“浏览”按钮可让您浏览文件系统以找到放置文件的正确位置，或者如果您已经确切地知道要保存到哪里，则可以在编辑框中键入路径名。

图c17



此框中有一些特殊功能。

如果在文件名框中使用字符 `&` ，`PuTTY` 将在其实际打开的文件的名称中插入当前会话的详细信息。

它会做到如下精确替换：

- `&Y` 将由当前年份替换为四位数。
- `&M` 将由当前月份替换为两位数。
- `&D ` 将替换为当月的当前日期，作为两位数。
- `&T ` 将被当前时间替换为六位数 （ `HHMMSS` ），没有标点符号。
- `&H` 将替换为要连接到的主机名。
- `&P` 将替换为您在目标主机上连接到的端口号。



例如，如果您输入主机名，则最终会得到如下所示的文件 `c:\puttylogs\log-&h-&y&m&d-&t.dat` 。

```
log-server1.example.com-20010528-110859.dat
log-unixbox.somewhere.org-20010611-221001.dat
```



### 4.2.2 如果日志文件已存在该怎么办

此控件允许您指定 `PuTTY` 在尝试开始写入日志文件并发现该文件已存在时应执行的操作。

图c18



您可能希望自动销毁现有日志文件并启动具有相同名称的新日志文件。

或者，您可能希望打开现有日志文件并将其*添加到其末尾*。

最后（默认选项），您可能不希望有任何自动行为，而是在每次出现问题时询问用户。



### 4.2.3 经常刷新日志文件

此选项允许您控制将记录的数据刷新到光盘的频率。

图c19



默认情况下，`PuTTY` 将在显示数据后立即刷新数据，因此，如果您在会话仍处于打开状态时查看日志文件，它将是最新的。

如果客户端系统崩溃，则保留数据的可能性更大。

但是，这可能会导致性能损失。

如果 `PuTTY` 在启用日志记录的情况下运行缓慢，您可以尝试取消选中此选项。

请注意，日志文件可能并不总是最新的（尽管它当然会在关闭时刷新，例如在会话结束时）。



### 4.2.4 包含行首标题

此选项允许您选择是否在打开日志文件时的日期和时间中包含标题行。

图c20



如果日志文件用作不需要标头行的其他程序的实时输入，则禁用此功能可能很有用。



### 4.2.5 指定 `SSH` 包日志记录设置

仅当记录 `SSH` 数据包数据时，这些选项才适用。

以下选项允许自动将未加密数据包的特别敏感部分排除在日志文件之外。

它们只是为了阻止随意的攻击行为，攻击者甚至可以从这些混淆日志中收集大量有用的信息（例如，密码长度）。

图c21



#### 4.2.5.1 忽略已知密码域

选中后，解密的密码字段将从传输数据包的日志中删除。

（这包括用户对质询-响应身份验证方法（如“键盘交互”）的任何响应。

如果使用 `X11` 转发，则不包括 `X11` 身份验证数据。



请注意，这只会忽略 `PuTTY` *知道*是密码的数据。

但是，例如，如果您在 `PuTTY` 会话中启动另一个登录会话，则使用的任何密码都将以明文形式显示在数据包日志中。

下一个选项可用于防止这种情况。

默认情况下，此选项处于启用状态。



#### 4.2.5.2 忽略会话数据

选中后，将忽略所有解密的“会话数据”，这被定义为终端会话和转发通道（ `TCP` 、`X11` 和身份验证代理）中的数据。

这通常会大大减少生成的日志文件的大小。

默认情况下，此选项处于禁用状态。



## 4.3 终端面板

终端配置面板允许您控制 `PuTTY` 终端仿真的行为。

图c22



### 4.3.1 初始启用自动换行

自动换行模式控制在 `PuTTY` 窗口中打印的文本到达窗口右侧边缘时发生的情况。

启用自动换行模式后，如果一长行文本到达右侧边缘，它将换行到下一行，因此您仍然可以看到所有文本。

关闭自动换行模式后，光标将停留在屏幕的右侧边缘，并且所有字符将在窗口顶部打印显示为一行。



如果您正在运行全屏应用程序，并且偶尔发现屏幕在看起来不应该滚动时向上滚动，则可以尝试关闭此选项。



自动换行模式可以通过服务器发送的控制序列来打开和关闭。

此配置选项控制*默认*状态，该状态将在重置终端时恢复（请参阅[第 3.1.3.6 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#reset-terminal)）。

但是，如果您在会话中途使用“修改设置”修改此选项，它将立即生效。



### 4.3.2 初始启用 `DEC` 原始模式

`DEC` 原始模式是一个次要选项，用于控制 `PuTTY` 如何解释服务器发送的光标位置控制序列。

服务器可以发送限制显示器滚动区域的控制序列。

例如，在编辑器中，服务器可能会在屏幕顶部保留一行，在底部保留一行，并可能发送导致滚动操作仅影响其余行的控制序列。



启用 `DEC` 原始模式时，光标坐标从滚动区域的顶部开始计数。

关闭后，无论滚动区域如何，光标坐标都会从整个屏幕的顶部开始计数。



您不太可能需要更改此选项，但是如果您发现全屏应用程序在看起来像屏幕错误部分显示文本片段，则可以尝试打开 `DEC` 原始模式以查看是否有帮助。

`DEC` 原始模式可以通过服务器发送的控制序列打开和关闭。

此配置选项控制*默认*状态，该状态将在重置终端时恢复（请参阅[第 3.1.3.6 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#reset-terminal)）。

但是，如果您在会话中途使用“修改设置”修改此选项，它将立即生效。



### 4.3.3 在每个 `LF` 字符前增加 `CR` 字符

大多数服务器发送两个控制字符 `CR` 和 `LF` 来启动屏幕的新行。

`CR` 字符使光标返回到屏幕左侧。

`LF` 字符使光标向下移动一行（并可能使屏幕滚动）。



某些服务器仅发送 `LF` ，并期望终端自动将光标向左移动。

如果您遇到执行此操作的服务器，您将在屏幕上看到阶梯效果，如下所示：

```
First line of text
                  Second line
                             Third line
```



如果您遇到这种情况，请尝试启用“在每个 `LF` 字符前增加 `CR` 字符”选项，事情可能会恢复正常：

```
First line of text
Second line
Third line
```



### 4.3.4 在每个 `CR` 字符后增加 `LF` 字符

大多数服务器发送两个控制字符 `CR` 和 `LF` 来启动屏幕的新行。

`CR` 字符使光标返回到屏幕左侧。

`LF` 字符使光标向下移动一行（并可能使屏幕滚动）。



某些服务器仅发送 `CR` ，因此新写入的行将被以下行覆盖。

此选项会导致换行，以便显示所有行。



### 4.3.5 使用背景颜色清除屏幕

并非所有终端都同意在服务器发送“清除屏幕”指令时更新屏幕的颜色。

一些终端认为屏幕应始终清除为*默认*背景颜色。

其他人认为应该将屏幕清除为服务器选择作为背景颜色的任何颜色。



确实存在期望这两种行为的应用程序。

因此，可以将 `PuTTY` 配置为执行任一操作。



禁用此选项后，屏幕清除始终以默认背景颜色完成。

启用此选项后，它将以*当前*背景颜色完成。

背景色清除可以通过服务器发送的控制指令打开和关闭。

此配置选项控制*默认*状态，该状态将在重置终端时恢复（请参阅[第 3.1.3.6 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#reset-terminal)）。

但是，如果您在会话中途使用“修改设置”修改此选项，它将立即生效。



### 4.3.6 启用闪烁字文本

服务器可以要求 `PuTTY` 显示的文本可以开启和关闭闪烁效果。

这非常分散注意力，因此 `PuTTY` 允许您完全关闭闪烁的文本。



当禁用闪烁文本并且服务器尝试使某些文本闪烁时，`PuTTY` 将改为以粗体背景颜色显示文本。



闪烁文本可以通过服务器发送的控制指令打开和关闭。

此配置选项控制*默认*状态，该状态将在重置终端时恢复（请参阅[第 3.1.3.6 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#reset-terminal)）。

但是，如果您在会话中途使用“修改设置”修改此选项，它将立即生效。



### 4.3.7 `^E` 回应

此选项控制如果服务器向 `PuTTY` 发送 `^E` 查询字符，它将发送回服务器的内容。

通常它只发送字符串 `“PuTTY”` 。



如果您不小心将二进制文件的内容写入终端，您可能会发现它包含多个 `^E` 字符，因此您的下一个命令行可能会显示 `“PuTTYPuTTYPuTTY...”` 。

就好像您在键盘上多次键入应答字符串一样。

如果将应答字符串设置为空，则此问题应消失，但这样做可能会导致其他问题。



请注意，这不是 `PuTTY` 的功能，服务器通常会使用它来确定您的终端类型。

该功能是“连接”面板中的“终端类型字符串”，有关详细信息，请参见[第 4.15.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-termtype)。

您可以使用 `^C` 表示法在应答字符串中包含控制字符。（用 `^~` 获取文字 `^` 。）



### 4.3.8 本地回应

禁用本地回应后，您在 `PuTTY` 窗口中键入的字符不会被 `PuTTY` 在窗口中回显。

它们只是被发送到服务器。

（*服务器*可能会选择将它们回显给您，这无法从 `PuTTY` 控制面板进行控制。)



某些类型的会话需要本地回应，而许多不需要。

在其默认模式下，`PuTTY` 将自动尝试推断本地回应是否适合您正在使用的会话。

如果您发现它做出了错误的决定，则可以使用此配置选项覆盖其选择：您可以强制打开本地回应，或强制关闭它，而不是依靠自动检测。



### 4.3.9 本地行编辑

通常，您在 `PuTTY` 窗口中键入的每个字符都会在您键入的那一刻立即发送到服务器。



如果启用本地行编辑，则会改变。

`PuTTY` 将允许您在本地一次编辑整行，并且只有在您按 `Return` 时，该行才会发送到服务器。

如果出错，可以在按 `Return` 键之前使用 `Backspace` 键进行更正，服务器将永远不会看到该错误。



由于很难在无法看到编辑行时进行本地行编辑，因此本地行编辑主要与本地回显结合使用（[第 4.3.8 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-localecho)）。

这使其成为在原始模式下或连接到 `MUDs` 或说话者时的理想选择。

（尽管一些更高级的 `MUDs` 偶尔会打开本地行编辑并关闭本地回显，以便接受用户的密码。）



某些类型的会话需要本地行编辑，而许多不需要。

在默认模式下，`PuTTY` 将自动尝试推断本地行编辑是否适合您正在使用的会话。

如果您发现它做出了错误的决定，则可以使用此配置选项覆盖其选择：您可以强制打开本地行编辑，或强制关闭它，而不是依赖自动检测。



### 4.3.10 远程控制打印

许多兼容 `VT100` 的终端支持在远程服务器的控制下进行打印（有时称为“直通打印”）。

`PuTTY` 也支持此功能，但默认情况下处于关闭状态。



要启用远程控制打印，请从“打印发送 `ANSI` 打印机输出到”下拉列表框中选择打印机。

这应该允许您从计算机上已安装驱动程序的所有打印机中进行选择。

或者，您可以键入网络打印机的网络名称（例如 `\\printserver\printer1` ），即使您尚未在自己的计算机上安装该打印机的驱动程序。



当远程服务器尝试打印某些数据时，`PuTTY` 会将该数据发送到*原始*打印机 - 无需翻译、尝试格式化或对其执行任何其他操作。

由您来确保您的远程服务器知道它正在与哪种类型的打印机通信。



由于 `PuTTY` 将数据发送到原始打印机，因此它无法提供纵向与横向、打印质量或纸盒选择等选项。

所有这些事情都将由您的 `PC` 打印机驱动程序完成（ `PuTTY` 绕过），如果您需要完成它们，则必须找到一种方法来配置远程服务器来执行它们。



要再次禁用远程打印，请从打印机选择列表中选择“无（禁止打印）”，这是默认状态。



## 4.4 键盘面板

键盘配置面板允许您控制 `PuTTY` 中键盘的行为。

其中许多设置的正确状态取决于 `PuTTY` 连接到的服务器的期望。

对于 `Unix` 服务器，这可能取决于它使用的 `termcap` 或 `terminfo` 条目，而 `Terminal-type string` 条目又可能由“连接”面板中的“终端类型字符串”设置控制，有关详细信息，请参见[第 4.15.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-termtype)。

如果此处的设置似乎都没有帮助，您可能会发现[问题 A.7.13](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/AppendixA.html#faq-keyboard) 很有用。

图c23



### 4.4.1 更改 `Backspace` 回退键的操作

一些终端认为退格键应该向服务器发送与 `Control-H` 相同的内容（ `ASCII` 代码 `8` ）。

其他终端认为退格键应该发送 `ASCII` 码 `127`（通常称为 `Control-?`），以便将其与 `Control-H` 区分开来。

此选项允许您选择按退格键时 `PuTTY`  生成的代码。



如果您通过 `SSH` 进行连接，`PuTTY` 默认会告诉服务器此选项的值（请参阅[第 4.24.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ttymodes)），因此您可能会发现 `Backspace` 键以任何一种方式执行正确的操作。

同样，如果您连接到 `Unix` 系统，您可能会发现 `Unix` 命令 `stty` 允许您配置服务器希望看到的内容，因此您可能不需要做出 `PuTTY` 生成的更改。

在其他系统上，服务器的期望可能是固定的，您可能别无选择，只能配置 PuTTY。



如果可以选择，我们建议您配置 `PuTTY` 以生成 `Control-?` 并将服务器配置为预期这样，因为这允许应用程序（例如`emacs`）使用 `Control-H` 寻求帮助。



（键入 `Shift-Backspace` 将导致 `PuTTY` 发送此处未配置为默认值的任何代码。）



### 4.4.2 更改 `Home` 和 `End` 键的操作

`Unix` 终端仿真器 `rxvt` 不同于世界其他地方关于应该通过 `Home` 和 `End` 键将哪些字符序列发送到服务器的观点。

`xterm`和其他终端，按 `Home` 键发送 `ESC [1` ，按 `End` 键发送 `ESC [4~` 。

`rxvt` 则按 `Home` 键发送 `ESC [H` ，按 `End` 键发送 `ESC [Ow`。



如果您发现某个应用程序的 `HOME` 和 `End` 键不起作用，您可以尝试切换此选项以查看是否有帮助。



### 4.4.3 更改 `Fn` 功能键和小键盘的操作

此选项会影响功能键（ `F1` 到 `F12` ）和数字小键盘的第一行。



- 在默认模式下，标记为 `ESC [n~` ，功能键会生成类似 `ESC [11~``ESC [12~` 的序列，依此类推。这与数字终端的一般行为相匹配。

- 在 `Linux` 模式下，`F6` 到 `F12` 的行为与默认模式类似，但 `F1` 到 `F5` 生成 `ESC [[A` 到 `ESC [[E` 。这模仿了 `Linux` 虚拟控制台。

- 在 `Xterm R6` 模式下，`F5` 到 `F12` 的行为类似于默认模式，但 `F1` 到 `F4` 生成 `ESC OP` 到 `ESC OS` ，这是由 数字终端上*键盘*顶行生成的序列。

- 在 `VT400` 模式下，所有功能键的行为都与默认模式类似，但数字小键盘的实际顶行生成 `ESC OP` 到 `ESC OS` 。

- 在 `VT100+` 模式下，功能键生成 `ESC OP` 到 `ESC O[` 。

- 在 `SCO` 模式下，功能键 `F1` 到 `F12` 生成 `ESC [M` 到 `ESC [X`。

  与 `shift` 一起，它们生成 `ESC [Y` 到 `ESC [j` 。

  与 `control` 一起，它们生成 `ESC [k` 到 `ESC [v` ，并且通过 `shift` 和 `control` 一起生成 `ESC [w` 到 `ESC [{` 。

- 在 `Xterm 216` 模式下，未按 `shift` 功能键的行为与 `Xterm R6` 模式相同。

  但是，将功能键与 `Shift` 或 `Alt` 或 `Ctrl` 一起按下会生成一个不同的序列，其中包含一个额外的数字参数，其形式为 （ `1` 表示 `Shift` ） + （ `2` 表示 `Alt` ） + （ `4` 表示 `Ctrl` ）+ 1。

  对于 `F1-F4` 来说，基本序列如 `ESC OP` 变成`ESC [1;bitmap` ，类似的对于 `F5` 及更高数字的功能键来说，`ESC [index~` 变成 `ESC[index;bitmap~` 。



如果您不知道这意味着什么，您可能不需要修改它。



### 4.4.4 更改 `Shift/Ctrl/Alt` 方向键的动作

此选项会影响方向键，如果按住任何修改键 `Shift` 、`Ctrl` 或 `Alt` 键。

- 在默认模式下，标记为 `Ctrl` 的键切换应用程序模式，`Ctrl` 键在默认方向键序列（如 `ESC[A` 和 `ESC[B` ）之间切换，数字终端在“应用程序光标键”模式下生成的序列（即 `ESC O A` 等）之间切换。`Shift` 和 `Alt` 无效。
- 在“xterm-style bitmap”模式下，`Shift` 、`Ctrl` 和 `Alt` 都会生成不同的序列，数字标识哪组修饰符处于活动状态。



如果您不知道这意味着什么，您可能不需要修改它。



### 4.4.5 控制应用程序光标键模式

应用程序光标键模式是服务器更改箭头键发送的控制序列的一种方式。

在常规模式下，箭头键将 `ESC [A` 发送到 `ESC [D` 。

在应用程序模式下，它们发送 `ESC OA` 到 `ESC OD` 。



应用程序光标键模式可以由服务器打开和关闭，具体取决于应用程序。

`PuTTY` 允许您配置初始状态。

您还可以使用“功能”配置面板完全禁用应用程序光标键模式，请参见[第 4.6.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-features-application)。



### 4.4.6 控制应用程序键盘模式

应用程序键盘模式是服务器更改数字键盘行为的一种方法。

在常规模式下，键盘的行为类似于普通的 `Windows` 键盘：打开 `NumLock` 时，数字键生成数字，关闭 `NumLock` 时，它们的行为类似于方向键和 `Home` ，`End` 等。



在应用程序模式下，所有键盘按键都会发送特殊的控制序列，包括 `Num Lock` 。

`Num Lock` 不再像 `Num Lock` 那样运行，而是成为另一个功能键。



根据您运行的 `Windows` 版本，您可能会发现每次按 `Num Lock` 时 `Num Lock` 指示灯仍然闪烁，即使应用程序模式处于活动状态并且 `Num Lock` 就像功能键一样，这是不可避免的。



应用程序键盘模式可由服务器打开和关闭，具体取决于应用程序。`PuTTY` 允许您配置初始状态。

您还可以使用“功能”配置面板完全禁用应用程序键盘模式，请参见[第 4.6.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-features-application)。



### 4.4.7 使用网络黑客键盘模式

`PuTTY` 有一个特殊的模式来玩 `NetHack` 。

您可以通过在“数字小键盘初始状态”控件中选择“NetHack”来启用它。



在此模式下，数字键盘键 `1-9` 生成 `NetHack` 移动命令 （ `hjklyubn` ）。

按键 `5` 生成命令 `.`（不执行任何操作）。



此外，使用键盘按下 `Shift` 或 `Ctrl` 会生成您期望的 `Shift` 或 `Ctrl` 键（例如，小键盘 `7` 生成 `y` ，因此按 `Shift` 加小键盘 `7` 生成 `Y` ，按 `Ctrl` 加小键盘 `7` 生成 `Ctrl-Y` ），这些命令告诉 `NetHack` 继续将您推向同一方向，直到您遇到有趣的事情。



出于某种原因，此功能仅在 `Num Lock` 打开时才能正常工作。我们不知道为什么。



### 4.4.8 启用类 `DEC` 的 `Compose` 键

`DEC` 终端具有 `Compose` 键，它提供了一种易于记忆的重音字符键入方式。

按下 `Compose` ，然后再键入两个字符。

这两个字符被“组合”以产生重音字符。

字符的选择设计为易于记忆，例如，组合“e”和“”会产生“è”字符。



如果您的键盘具有 `Windows` 应用程序键，它将充当 `PuTTY` 中的 `Compose` 键。

或者，如果启用“ `AltGr` 用作 `Compose` 键”选项，则 `AltGr` 键将成为 `Compose` 键。



### 4.4.9 `Control-Alt` 键与 `AltGr` 不同

某些旧键盘没有 `AltGr` 键，这会使键入某些字符变得困难。

`PuTTY` 可以配置为以与 `AltGr` 键相同的方式处理组合键 `Ctrl+左Alt` 。



默认情况下，此复选框处于选中状态，组合键 `Ctrl+左Alt` 执行完全不同的操作。

`PuTTY` 通常对左 `Alt` 键的处理是将 `Esc` （ `Control-[`） 字符前缀为按键其余部分将生成的任何字符序列。

例如，`Alt-A` 生成转义 `a`  ，因此，`Alt-Ctrl-A` 将后跟 `Control-A` 生成 `Escape` 。



如果取消选中此框，`Ctrl-Alt` 将成为 `AltGr` 的同义词，因此您可以使用它键入额外的图形字符（如果您的键盘有）。

（但是，无论[第 4.4.8 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-compose)中描述的“AltGr 充当 `Compose` 键”的设置如何，`Ctrl-Alt` 都不会充当 `Compose` 键。







## 4.5 响铃面板

响铃面板控制终端铃声功能：服务器能够使 `PuTTY` 向您发出哔哔声。

在默认配置中，当服务器发送带有 `ASCII` 代码 `7` （ `Control-G` ） 的字符时，`PuTTY` 将播放 `Windows` 默认蜂鸣音。

这并不总是您希望终端响铃功能执行的操作，响铃面板允许您配置替代操作。

图d01



### 4.5.1 “设置响铃类型”

此控件允许您选择要在终端响铃上发生的各种不同操作：

- 选择“无”将完全禁用响铃。

  在这种模式下，服务器可以发送任意数量的 `Control-G` 字符，并且根本不会发生任何事情。

- “使用系统默认警告声音”是默认设置。

  它会导致播放窗口“默认哔哔声”声音。

  若要更改此声音是什么，或者在似乎没有任何反应时对其进行测试，请使用 `Windows` 控制面板中的声音配置器。

- “可视响铃 (闪动窗口)”是哔哔声计算机的静音替代品。

  在此模式下，当服务器发送 `Control-G` 时，整个 `PuTTY` 窗口将闪烁白色几分之一秒。

- “使用 PC 扬声器鸣叫”是不言自明的。

- “播放指定的声音文件”允许您指定由 `PuTTY` 单独使用的特定声音文件，甚至由特定的单个 `PuTTY` 会话使用。

  这使您可以区分 `PuTTY` 蜂鸣音和系统上的任何其他蜂鸣音。

  如果选择此选项，则还需要在编辑控件“响铃时播放的声音文件”中输入声音文件的名称。



### 4.5.2 “响铃时任务栏/标题显示”

此功能控制在窗口没有输入焦点时出现铃声时，`PuTTY` 窗口在 `Windows` 任务栏中的条目会发生什么情况。

在默认状态（“禁用”）下，不会发生任何异常情况。

如果选择“反显”，则当铃声响起且窗口未聚焦时，窗口的任务栏条目及其标题栏将更改颜色，以告知 `PuTTY` 会话正在请求您的注意。

颜色的变化将持续到您选择窗口为止，因此您可以在终端中最小化几个 `PuTTY` 窗口，远离键盘，并确保在返回时不会错过任何重要的哔哔声。

“闪烁”更加引人注目：任务栏条目将持续闪烁，直到您选择窗口。



### 4.5.3 “设置重复响铃处理”

终端会话中常见的用户错误是不适当的文件类型（如可执行文件、图像文件或 `ZIP` 文件）意外运行 `Unix` 命令 `cat`（或等效命令）。

这会产生发送到终端的大量非文本字符流，其中通常包括许多响铃字符。

因此，终端通常不会停止哔哔声而持续十分钟，办公室里的其他人都会感到恼火。



为了避免这种行为或任何其他导致过度哔哔声的原因，`PuTTY` 包括响铃过载管理功能。

在默认配置中，在两秒内接收超过 `5` 个响铃字符将导致过载功能激活。

一旦重载功能处于活动状态，进一步的响铃将完全不起作用，因此二进制文件的其余部分将静音发送到屏幕。

在五秒钟内没有收到进一步的响铃后，过载功能将再次自行关闭，响铃将重新启用。



如果您希望完全禁用此功能，您可以使用“大量重复响铃时临时禁用响铃”复选框将其关闭。



或者，如果您喜欢响铃过载功能但不同意设置，则可以配置详细信息：多少响铃构成过载，它们必须到达多长时间才能实现过载，以及过载功能需要多少静默时间自行停用。

铃声过载模式始终由终端中的任何按键停用。

这意味着它可以响应大型意外数据流，但不会干扰生成哔哔声的普通命令行活动（如文件名完成）。



## 4.6 特性面板

`PuTTY` 的终端仿真功能非常强大，可以在远程服务器控制下做很多事情。

其中一些功能可能会由于错误或配置奇怪的服务器应用程序而导致问题。

功能配置面板允许您禁用 `PuTTY` 的一些更高级的终端功能，以防它们引起麻烦。

图d02



### 4.6.1 禁用应用程序键盘和光标键

应用程序键盘模式（请参阅第 4.4.6 节）和应用程序光标键模式（请参阅[第 4.4.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-appkeypad)）会更改键盘和光标键的行为。

某些应用程序启用这些模式，但随后无法正确处理已修改的按键。

无论服务器尝试执行什么操作，都可以强制永久禁用这些模式。



### 4.6.2 禁用 `xterm` 类型鼠标报告

`PuTTY` 允许服务器发送控制代码，使其接管鼠标并将其用于复制和粘贴以外的目的。

使用此功能的应用程序包括文本模式 `Web` 浏览器 `links` ，`Usenet` 新闻阅读器 `trn` 版本4和文件管理器 `mc` （ `Midnight Commander` ）。



如果您发现此功能不方便，可以使用“禁用 `xterm` 类型鼠标报告”控件禁用它。

选中此框后，鼠标将*始终*以正常方式进行复制和粘贴。



请注意，即使应用程序接管了鼠标，您仍然可以通过在选择和粘贴时按住 `Shift` 键来管理 `PuTTY` 的复制和粘贴，除非您有意关闭此功能（请参阅[第 4.11.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-mouseshift)）。



### 4.6.3 禁用改变远程控制终端大小

`PuTTY` 能够根据服务器的命令更改终端的大小和位置。

如果您发现 `PuTTY` 意外或不方便地执行此操作，您可以告诉 `PuTTY` 不要响应这些服务器命令。



### 4.6.4 禁用切换终端屏幕

包括 `PuTTY` 在内的许多终端都支持“备用屏幕”。

这与普通终端屏幕的尺寸相同，但是是分离的。

通常，基于屏幕的程序（如文本编辑器）可能会在启动之前将终端切换到备用屏幕。

然后在运行结束时，它会切换回主屏幕，您会看到屏幕内容，就像启动编辑器之前一样。



有些人宁愿这种情况不发生。

如果您希望编辑器与终端活动的其余部分在同一屏幕中运行，则可以完全禁用备用屏幕功能。



### 4.6.5 禁用改变远程控制窗口标题

`PuTTY` 能够更改窗口标题以响应来自服务器的命令。

如果您发现 `PuTTY` 意外或不方便地执行此操作，您可以告诉 `PuTTY` 不要响应这些服务器命令。



### 4.6.6 对远程窗口标题查询的响应

`PuTTY` 可以选择提供允许服务器应用程序查找本地窗口标题的 `xterm` 服务。

默认情况下，此功能处于禁用状态，但如果您确实需要，可以将其打开。



请注意，此功能存在*潜在的安全隐患*。

如果恶意应用程序可以将数据写入您的终端（例如，如果您只是服务器计算机上 `cat` 其他人拥有的文件），它可以更改您的窗口标题（除非您已按照[第 4.6.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-features-retitle)所述禁用此功能），然后使用此服务将新窗口标题发送回服务器，就像在键盘上键入一样。

这允许攻击者伪造按键，并可能导致您的服务器端应用程序执行您不希望的操作。

因此，此功能默认处于禁用状态，我们建议您不要将其设置为“窗口标题”，除非您*真的*知道自己在做什么。



此选项有三个设置：

- “无”

  `PuTTY` 对相关的转义序列没有任何反应。

  这可能会扰乱期望某种响应的服务器端软件。

- “空字符串”

  `PuTTY` 会做出格式正常的反映，仅将其留保持为空即可。

  因此，就能够期望服务器端软件可以保持满意的响应，而攻击者无法影响响应后的字符串。

  如果您没有更好的想法，这可能是您想要的设置。

- “窗口标题”

  `PuTTY` 使用实际的窗口标题进行响应。
  
  由于上述原因，这是危险的。



### 4.6.7 禁用远程控制清除回滚

`PuTTY` 能够清除终端的回滚缓冲区以响应来自服务器的命令。

如果您发现 `PuTTY` 意外或不方便地执行此操作，您可以告诉 `PuTTY` 不要响应该服务器命令。



### 4.6.8 禁用服务器发送 `^?` 时破坏性回退删除

通常，当 `PuTTY` 从服务器接收到字符 `127` （ `^?` ） 时，它将执行“破坏性退格”：将光标向左移动一个空格并删除其下方的字符。

这显然会导致某些应用程序出现问题，因此 `PuTTY` 提供了将字符 `127` 配置为执行正常退格键（不删除字符）的功能。



### 4.6.9 禁用远程控制字符集设置

`PuTTY` 能够更改其字符集配置以响应来自服务器的命令。

某些程序意外或不方便地发送这些命令。

特别是，`BitchX`（ `IRC` 客户端）似乎习惯于将字符集重新配置为用户预期以外的字符集。

如果您发现重音字符没有按预期方式显示，尤其是在您运行的是 `BitchX` 时，您可以尝试禁用远程字符集配置命令。



### 4.6.10 禁用修整阿拉伯文本

`PuTTY` 支持阿拉伯文本的修整，这意味着如果您的服务器发送以基本 `Unicode` 阿拉伯字母书写的文本，那么它会在将其打印到屏幕上之前将其转换为正确的显示形式。



如果您使用的是全屏软件，而该软件没有预料到会发生这种情况（特别是如果您不是阿拉伯语使用者，并且意外地发现自己在无法识别阿拉伯语的应用程序中处理阿拉伯语文本文件），您可能会发现显示内容被破坏。

通过勾选此框，您可以禁用阿拉伯文本修整，以便 `PuTTY` 精确显示它被告知要显示的字符。

您可能还会发现需要禁用双向文本显示;请参阅[第 4.6.11 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-features-bidi)。



### 4.6.11 禁用双向文本显示

`PuTTY` 支持双向文本显示，这意味着如果您的服务器发送以通常从右到左显示的语言（例如阿拉伯语或希伯来语）编写的文本，则 `PuTTY` 将自动将其翻转，使其在屏幕上以正确的方向显示。



如果您使用的是全屏软件，而该软件没有预料到会发生这种情况（特别是如果您不是阿拉伯语使用者，并且意外地发现自己在无法识别阿拉伯语的应用程序中处理阿拉伯语文本文件），您可能会发现显示内容被破坏。

通过勾选此框，您可以禁用双向文本显示，以便 `PuTTY` 在所有情况下从左到右显示文本。



您可能还会发现需要禁用阿拉伯文本修整;请参阅[第 4.6.10 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-features-shaping)。



## 4.7 窗口面板

窗口配置面板允许您控制 `PuTTY` 窗口的各个方面。

图d03



### 4.7.1 设置 `PuTTY` 窗口的大小

“列”和“行”框可让您将 `PuTTY` 窗口设置为精确大小。

当然，您也可以在会话运行时将窗口拖动到新大小。



### 4.7.2 调整窗口大小时该怎么办

这些选项允许您控制当用户尝试使用其窗口调整 `PuTTY` 窗口大小时发生的情况。

这里有四个选项：

- “改变行列数”：字体大小不会更改。（这是默认值。）
- “改变字体大小”：终端中的行数和列数将保持不变，字体大小将发生变化。
- “只在最大化时改变字体大小”：调整窗口大小时，行数和列数将更改，*除非*窗口最大化（或恢复）时，字体大小将更改。（在此模式下，在调整大小的同时按住 `Alt` 键也会导致字体大小更改。）
- “完全禁用窗口大小改变”：终端将拒绝调整大小。



### 4.7.3 设置窗口回滚

这些选项允许您配置 `PuTTY` 在文本滚动到屏幕顶部后保留文本的方式（请参阅[第 3.1.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-scrollback)）。

“回滚行数”框可让您配置 `PuTTY` 保留的文本行数。

“显示滚动条”选项允许您隐藏滚动条（尽管您仍然可以按照[第 3.1.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-scrollback)所述使用键盘查看回滚）。

您可以单独配置滚动条是在全屏模式下显示还是在正常模式下显示。



如果在服务器向 `PuTTY` 发送更多文本时查看部分回滚，屏幕将恢复为显示当前终端内容。

您可以通过关闭“重置显示活动时的回滚”来禁用此行为。

您还可以在按键时通过打开“按键时重置回滚”来使屏幕恢复。



### 4.7.4 “将清除的文本压入回滚”

启用此选项后，当服务器端应用程序清除屏幕时，终端屏幕的内容将被推送到回滚中，以便您的回滚将包含过去屏幕上内容的更好记录。



如果应用程序切换到备用屏幕（有关详细信息，请参阅[第 4.6.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-features-altscreen)），则主屏幕的内容将在回滚中可见，直到应用程序再次切换回来。

默认情况下，此选项处于启用状态。



## 4.8 外观面板

外观配置面板允许您控制 `PuTTY` 窗口外观的各个方面。

图d04



### 4.8.1 控制光标的外观

“光标显示”选项允许您将光标配置为块、下划线或垂直线。

当窗口失去焦点时，块光标变为空框，下划线或垂直线变为虚线。

“光标闪烁”选项使光标闪烁和关闭，这适用于任何光标模式。



### 4.8.2 控制终端窗口中使用的字体

此选项允许您选择 `PuTTY` 终端窗口用于显示会话中文本的字体和大小。

默认情况下，系统将提供系统上安装的所有固定宽度字体的选择，因为 `VT100` 样式的终端处理需要固定宽度的字体。

但是，如果您勾选标有“启用可变间距字体”的框，`PuTTY` 也将提供可变宽度字体：如果您选择其中一种，字体将被强制转换为固定大小的字符单元格，这可能看起来不太好（但可以与某些字体一起使用）。



### 4.8.3 “在窗口中键入时隐藏鼠标指针”

如果启用此选项，则在选择 `PuTTY` 窗口并按下某个键时，鼠标指针将消失。

这样，当您在会话中工作时，它不会遮挡窗口中的任何文本。

一旦您移动鼠标，指针就会重新出现。

默认情况下，此选项处于禁用状态，因此鼠标指针始终保持可见。



### 4.8.4 调整窗口边框

`PuTTY` 允许您在一定程度上配置窗口边框的外观。

标记为“下沉边框(细瘦外观)”的复选框将窗口边框的外观更改为更像 `DOS` 框的外观：边框的内边缘突出显示，就好像它下沉与窗口内的表面相遇一样。

这使得边框也更粗一点，很难很好地描述。

尝试一下，看看你是否喜欢它。

您还可以使用“文本与窗口边界的距离”控件在窗口中的文本和边框之间配置完全空白的间隙。

默认情况下，此值设置为一个像素。

您可以将其减少到零，也可以进一步增加。



## 4.9 行为面板

行为配置面板允许您控制 `PuTTY` 窗口行为的各个方面。

图d05



### 4.9.1 调整窗口标题外观

“窗口标题”编辑框允许您设置 `PuTTY` 窗口的标题。

默认情况下，窗口标题将包含主机名，后跟“PuTTY”，例如，`server1.example.com - PuTTY` 。

如果您想要不同的窗口标题，则可以在此处设置它。



`PuTTY` 允许服务器发送 `xterm` 控制序列，这些控制序列在会话中修改窗口的标题（除非禁用此功能 - 请参阅[第 4.6.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-features-retitle)）;因此，此处设置的标题字符串只是*初始*窗口标题。



除了窗口标题外，还有一个修改窗口标题图标的 `xterm` 序列。

这在窗口系统中是有意义的，其中窗口在最小化时成为图标，例如 `Windows 3.1` 或大多数 `X` 窗口系统设置;但在类似 `Windows 95` 的用户界面中，它并不适用。



默认情况下，`PuTTY` 仅使用服务器提供的窗口标题，并完全忽略图标标题。

如果出于某种原因您想同时查看两个标题，请选中标有“使用单独的客户区窗口”的框。

如果执行此操作，`PuTTY` 的窗口标题和任务栏标题将更改为服务器提供的图标标题（如果最小化 `PuTTY` 窗口），如果还原它，则更改回服务器提供的窗口标题。（如果服务器没有费心提供窗口或图标标题，则不会发生任何情况。



### 4.9.2 “关闭窗口时警告”

如果您在包含正在运行的会话的 `PuTTY` 窗口中按下“关闭”按钮，`PuTTY` 将显示一个警告窗口，询问您是否真的要关闭该窗口。

会话已终止的窗口始终可以关闭而不发出警告。

如果您希望能够快速关闭窗口，则可以禁用“关闭窗口前警告”选项。



### 4.9.3 “ALT+F4 关闭窗口”

默认情况下，按 `ALT+F4` 会导致窗口关闭（或出现警告框;请参阅[第 4.9.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-warnonclose)）。

如果禁用“窗口在 `ALT+F4` 上关闭”选项，则按 `ALT-F4` 将简单地将键序列发送到服务器。



### 4.9.4 “Alt+空格显示系统菜单”

如果启用此选项，则按 `ALT+空格键` 将弹出 `PuTTY` 窗口的菜单，就像单击窗口的左上角一样。

如果禁用，则按 `ALT+空格键` 将只发送 `ESC+SPACE` 到服务器。



某些适用于 `Windows` 的辅助功能程序可能需要此选项才能成功控制 `PuTTY` 的窗口。

例如，`Dragon NaturalPeaks` 要求它既要通过语音打开系统菜单，又要关闭，最小化，最大化和恢复窗口。



### 4.9.5 “Alt键显示系统菜单”

如果启用此选项，则按下并释放 `ALT` 将弹出 `PuTTY` 窗口的菜单，就像单击左上角一样。

如果禁用，则按下并释放 `ALT` 将不起作用。



### 4.9.6 “窗口总在最上层”

如果启用此选项，`PuTTY` 窗口将位于所有其他窗口的顶部。



### 4.9.7 “Alt+回车全屏”

如果启用此选项，则按 `Alt+Enter` 将导致 `PuTTY` 窗口变为全屏。

再次按 `Alt+Enter` 将恢复以前的窗口大小。

全屏功能也可从“系统”菜单中使用，即使已经配置了在 `Alt+Enter` 键上不可全屏。请参见[第 3.1.3.7 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-fullscreen)。



## 4.10 转换面板

转换配置面板允许您控制服务器理解的字符集与 `PuTTY` 理解的字符集之间的转换。

图d06



### 4.10.1 控制字符集转换

在交互式会话期间，`PuTTY` 从服务器接收 `8` 位字节流，为了在屏幕上显示它们，它需要知道要解释它们的字符集。

同样，`PuTTY` 需要知道如何将您的击键转换为服务器期望的编码。

不幸的是，`PuTTY` 和服务器没有令人满意的机制来传达此信息，因此通常必须手动配置。



有很多字符集可供选择。

“远程字符集”选项可让您选择一个字符集。



默认情况下，`PuTTY` 将使用 `Unicode` 的 `UTF-8` 编码，它几乎可以表示任何字符。

来自服务器的数据被解释为 `UTF-8` ，击键以 `UTF-8` 编码发送。

这是大多数现代 `Linux` 发行版默认所期望的。

但是，如果你的服务器出现了字符错误，则可以使用此控件选择其他字符集。



其他一些值得注意的字符集是：

- `ISO-8859` 系列都是标准字符集，包括适用于不同语言集的各种重音字符。

- `Win125x` 系列由微软定义，用于类似目的。

  特别是 `Win1252` 几乎等同于 `ISO-8859-1` ，但包含一些额外的字符，例如匹配的引号和欧元符号。

- 如果要使用块图形和线条绘制字符的旧 `IBM PC` 字符集，可以选择“CP437”。



如果需要支持下拉列表中未列出的数字代码页（如代码页 `866` ），则可以尝试在列表框中手动输入其名称（例如 `CP866` ）。

如果 `Windows` 的基础版本安装了相应的转换表，`PuTTY` 将使用它。



### 4.10.2 “将不明确字符处理为 `CJK` 中日韩字符”

有一些 `Unicode` 字符的宽度没有明确定义。

在大多数情况下，出于换行等目的，此类字符应被视为单角字符。

但是，在某些 `CJK` 上下文中，由于历史原因，它们最好被视为双倍宽度，并且某些服务器端应用程序可能希望它们以这种方式显示。

设置此选项将导致 `PuTTY` 采用双倍宽度解释。



如果您使用旧版 `CJK` 应用程序，并且发现您换行在错误的位置，或者您遇到其他显示问题，则可能需要使用此设置。

此选项仅在 `UTF-8` 模式下有效（请参阅[第 4.10.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-charset)）。



### 4.10.3 “`Caps Lock` 大小写按键用于 `Cyrillic` 切换”

如果您需要在同一文档中并排键入（例如）俄语和英语，此功能允许您使用 `Caps Lock` 键在美国/英国键盘布局和西里尔文键盘布局之间切换。

目前，如果您的本机键盘布局不是美国或英国，则此功能预计无法正常工作。



### 4.10.4 调整 `PuTTY` 如何重绘字符行

`VT100` 系列终端允许服务器发送控制序列，这些控制序列暂时转换为单独的字符集，用于绘制简单的线条和框。

但是，`PuTTY` 可以通过多种方式尝试查找合适的字符，使用正确的字符取决于本地配置的字体。

一般来说，您可能应该尝试很多选项，直到找到您的特定字体支持的选项。



- “使用 `Unicode` 统一码重绘代码”尝试使用 `Unicode` 中存在的框字符。

  对于良好的 `Unicode` 支持字体，这可能是最可靠和最实用的选择。

- “简单重绘行”假设字体*根本无法*生成线条和框字符，因此它将使用 `+` 、 `-` 和 `|` 字符来绘制框的近似值。

  如果其他选项都不起作用，则应使用此选项。

- “使用 `X Windows` 编码字体”适用于具有特殊编码的字体，其中最低的 `32` 个字符位置（低于 `ASCII` 可打印范围）包含线条绘制字符。

  任何标准 `Windows` 字体都不太可能出现这种情况;它可能仅适用于自定义构建的字体或从 `X Window` 系统自动转换的字体。

- “使用 `ANSI` 和 `OEM` 字体”尝试在两个不同的字符集中使用相同的字体，以获得更广泛的字符范围。

  这并不总是有效，某些字体声称大小不同，具体取决于您尝试使用的字符集。

- “只使用 `OEM` 字体”比这更可靠，但可能会错过主要字符集中的其他字符。



### 4.10.5 重绘字符类似 `lqqqk` 复制粘贴行

默认情况下，当您复制并粘贴包含 `VT100` 线条和框绘图字符的 `PuTTY` 屏幕片段时，`PuTTY` 会以它们在屏幕上显示的形式粘贴它们：`Unicode` 行绘制代码点或“简单”地线绘制字符 `+` 、 `-` 和 `|` 。

“将 `VT100` 线绘制字符复制并粘贴为 lqqqk”复选框禁用此功能，结果就是线绘制字符将粘贴为打印以生成它们的 `ASCII` 字符。

这通常意味着它们大多以 `q` 和 `x` 的形式出现，在拐角处有零星的 `jklmntuvw` 。

例如，如果您尝试在另一个程序中重新创建相同的框布局，这可能很有用。



请注意，此选项仅适用于使用 `VT100` *机制打印的*线绘制字符。

作为 `Unicode` 码位接收的线绘制字符将始终粘贴为 `Unicode` 代码点。



### 4.10.6 即使在 `UTF-8` 模式下也启用 `VT100` 线绘制

如果 `PuTTY` 配置为将来自服务器的数据视为 `UTF-8` 编码，则默认情况下，它会禁用较旧的 `VT100` 样式控制序列系统，该系统会导致小写字母暂时替换为线绘制字符。



其基本原理是，在 `UTF-8` 模式下，您无论如何都不需要这些控制序列，因为它们访问的所有线字符都已经作为 `Unicode` 字符提供，因此应用程序无需将终端置于特殊状态来获取它们。



此外，它消除了终端*意外*进入该状态的风险：如果您不小心将不受控制的二进制数据写入非 `UTF-8` 终端，则发现下一个 `shell` 提示符显示为一系列线绘制字符，然后您必须记住或查找如何退出该模式，这是非常普遍的。

因此，默认情况下，`UTF-8` 模式根本没有像这样令人困惑的模式，无论是*意外的还是*故意的。



但是，并非所有应用程序都会这样看。

即使是 `UTF-8` 终端用户有时仍然必须运行尝试以老式方式打印线绘制字符的软件。

因此，配置选项“即使在 `UTF-8` 模式下也能启用 `VT100` 线绘制”将 `PuTTY` 置于混合模式，在该模式下，它理解更改 `ASCII` 小写字母含义的 `VT100` 样式控制序列，并理解 `UTF-8`。



## 4.11 选择面板

“选择”面板允许您在 `PuTTY` 窗口中控制复制和粘贴的工作方式。

图d07



### 4.11.1 更改鼠标按钮的操作

`PuTTY` 的复制和粘贴机制默认以 `Unix` 应用程序 `xterm` 为模型。

`X Window` 系统使用三键鼠标，该系统中的约定是左按钮选择，右按钮扩展现有选择，中间按钮粘贴。



`Windows` 通常只有两个鼠标按钮，因此在 `Windows` 上运行时，`PuTTY` 是可配置的。

在 `PuTTY` 的默认配置（“妥协”）中，*右*键粘贴，*中间*按钮（如果有）扩展选择。



如果您有三键鼠标并且已经习惯了 `xterm` 这种排列方式，则可以使用“鼠标按钮动作”控件选择它。



或者，选择“Windows”选项后，中间按钮扩展，右键弹出一个上下文菜单（其中一个选项是“粘贴”）。

（无论此选项的设置如何，通过按住 `Ctrl` 并右键单击始终可以使用此上下文菜单。）

（当 `PuTTY` 本身在 `Unix` 上运行时，它遵循 `X Window` 系统约定。）



### 4.11.2 “`Shift` 上档键可与鼠标组合使用”

`PuTTY` 允许服务器发送控制代码，使其接管鼠标并将其用于复制和粘贴以外的目的。

使用此功能的应用程序包括文本模式 `Web` 浏览器 `links` ，`Usenet` 新闻阅读器 `trn` 版本 `4` 和文件管理器 `mc` （ `Midnight Commander` ）。



运行这些应用程序之一时，按鼠标按钮不再执行复制和粘贴。

如果确实需要复制和粘贴，如果在单击鼠标时按住 `Shift` ，仍然可以执行此操作。



但是，从理论上讲，应用程序甚至可以检测和使用 `Shift + 鼠标单击` 。

我们不知道有任何应用程序可以这样做，但如果有人编写了一个应用程序，取消选中“ `Shift` 覆盖应用程序使用鼠标”复选框将导致 `Shift + 鼠标单击` 也转到服务器（以便完全禁用鼠标驱动的复制和粘贴）。



如果要阻止应用程序完全接管鼠标，可以使用“特性”控制面板执行此操作;请参见[第 4.6.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-features-mouse)。



### 4.11.3 默认选择模式

如[第 3.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-selection)所述，`PuTTY` 有两种选择要复制到剪贴板的文本的模式。

在默认模式（“正常”）下，将鼠标从 `A` 点拖动到 `B` 点，选择到包含 `A` 的行的末尾、中间的所有行以及包含 `B` 的行的最开头。

在另一种模式（“矩形框”）中，在两点之间拖动鼠标定义一个矩形，并复制该矩形中的所有内容。



通常，您必须在拖动鼠标时按住 `Alt` 以选择矩形块。

使用“默认选择模式”控件，您可以将矩形选择设置为默认值，然后必须按住 `Alt` 才能获得*正常*行为。



### 4.11.4 将复制和粘贴操作分配给剪贴板

在这里，您可以配置通过 `PuTTY` 的各种复制和粘贴操作写入或读取的剪贴板。

大多数平台（包括 `Windows` ）都有一个系统剪贴板。

在这些平台上，`PuTTY` 提供了第二个类似剪贴板的功能，允许您粘贴您上次在此*窗口中*选择的文本，无论它当前是否也在系统剪贴板中。

默认情况下不启用此功能。



`X Window` 系统（大多数 `Unix` 图形界面的基础）提供了多个剪贴板（或“选择”），许多应用程序通过不同的用户界面机制支持多个剪贴板。

当 `PuTTY` 本身在 `Unix` 上运行时，它具有与这些选择相关的更多可配置性。



两个最常用的选择称为“PRIMARY”和“CLIPBOARD”。

在同时支持这两种操作的应用程序中，通常的行为是 `PRIMARY` 仅鼠标操作使用（选择文本会自动将其复制到 `PRIMARY` ，中键单击粘贴自 `PRIMARY` ），而 `CLIPBOARD` 由显式的“复制和粘贴”菜单项或按键（如 `Ctrl-C` 和 `Ctrl-V` ）使用。



#### 4.11.4.1 “自动复制选择的文本”

复选框“自动复制选择的文本到：系统剪贴板”控制在 `PuTTY` 终端窗口中选择文本是否自动具有将其复制到系统剪贴板，而无需单独的用户界面操作。



在 `X` 上，此选项的措辞略有更改，因此使用“剪贴板”代替“系统剪贴板”。

在终端窗口中选择的文本将始终自动放置在 `PRIMARY` 选择中，这是常规的，但是如果您勾选此框，它也将同时放置在“`CLIPBOARD` 剪贴板”中。



#### 4.11.4.2 为 `UI` 操作选择剪贴板

`PuTTY` 有三个用户界面操作，可以配置为粘贴到终端中（不包括菜单项）。

您可以单击配置为粘贴的任何鼠标按钮（如果有）（请参阅[第 4.11.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-mouse)），您可以按移入，或者您可以按 `Ctrl-Shift-V` ，尽管默认情况下不启用该操作。



您可以配置每个操作从哪些可用剪贴板粘贴（包括完全关闭粘贴操作）。

在具有单个系统剪贴板的平台（如 `Windows` ）上，可用的选项是从该剪贴板粘贴，或从 `PuTTY` 的内部内存粘贴该窗口中最后一个选定的文本。

在 `X` 上，标准选项为 `CLIPBOARD` 或 `PRIMARY` 。



( `PRIMARY` 在概念上相似，因为它也引用最后选定的文本 - 仅跨所有应用程序，而不仅仅是此窗口。)



这两个键盘选项都带有一个相应的键，可以复制到同一个剪贴板。

无论您将 `Shift-Ins` 配置为从中粘贴，`Ctrl-Ins` 都将复制到同一位置；类似地，`Ctrl-Shift-C` 将复制到 `Ctrl-Shifte-V` 粘贴的任何位置。



在 `X` 上，您还可以输入您选择的名称。

例如，有一个很少使用的标准选择叫做 `SECONDARY` ，`Emacs`（例如）如果你在拖动选择或点击粘贴时按住 `Meta` 键，则可以使用它；如果配置 `PuTTY` 键盘操作以访问此剪贴板，则可以与其他应用程序的使用进行互操作。

您可以做的另一件事是自己创建一个剪贴板名称，创建一个仅在 `PuTTY` 实例之间共享的特殊剪贴板，或者仅在以该特定方式配置的实例之间共享。



### 4.11.5 “启用粘贴含有控制字符的文本”

剪贴板可能不仅包含文本（带有换行符和制表符），还可以包含诸如 `ESC` 之类的控制字符，如果粘贴到终端会话中，可能会产生令人惊讶的效果，具体取决于服务器端正在运行的程序。

从恶作剧的网页复制文本可能会将这些字符放在剪贴板上。



默认情况下，`PuTTY` 会过滤掉更不寻常的控制字符，只允许通过更明显的文本格式字符（换行符、制表符、退格键和 `DEL` ）。



设置此选项将停止此筛选;粘贴时，剪贴板上的任何字符都会未经审查地发送到会话。

例如，如果您有意将控件字符粘贴用作简单的脚本形式，这可能很有用。



## 4.12 复制面板

复制配置面板控制与从终端窗口复制到剪贴板相关的行为。

图d08



### 4.12.1 字符类

如果您双击开始拖动，`PuTTY` 将在终端窗口中一次选择一个单词。

此部分允许您精确控制被视为单词的内容。



每个字符都有一个类，是一个小数字（通常为 `0` 、`1` 或 `2` ）。

`PuTTY` 认为单个单词是同一类中任意数量的相邻字符。

因此，通过修改对类的字符分配，可以修改逐字选择行为。



在默认配置中，字符类为：

- 类 `0` 包含空格和控制字符。
- 类 `1` 包含大多数标点符号。
- 第 `2` 类包含字母、数字和一些标点符号（双引号、减号、句点、正斜杠和下划线）。



因此，例如，如果将符号 `@` 分配给字符类 `2` ，则只需双击即可选择电子邮件地址。



为了调整这些分配，首先在列表框中选择一组字符。

然后在下面的编辑框中输入班级编号，然后按“设置”按钮。



此机制目前仅涵盖 `ASCII` 字符，因为扩展列表以涵盖整个 `Unicode` 是不可行的。



字符类定义可以通过服务器发送的控制序列进行修改。

此配置选项控制*默认*状态，该状态将在重置终端时恢复（请参阅[第 3.1.3.6 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#reset-terminal)）。

但是，如果您在会话中途使用“更改设置”修改此选项，它将立即生效。



### 4.12.2 富文本格式复制

如果您启用“粘贴 `RTF` 文本到剪贴板”，`PuTTY` 会将格式信息以及您复制的实际文本写入剪贴板。

这样做的效果是，如果您粘贴到（例如）文字处理器中，文本将以与 `PuTTY` 用于显示它的字体、颜色和样式（例如粗体、下划线）相同的字体、颜色和样式出现在文字处理器中。



此选项很容易不方便，因此默认情况下处于禁用状态。



## 4.13 颜色面板

“颜色”面板允许您控制 `PuTTY` 对颜色的使用。

图d09



### 4.13.1 “允许终端指定 `ANSI` 颜色”

默认情况下，此选项处于启用状态。

如果禁用，`PuTTY` 将忽略服务器发送的任何控制序列以请求彩色文本。



如果你有一个特别花哨的应用程序，你可能想关闭这个选项，使 `PuTTY` 只使用默认的前景色和背景色。



### 4.13.2 “启用终端使用 `xterm 256` 色模式”

默认情况下，此选项处于启用状态。

如果禁用，`PuTTY` 将忽略服务器发送的任何控制序列，这些控制序列使用最新版本 `xterm` 支持的扩展 `256` 色模式。



如果你有一个应该使用 `256` 色模式的应用程序，但它不起作用，你可能会发现你需要告诉你的服务器你的终端支持 `256` 色。

在 `Unix` 上，您可以通过确保 `TERM` 的设置描述一个支持 `256` 色的终端来执行此操作。

您可以使用以下命令进行检查，例如：`infocmp` ：

```
$ infocmp | grep colors
        colors#256, cols#80, it#8, lines#24, pairs#256,
```



如果在输出中没有看到“ `colors#256` ”，则可能需要更改终端设置。

在现代 `Linux` 机器上，您可以尝试“ `xterm-256color` ”。



### 4.13.3 “启用终端使用 `24` 位颜色”

默认情况下，此选项处于启用状态。

如果禁用，`PuTTY` 将忽略服务器发送的任何控制序列，这些控制序列使用现代终端支持的控制序列来指定任意 `24` 位 `RGB` 颜色值。



### 4.13.4 “粗体文本表现”

当服务器发送一个控制序列，指示某些文本应以粗体显示时，`PuTTY` 可以通过多种方式处理此问题。

它可以更改粗体版本的字体，也可以使用相同的字体以获得更明亮的颜色，或者它可以同时执行这两项操作（使颜色变亮*并使*字体加粗）。

此控件允许您选择哪个。



默认情况下，粗体由颜色表示，因此非粗体文本以浅灰色显示，粗体文本以亮白色显示（同样以其他颜色显示）。

如果您将设置更改为“字体”框，粗体和非粗体文本将以相同的颜色显示，而是字体将更改以指示差异。

如果选择“两者”，字体和颜色都会改变。



一些应用程序依赖于“粗体黑色”与黑色背景的区别，如果您选择“字体”，则其文本可能会变得不可见。



### 4.13.5 “尝试使用逻辑调色板”

逻辑调色板是一种机制，通过该机制，在 `8` 位彩色显示器上运行的 `Windows` 应用程序可以精确选择所需的颜色，而不是使用 `Windows` 标准默认值。

如果您在 `8` 位显示器上没有获得所需的颜色，您可以尝试启用此选项。

但是，请注意，它从来没有很好地工作过。



### 4.13.6 “使用系统颜色”

启用此选项将导致 `PuTTY` 忽略“默认背景/前景”和“光标颜色/文本”的配置颜色（请参阅[第 4.13.7 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-colourcfg)），而是使用系统范围的默认值。

请注意，如果启用此选项，非粗体文本和粗体文本的颜色将相同。

您可能希望通过更改字体更改为指示粗体文本（请参阅[第 4.13.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-boldcolour)）。



### 4.13.7 调整终端窗口中的颜色

主颜色控件允许您准确指定事物应以什么颜色显示。

若要修改 `PuTTY` 颜色之一，请使用列表框选择要修改的颜色。

该颜色的 `RGB` 值将显示在列表框的右侧。

现在，如果您按下“修改”按钮，您将看到一个颜色选择器，您可以在其中选择新颜色来代替旧颜色。

（如果您愿意，您也可以直接在编辑框中编辑 `RGB` 值;每个值都是 `0` 到 `255` 之间的整数。



`PuTTY` 允许您设置光标颜色、默认前景和背景以及所有 `ANSI` 可配置颜色（黑色、红色、绿色、黄色、蓝色、品红色、青色和白色）的精确阴影。

您还可以修改用于这些颜色的粗体版本的精确色调;如果您选择通过颜色指示粗体文本，则它们用于显示粗体文本（请参阅[第 4.13.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-boldcolour)），如果服务器特别要求使用它们。也可以使用它们。

（请注意，“默认粗体背景”*不是*用于粗体文本的背景颜色;仅当服务器特别要求粗体背景时才使用。）



## 4.14 连接面板

“连接”面板允许您配置适用于多种连接类型的选项。

图d10



### 4.14.1 使用激活来防止断开连接

如果您发现会话在空闲一段时间后意外关闭（通常为“由对等方重置连接”），您可能需要尝试使用此选项。

某些网络路由器和防火墙需要跟踪通过它们的所有连接。

通常，如果在一定时间间隔后没有数据在任一方向上传输，这些防火墙将假定连接已失效。

这可能会导致 `PuTTY` 会话在一段时间内未在会话中看到流量时被防火墙意外关闭。



激活选项（“空包发送时间间隔”）允许您将 `PuTTY` 配置为定期通过会话发送数据，而不会中断实际的终端会话。

如果您发现防火墙正在切断空闲连接，则可以尝试在此字段中输入非零值。

该值以秒为单位，因此，例如，如果您的防火墙在十分钟后切断连接，那么您可能需要在框中输入 `300` 秒（ `5` 分钟）。



请注意，保持连接并不总是有帮助的。

如果您的防火墙在空闲期后会断开连接，它们会有所帮助，但是，如果您和服务器之间的网络受到连接中断的影响，那么 `keepalives` 保持连接实际上会使事情变得更糟。

如果会话处于空闲状态，并且端点之间的连接暂时丢失，但连接在任何一方尝试发送任何内容之前恢复，则不会有问题 - 两个端点都不会注意到有任何问题。

但是，如果一方在空闲期间确实发送了某些内容，它将反复尝试重新发送，最终放弃连接。

然后，当连接恢复时，另一方会发现第一方不再相信已经存在的开放的连接。

`Keepalives` 保持连接可能会使这类问题变得更糟，因为它们增加了 `PuTTY` 在连接中断期间尝试发送数据的可能性。

（其他类型的定期网络活动可能会导致此行为;特别是，SSH-2 重新密钥可能会产生这种影响。请参阅[第 4.18.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-kex-rekey)。）



因此，您可能会发现 `keepalives` 有助于连接丢失，或者您可能会发现它们会使情况变得更糟，具体取决于您和服务器之间存在*的网络问题类型*。

Keepalives仅在Telnet和SSH中受支持;Rlogin，SUPDUP和Raw协议不提供实现它们的方法。（有关替代方法，请参见[第 4.14.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-tcp-keepalives)。

请注意，如果您使用的是 `SSH-1` ，并且服务器存在使其无法处理 `SSH-1` 忽略消息的错误（请参阅[第 4.27.13 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-bug-ignore1)），则启用激活将不起作用。



### 4.14.2 “禁用 `Nagle` 算法”

`Nagle` 的算法是 `TCP/IP` 实现的一个细节，它试图最大限度地减少通过网络连接发送的小数据包的数量。

启用 `Nagle` 算法后，`PuTTY` 的带宽使用效率会略高一些;禁用它后，您可能会发现在连接到某些类型的服务器时，您的击键响应速度更快。

默认情况下，对于交互式连接禁用 `Nagle` 算法。



### 4.14.3 “启用 `TCP` 保持活动连接”

*注意：*`TCP` 激活不应与[第 4.14.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-keepalive)中描述的应用程序级激活混淆。

如果有疑问，您可能需要应用程序级保持连接;提供 `TCP` 保持连接是为了完整性。



`TCP` 保持连接的想法类似于应用程序级保持连接，并且相同的警告适用。主要区别是：

- `TCP` 保持连接*在所有网络连接类型*上都可用，包括 `Raw` 、`Rlogin` 和 `SUPDUP` 。
- `TCP` 保持连接之间的间隔通常要长得多，通常为两个小时;这是由操作系统设置的，无法在 `PuTTY` 中进行配置。
- 如果操作系统没有收到对保持连接的响应，它可能会快速连续发送更多响应，并在未收到响应时终止连接。



`TCP` 保持连接对于确保终止半打开的连接可能比保持连接处于活动状态更有用。

默认情况下，`TCP` 保持连接处于禁用状态。



### 4.14.4 “互联网协议版本”

此选项允许用户在新旧互联网协议和寻址方案（ `IPv4` 和 `IPv6` ）之间进行选择。

所选协议将用于大多数传出网络连接（包括与代理的连接）;但是，隧道有自己的配置，有关配置，请参见[第 4.26.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-portfwd-address-family)。



默认设置为“自动”，这意味着 `PuTTY` 将执行一些明智的操作并尝试猜测您想要的协议。

（如果指定文字 `Internet` 地址，它将使用该地址所暗示的任何协议。如果您提供主机名，它将看到该主机名存在哪种地址;如果有可用的 `IPv6` 地址，它将使用 `IPv6` ，如果没有，它将回退到 `IPv4` 。）

如果您需要强制 `PuTTY` 使用特定协议，您可以明确将其设置为“IPv4”或“IPv6”。



### 4.14.5 “远程主机的注册名字”

这允许您告诉 `PuTTY` ，它最终真正连接到的主机与它认为建立网络连接的位置不同。

例如，如果您在一个 `PuTTY` 会话中设置了一个 `SSH` 端口转发，以便将到某个任意端口（例如 `localhost` 端口 `10022` ）的连接转发到第二台计算机的 `SSH` 端口（例如 `foovax` 端口 `22` ），然后启动连接到转发端口的第二个 `PuTTY` ，则可以使用它。



在正常使用中，第二个 `PuTTY` 将访问其实际连接到的主机名和端口下的主机密钥缓存（即 `localhost` 此示例中的端口 `10022`）。

但是，使用注册主机名选项，您可以将第二个 `PuTTY` 配置为将主机密钥缓存在*已知*它*最终*会与之通信的主机名称下（这里指 `foovax` ）。



如果您希望通过许多不同的通道连接到同一实际服务器（可能是因为您的端口转发安排不断变化），这会很有用：通过一致地设置注册主机名，您可以安排 `PuTTY` 不会一直要求您重新确认其主机密钥。

相反，如果您希望使用相同的本地端口号将端口号转发到许多不同的服务器，则您可能不希望在该本地端口号下缓存任何特定服务器的主机密钥。

（对于后一种情况，您可以在相关会话中显式配置主机密钥;请参阅[第 4.19.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-kex-manual-hostkeys)。）



如果您只为此选项输入主机名，`PuTTY` 会将 `SSH` 主机密钥缓存在该主机的默认 `SSH` 端口下，而不管您实际连接到哪个端口（因为典型场景类似于上面的例子：您连接到一个愚蠢的真实端口号，您的连接最终转发到其他机器的正常端口 `22` `SSH` 服务器）。

要覆盖此设置，可以将端口号附加到注册主机名，用冒号分隔。

例如，输入 `foovax:2200` 作为注册主机名将导致缓存主机密钥，就像您连接到 `foovax` 的端口 2200 一样。



如果使用此选项提供主机名，则该主机名也会显示在包含远程主机名的其他位置，例如默认窗口标题和默认 `SSH` 密码提示。

这反映了这样一个事实，即这是您*真正*连接到的主机，这比您碰巧用来联系该主机的单纯手段更重要。

（即使您使用的是 `SSH` 以外的协议，这也适用。）



## 4.15 “数据”面板

数据面板允许您配置各种数据片段，这些数据可以发送到服务器以影响远端的连接。

此面板上的每个选项都适用于多个协议，仅适用于一个协议的选项将显示在该协议的配置面板上。

图d11



### 4.15.1 “自动登录用户名”

所有三种 `SSH` 、`Telnet` 和 `Rlogin` 协议都允许您指定要登录的用户名，而不必每次都显式键入它。

（某些 `Telnet` 服务器不支持此功能。）

在此框中，您可以键入该用户名。



### 4.15.2 系统用户名的使用

当上一个框（[第 4.15.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-username)）留空时，默认情况下，`PuTTY` 将在您建立连接时提示输入用户名。

在某些环境中，例如实现单点登录的大型组织的网络，更明智的默认值可能是使用登录到本地操作系统的用户的名称（如果有）;这对于 `GSSAPI` 密钥交换和用户身份验证尤其有用（请参阅[第 4.23 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-auth-gssapi)和第 [4.18.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-gssapi-kex)）。

此控件允许您更改默认行为。



为方便起见，对话框中将显示当前系统用户名。

它不会保存在配置中;如果保存的会话稍后被其他用户使用，则将使用该用户名。



### 4.15.3 “终端类型字符串”

您可能使用 `PuTTY` 连接到的大多数服务器都设计为从许多不同类型的终端连接到。

为了向每个人发送正确的控制序列，服务器需要知道它正在处理的终端类型。

因此，每个 `SSH` 、`Telnet` 和 `Rlogin` 协议都允许通过描述终端的连接发送文本字符串。

在 `Unix` 服务器上，这会从 `termcap` 或 `terminfo` 数据库中选择一个条目，该条目告诉应用程序要发送到终端的哪些控制序列，以及期望键盘生成的字符序列。



`PuTTY` 尝试模拟 `Unix` 程序 `xterm` ，默认情况下，它通过作为终端类型字符串发送 `xterm` 来反映这一点。

如果您发现这没有达到您想要的效果 - 也许远程系统报告“未知终端类型” - 您可以尝试将其设置为其他内容，例如 `vt220` 。



如果您不确定问题是否由终端类型设置引起，则可能需要查阅应用程序或服务器的手册。



### 4.15.4 “终端速度”

`Telnet` 、`Rlogin` 和 `SSH` 协议允许客户端指定服务器的终端速度。



此参数*不会影响*连接的实际速度，始终是“尽可能快”;它只是一个提示，有时被服务器软件用来修改其行为。

例如，如果指示速度较慢，服务器可能会切换到带宽消耗较少的显示模式。



该值在网络环境中通常毫无意义，但 `PuTTY` 允许您对其进行配置，以防您发现服务器对默认值反应不佳。



格式是一对用逗号分隔的数字，例如 `38400,38400` 。

第一个数字表示（来自服务器）的输出速度（*以*位/秒为单位），第二个数字是输入速度（*到*服务器）。

（Rlogin 协议中仅使用第一个。）



此选项对原始连接没有影响。



### 4.15.5 在服务器上设置环境变量

`Telnet` 协议为客户端提供了一种将环境变量传递给服务器的方法。

由于安全漏洞，许多 `Telnet` 服务器已停止支持此功能，但 `PuTTY` 仍然支持此功能，以使任何服务器受益，这些服务器已经找到了解决安全问题的其他方法，而不仅仅是禁用整个机制。



`SSH` 协议的版本 `2` 也提供了类似的机制，该机制更容易实现，没有安全漏洞。

较新的 `SSH-2` 服务器比较旧的服务器更有可能支持它。



此配置数据不用于 `SSH-1` 、`rlogin` 或原始协议。



要将环境变量添加到通过连接传输的列表中，请在“变量”框中输入变量名称，在“值”框中输入其值，然后按“添加”按钮。

要从列表中删除一个，请在列表框中选择它，然后按“删除”。



## 4.16 代理面板

代理面板允许您将 `PuTTY` 配置为使用各种类型的代理以建立网络连接。

此面板中的设置会影响形成 `PuTTY` 会话的主网络连接，以及由于 `SSH` 端口转发而建立的任何额外连接（请参阅[第 3.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-port-forwarding)）。

图d12



请注意，与某些软件（例如 `Web` 浏览器）不同，`PuTTY` 不会尝试自动确定是否使用代理以及（如果是）将哪个代理用于给定目标。

如果需要使用代理，则必须始终显式配置代理。



### 4.16.1 设置代理类型

“代理类型”下拉菜单允许您配置希望 `PuTTY` 用于其网络连接的代理类型。

默认设置为“无”;在此模式下，任何连接都不使用代理。

- 选择“HTTP CONNECT”允许您通过支持 `HTTP` 的 `CONNECT` 命令的 `Web` 服务器代理连接，如 [RFC 2817](https://www.rfc-editor.org/rfc/rfc2817) 中所述。

- 选择“SOCKS 4”或“SOCKS 5”允许您通过 `SOCKS` 服务器代理您的连接。

- 许多防火墙实现不太正式的代理类型，用户可以在其中直接与防火墙计算机建立 `Telnet` 或 `TCP` 连接，并输入命令 `connect myhost.com 22`（例如连接到外部主机）。

  选择“Telnet”允许您告诉 `PuTTY` 使用这种类型的代理，并按照[第 4.16.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-proxy-command)中所述指定的精确命令。

- 有几种方法可以使用 `SSH` 服务器作为代理。

  所有这些都会导致 `PuTTY` 与代理主机（在此上下文中有时称为“跳转主机”）建立辅助 `SSH` 连接。

  “代理主机名”字段将被解释为 `PuTTY` 保存的会话的名称（如果存在）或主机名（如果不存在）。

  如果引用的已保存会话本身配置为使用 `SSH` 代理，则允许多跳跃跳转路径;它允许结合 `SSH` 和非 `SSH` 代理。

  - “SSH 到代理并使用端口转发”会导致 `PuTTY` 使用辅助 `SSH` 连接打开到最终目标主机的端口转发通道（类似于 `OpenSSH` 的 `-J` 选项）。

  - “SSH 到代理并执行命令”会导致 `PuTTY` 在代理 `SSH` 服务器上运行任意远程命令，并使用该命令的标准输入和输出流运行主连接。

    远程命令行按[第 4.16.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-proxy-command)中所述指定。

  - “SSH到代理并调用子系统”类似，但会导致 `PuTTY` 启动 `SSH` “子系统”而不是普通命令行。

    这对于专门设置的 `SSH` 代理服务器可能很有用。

- 选择“本地”允许您在本地计算机上指定任意命令以充当代理。

  启动会话时，`PuTTY` 不会创建 `TCP` 连接，而是运行命令（在第 [4.16.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-proxy-command)中指定），并使用其标准输入和输出流。

  例如，这可用于与 `PuTTY` 本身不支持的某种网络代理通信;或者你可以完全通过 `TCP/IP` 以外的其他东西隧道连接。
  
  
  
  您也可以在命令行上启用此模式;请参见[第 3.11.3.27 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-cmdline-proxycmd)。
  
  

### 4.16.2 从代理中排除部分网络

通常，您只需要使用代理连接到网络的非本地部分;例如，公司内部网络外部的连接可能需要代理。

在“排除在外的地址”框中，您可以输入 `IP` 地址范围或 `DNS` 名称范围，`PuTTY` 将避免使用代理并改为建立直接连接。

“排除在外的地址”框可能包含多个排除范围，以逗号分隔。

每个范围可以是 `IP` 地址或 `DNS` 名称，并带有允许通配符的字符。例如：`*`

```
*.example.com
```

这从代理中排除了名称以 `.example.com` 结尾的任何主机。



```
192.168.88.*
```

这将从代理中排除 IP 地址以 `192.168.88` 开头的任何主机。



```
192.168.88.*,*.example.com
```

这同时排除了上述两个范围。



与本地主机的连接（主机名 `localhost` 和任何环回 `IP` 地址）永远不会代理，即使代理排除列表未显式包含它们也是如此。

此行为不太可能引起问题，但如果确实如此，您可以通过启用“考虑代理本地主机连接”来更改它。



请注意，如果您在代理上执行 `DNS`（请参阅[第 4.16.3 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-proxy-dns)），则应确保代理排除设置不依赖于知道主机的 `IP` 地址。

如果在 `PuTTY` 未查找的情况下将名称传递给代理，它将永远不会知道 `IP` 地址，也无法根据您的列表进行检查。



### 4.16.3 使用代理端进行 `DNS` 域名解析

如果使用代理访问专用网络，则 `DNS` 名称解析是由 `PuTTY` 本身（在客户端计算机上）执行还是由代理执行，可能会有所不同。

“在代理端进行 `DNS` 域名解析”配置选项允许您控制这一点。

如果将其设置为“否”，`PuTTY` 将始终执行自己的 `DNS` ，并始终将 `IP` 地址传递给代理。

如果将其设置为“是”，`PuTTY` 将始终将主机名直接传递给代理，而无需先尝试查找它们。



如果将此选项设置为“自动”（默认值），`PuTTY` 将执行它认为适合每种代理类型的操作。

大多数类型的代理（ `HTTP` ，`SOCK5` ，`SSH` ，`Telnet` 和本地）将直接传递主机名; `SOCK4` 代理不会。



请注意，如果您在代理上执行 `DNS` ，则应确保代理排除设置（请参阅[第 4.16.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-proxy-exclude)）不依赖于知道主机的 `IP` 地址。

如果在 `PuTTY` 未查找的情况下将名称传递给代理，它将永远不会知道 `IP` 地址，也无法根据您的列表进行检查。



原始的 `SOCKS4` 协议不支持代理端 `DNS` 。

有一个协议扩展（ `SOCKS 4A` ）支持它，但并非所有 `SOCKS4` 服务器都提供此扩展。

如果您启用代理 `DNS` 并且您的 `SOCKS4` 服务器无法处理它，这可能是原因。



如果要避免 `PuTTY` 进行与目标主机名相关的*任何*  `DNS` 查询（例如，因为本地 `DNS` 解析器在这种情况下返回否定响应的速度非常慢），则除了将此控件设置为“是”之外，您可能还需要在 `SSH` 中关闭 `GSSAPI` 身份验证和 `GSSAPI` 密钥交换（请参阅[第 4.23 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-auth-gssapi)和第 [4.18.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-gssapi-kex) 分别）。

这是因为 `GSSAPI` 设置还涉及对目标主机名的 `DNS` 查询，并且该查询由单独的 `GSSAPI` 库执行，因此 `PuTTY` 无法覆盖或重新配置它。



### 4.16.4 用户名和密码

您可以在“用户名”和“密码”框中输入用户名和密码，如果您的代理需要身份验证，将使用用户名和密码。

请注意，如果您保存会话，代理密码将以纯文本形式保存，因此可以访问您的 `PuTTY` 配置数据的任何人都可以发现它。

如果 `PuTTY` 发现它需要代理用户名或密码，而您在此处未指定，`PuTTY` 将在终端窗口中以交互方式提示输入。



并非所有形式的代理都完全支持身份验证：

- `HTTP` 代理和 `SOCKS 5` 代理支持用户名和密码身份验证。
  
  - 对于 `SOCKS 5` ，如果代理支持身份验证，则通过 `CHAP` 进行身份验证（ `PuTTYtel` 不支持此功能）;否则，密码将以纯文本形式发送到代理。
  - 使用 `HTTP` 代理，如果可能的话，通过“HTTP Digest”（同样，`PuTTYtel` 不支持）或“HTTP Basic”进行身份验证。在后一种情况下，密码以纯文本形式发送到代理。
  
- `SOCKS 4` 可以使用“用户名”字段，但不支持密码。

- `SSH` 代理可以使用 `PuTTY` 支持的所有相同形式的 `SSH` 身份验证作为其主连接。

  如果 `SSH` 服务器请求密码身份验证，将使用任何配置的代理密码，但将首先尝试其他身份验证方法，例如公钥和 `GSSAPI` ，就像主 `SSH` 连接一样，如果它们需要密钥密码等凭据，`PuTTY` 将以交互方式提示这些凭据。

- 您可以指定在 `Telnet/Local` 代理命令中包含用户名和密码的方法（请参阅[第 4.16.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-proxy-command)）。

  如果这样做，并且未在配置中指定实际的用户名和/或密码，`PuTTY` 将以交互方式提示输入它们。



### 4.16.5 指定 `Telnet` 、`SSH` 或本地代理命令

如果使用 `Telnet` 代理类型，则防火墙的 `Telnet` 服务端所需的常用命令是 `connect` ，后跟主机名和端口号。

如果您的代理需要其他命令，您可以在“`Telnet` 命令，或者本地代理命令”框中输入替代命令。



如果使用本地代理类型，则在此处指定要运行的本地命令。

如果使用“`SSH` 代理并执行命令”类型，则在此处指定要在 `SSH` 代理服务器上运行的命令。

同样，如果使用“`SSH` 来代理和调用子系统”，则子系统名称将按此处指定的方式构造。



在此字符串中，可以使用 `\n` 表示换行符、`\r` 表示回车符、`\t` 表示制表符，`\x` 后跟两个十六进制数字来表示任何其他字符。 

`\\` 用于对字符 `\` 本身进行编码。



此外，特殊字符串 `%host` 和 `%port` 将替换为要连接到的主机名和端口号。

对于 `Telnet` 和本地代理类型，字符串 `%user` 和 `%pass将被代理用户名和密码替换（如果未在配置中指定，将提示输入）– SSH 代理类型不会发生这种情况（因为代理用户名/密码用于 `SSH` 身份验证）。` 

字符串 `%proxyhost` 和 %proxyport` ，将替换为“代理”面板上指定的主机详细信息（如果有）（这对于使用本地或远程命令的*代理*类型最有可能有用）。` 

要获取文字符号 `%` ，请输入 `%%` 。



如果 `Telnet` 代理服务器在发送命令之前提示输入用户名和密码，则可以使用如下命令：

```
%user\n%pass\nconnect %host %port\n
```



这会将您的用户名和密码作为前两行发送到代理，然后是连接到所需主机和端口的命令。

请注意，如果在 `Telnet` 命令中不包含 `%user` 或 `%pass` 令牌，则“用户名”和“密码”配置字段中指定的任何内容都将被忽略。



### 4.16.6 控制代理日志记录

通常，代理交互有自己的诊断输出;本地代理命令尤其如此。

“在终端窗口输出代理诊断信息”设置可让您控制将代理诊断信息的数量以及主会话的输出打印到主终端窗口。

默认情况下（“否”），代理诊断仅发送到事件日志;使用“是”，它们也会打印到终端，在那里它们可能会与您的主会话混淆。

“只在会话开始时”是一种折中妥协;代理消息将转到终端窗口，直到主会话被视为已启动（以依赖于协议的方式），这是它们最有可能感兴趣的时间;会话期间任何与代理相关的进一步消息将仅转到事件日志。



## 4.17 `SSH` 面板

`SSH` 面板允许您配置仅适用于 `SSH` 会话的选项。

图d13



### 4.17.1 在服务器上执行特定命令

在 `SSH` 中，您不必在服务器上运行常规的 `shell` 会话。

相反，您可以选择运行单个特定命令（例如邮件用户代理）。

如果要执行此操作，请在“远程命令”框中输入命令。



请注意，大多数服务器将在执行命令后关闭会话。



### 4.17.2 “完全不启动 `shell` 或命令”

如果勾选此框，`PuTTY` 在连接到远程服务器后将不会尝试运行 `shell` 或命令。

如果仅使用 `SSH` 连接进行端口转发，并且服务器上的用户帐户无法运行 `shell` ，则可能需要使用此选项。



此功能仅在 `SSH` 协议版本 `2` 中可用（因为版本 `1` 协议假定您始终希望运行 `shell` ）。



也可以使用命令行选项 `-N` 启用此功能;请参见[第 3.11.3.13 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-cmdline-noshell)。



如果您在 `Plink` 中使用此功能，您将无法通过任何正常方式终止 `Plink` 进程;杀死它的唯一方法是按 `Control-C` 或从另一个程序发送终止信号。



### 4.17.3 “启用压缩”

这在 `SSH` 连接中启用数据压缩：服务器发送的数据在发送前被压缩，并在客户端解压缩。

同样，`PuTTY` 发送到服务器的数据首先被压缩，服务器在另一端解压缩它。

这有助于充分利用低带宽连接。



### 4.17.4 “`SSH` 协议版本”

这允许您选择是使用 `SSH` 协议版本 `2` 还是旧版本 `1` 。



通常应将其保留为默认值“ `2` ”。

除了功能较少外，较旧的 `SSH-1` 协议不再开发，具有许多已知的加密弱点，并且通常被认为是不安全的。

`PuTTY` 的协议 `1` 实现主要是为了兼容性，不再增强。



如果服务器同时提供两个版本，则首选“ `2` ”。

如果您有一些服务器或设备只能连接 `SSH-1` ，请在此处选择“ `1` ”，并且不要将生成的连接视为安全连接。



如果服务器与您在此处的选择不匹配，`PuTTY` 不会自动回退到协议的其他版本;相反，它会显示一条错误消息并中止连接。

这可以防止主动攻击者将预期的 `SSH-2` 连接降级为 `SSH-1` 。



### 4.17.5 在 `PuTTY` 工具之间共享 `SSH` 连接

此框中的控件允许您将 `PuTTY` 配置为在可能的情况下重用现有的 `SSH` 连接。

`SSH-2` 协议允许您通过同一 `SSH` 连接运行多个数据通道，因此您只需登录一次（并且只需进行一次昂贵的加密设置），然后打开多个终端窗口。

`PuTTY` 的每个实例仍只能在一个终端会话上运行，但使用此框中的控件，您可以将 `PuTTY` 配置为检查其自身的另一个实例是否已连接到目标主机，如果是，请共享该实例的 `SSH` 连接，而不是启动单独的新连接。



要启用此功能，只需勾选“共享可用的 `SSH` 连接”框。然后，每当您启动连接到特定主机的 `PuTTY` 会话时，它都会尝试重用现有的 `SSH` 连接（如果有）。

例如，从系统菜单中选择“重复会话”将在同一主机上启动另一个会话，如果启用了共享，则它将重用现有的 `SSH` 连接。



使用此模式时，连接到给定服务器的第一个 `PuTTY` 将成为“上游”，这意味着它是管理真正 `SSH` 连接的 `PuTTY` 。

所有重用连接的后续 `PuTTY` 都称为“下游”：它们根本不连接到真实服务器，而是通过本地进程间通信方法连接到上游 `PuTTY` 。

要激活此系统，`PuTTY` 的上游和下游实例*都必须*启用共享选项。

因此，上游的 `PuTTY` 在其所有下游关闭之前不能终止。

这类似于端口转发或 `X11` 转发的效果，其中终端会话已完成的 `PuTTY` 仍将保持打开状态，以便继续为转发的连接提供服务。



如果您需要更详细地配置此系统，还有两个附加复选框，允许您指定特定 `PuTTY` 是否可以充当上游或下游或两者兼而有之。

（仅当同时勾选主“共享可用的 `SSH` 连接”框时，这些框才会生效。）

默认情况下，这两个框都处于选中状态，因此从同一配置启动的多个 `PuTTY` 会将其中一个指定为上游并共享单个连接;但是，如果由于某种原因您需要特定的 `PuTTY` 配置不是上游（例如，因为您肯定需要它立即关闭）或*不是*下游（例如，因为它需要使用特殊的私钥进行自己的身份验证），那么您可以取消选中这些框中的一个或另一个。



在上面的讨论中，我提到了“ `PuTTY` ”，但所有其他建立 `SSH` 连接的 `PuTTY` 工具也可以使用这种机制。

例如，如果 `PSCP` 或 `PSFTP` 加载启用了共享的配置，则它可以充当下游并使用由 `GUI` `PuTTY` 实例设置的现有 `SSH` 连接。

一个特例是 `PSCP` 和 `PSFTP` *永远不会*充当上游。



可以使用 `Plink` 以编程方式测试是否存在实时上游。请参见[第 7.2.3.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter7.html#plink-option-shareexists)。



## 4.18 密钥面板

密钥面板（“密钥交换”的缩写）允许您配置与 `SSH-2` 密钥交换相关的选项。

图d14



密钥交换发生在 `SSH` 连接开始时（此后偶尔发生）;它建立了一个共享密钥，用作 `SSH` 所有安全功能的基础。

因此，密钥交换的安全对于连接的安全性非常重要。



密钥交换是一个加密密集型过程;如果客户端或服务器是相对较慢的计算机，则较慢的方法可能需要几十秒才能完成。

如果连接启动太慢，或者连接定期挂起，您可能需要尝试更改这些设置。

如果您不明白其中任何含义，可以安全地保留这些设置。



整个面板仅与 `SSH` 协议版本 `2` 相关;这些设置都不会影响 `SSH-1` 。



### 4.18.1 密钥交换算法选择

`PuTTY` 支持多种 `SSH-2` 密钥交换方法，并允许您选择您喜欢使用的一种;配置类似于密码选择（请参阅[第 4.20 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-encryption)）。

`PuTTY` 目前支持以下密钥交换方法：

- “ `NTRU Prime / Curve25519 hybrid` ”：“简化的 `NTRU Prime` ”是一种基于晶格的算法，旨在抵抗量子攻击。

  在这种密钥交换方法中，它与传统的基于 `Curve25519` 的方法（“ `ECDH` ”中包含的方法之一）并行运行，其安全性不*低于*常用方法，并且希望也能抵抗一类新的攻击。

- “ `ECDH` ”：椭圆曲线 `Diffie-Hellman` 密钥交换，具有各种标准曲线和哈希算法。

- `Diffie-Hellman` 密钥交换的原始形式，具有各种众所周知的组和哈希：
  
  - “ `Group 18` ”，一个著名的 `8192` 位组，与 `SHA-512` 哈希函数一起使用。
  
  - “ `Group 17` ”，一个著名的 `6144` 位组，与 `SHA-512` 哈希函数一起使用。
  
  - “ `Group 16` ”，一个著名的 `4096` 位组，与 `SHA-512` 哈希函数一起使用。
  
  - “ `Group 15` ”，一个著名的 `3072` 位组，与 `SHA-512` 哈希函数一起使用。
  
  - “ `Group 14` ”：一个众所周知的 `2048` 位组，与 `SHA-256` 哈希函数一起使用，或者，如果服务器不支持，则与 SHA-1 一起使用。
  
  - “ `Group 1` ”：一个众所周知的 `1024` 位组，与 `SHA-1` 哈希函数一起使用。
  
    我们和当前的 `SSH` 标准都不建议再使用此方法，并且在新安装中默认不使用此方法;但是，它可能是非常旧的服务器软件支持的唯一方法。
  
- “ `Diffie-Hellman` 组交换”：使用此方法，`PuTTY` 请求服务器建议一个组用于后续的 `Diffie-Hellman` 密钥交换，而不是使用固定组;服务器可以避免已知较弱的组，并可能随着时间的推移发明新的组，而无需对 `PuTTY` 的配置进行任何更改。

  此密钥交换方法使用 `SHA-256` 哈希，或者，如果服务器不支持，则使用 `SHA-1` 。

- “基于 `RSA` 的密钥交换”：与 `Diffie-Hellman` 密钥交换相比，这需要客户端的计算工作量少得多，服务器方面的计算工作量要少得多。

- “ `GSSAPI` 密钥交换”：请参阅[第 4.18.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-gssapi-kex)。

如果 `PuTTY` 找到的第一个算法位于“下面为警告选项”行下方，则在建立连接时将看到一个警告框，类似于密码选择的警告框（请参阅[第 4.20 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-encryption)）。



#### 4.18.1.1 尝试 `GSSAPI` 的密钥交换

`PuTTY` 支持一组密钥交换方法，这些方法还包含基于`GSAPI` 的身份验证。

它们通过“尝试 `GSSAPI` 密钥交换”复选框（也显示在“ `GSSAPI` ”面板上）启用。



`PuTTY` 只能在使用 `Kerberos V5` 时执行经过 `GSSAPI` 身份验证的密钥交换方法，而不能执行其他 `GSSAPI` 机制。

如果运行 `PuTTY` 的用户具有当前的 `Kerberos V5` 凭据，则 `PuTTY` 将优先选择 `GSSAPI` 密钥交换方法，而不是首选项列表中配置的任何普通 `SSH` 密钥交换方法。

有一个基于 `GSSAPI` 的方法，相当于[第 4.18.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-kex-order)中列出的大多数普通方法;服务器支持确定将使用哪一个。

（`PuTTY` 对 `GSAPI` 身份验证的密钥交换方法的偏好顺序是固定的，不受偏好列表的控制。）



当您使用凭据委派时，将 `GSSAPI` 身份验证作为 `SSH` 密钥交换的一部分进行的优势是显而易见的（请参阅[第 4.23.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-auth-gssapi-delegation)）。

`SSH` 密钥交换可以在会话的后面重复，这允许您的 `Kerberos V5` 凭据（通常生存期很短）在客户端上刷新时自动重新委派给服务器。（此功能通常称为“级联凭据”。）



如果您的服务器不支持 `GSSAPI` 密钥交换，它可能仍支持 `GSSAPI` 在 `SSH` 用户身份验证阶段。

这仍允许您使用 `Kerberos` 凭据登录，但仅允许您委派在会话开始时处于活动状态的凭据;以后无法在长时间运行的会话中自动刷新它们。

请参阅[第 4.23 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-auth-gssapi)，了解如何在 `PuTTY` 中控制 `GSSAPI` 用户身份验证。



`GSSAPI` 密钥交换的另一个效果是它取代了第 [2.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter2.html#gs-hostkey)中描述的永久主机密钥的通常 `SSH` 机制。

因此，如果使用此方法，则不会询问有关是否接受服务器的主机密钥的任何交互式问题。

相反，`Kerberos` 交换将验证您连接到的主机的身份，同时验证您的身份。



### 4.18.2 重复密钥交换

如果在连接启动时协商的会话密钥使用过多或时间过长，则可能对 `SSH` 连接发起攻击。

因此，`SSH-2` 协议指定应每隔一段时间进行一次新的密钥交换;这可以由客户端或服务器启动。



在进行此重新协商时，任何数据都无法通过 `SSH` 连接，因此它可能显示为“冻结”。

（重复密钥交换的发生记录在事件日志中;请参见[第 3.1.3.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-eventlog)。）

通常使用与连接开始时相同的算法，但开销相似。



这些选项控制 `PuTTY` 启动重复密钥交换（“重新生成密钥”）的频率。

您也可以随时从“特殊命令”菜单强制交换密钥（请参阅[第 3.1.3.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-specials)）。

- “重新交换最长时间(分钟，`0` 不限制)”指定在启动重新生成密钥之前允许经过的时间量。

  如果将其设置为零，`PuTTY` 将不会由于经过的时间而重新生成密钥。

  `SSH-2` 协议规范建议超时最多为 `60` 分钟。



您可能需要完全禁用基于时间的重新更新的密钥，原因与保持连接并不总是有帮助相同。

如果您预计在 `SSH` 连接过程中会遭受几个小时的网络丢失，但实际上并不打算在这些小时内通过该连接发送*数据*，那么在丢失过程中尝试重新生成密钥可能会导致连接被放弃，而如果禁用重新密钥，那么连接原则上应该仍然存在（在没有干扰防火墙的情况下）。

有关这些问题的更多讨论，请参见[第 4.14.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-keepalive);出于这些目的，重新密钥具有与保持连接大致相同的属性。

（除了重新密钥本身具有加密价值，因此在决定是否关闭它们时应牢记这一点。）

但请注意，SSH *服务器*仍然可以启动重新生成密钥。

- 如果您使用的是 `GSSAPI` 密钥交换，则“ `GSSAPI` 检查间隔(单位：分钟)”会指定检查 `GSSAPI` 凭据缓存的频率，以查看是否有新票证可供委派，或者当前工单是否即将过期。

  如果启用了 `GSSAPI` 凭据的转发，`PuTTY` 将根据需要尝试重新生成密钥，以防止委派凭据过期。

  建议经常检查;仅在需要时才会重新生成密钥。

- “重新交换最大数据量”指定在启动重新生成密钥之前允许向任一方向流动的数据量（以字节为单位）。

  如果将其设置为零，`PuTTY` 将不会由于传输的数据而重新生成密钥。

  `SSH-2` 协议规范建议限制为最多 1 GB。
  
  
  
  除了以字节为单位指定值外，还可以使用以下简写：
  
  - `1k` 指 `1 字节（1024 KB）` 。
  - `1M` 指 `1 兆字节（1024 KB）` 。
  - `1G` 指 `1 千兆字节（1024 MKB）` 。



完全禁用基于数据的重新密钥是一个坏主意。

`SSH-2` 协议的完整性和较小程度的机密性部分取决于在 `32` 位数据包序列号环绕之前发生的重新密钥。

与基于时间的重新生成密钥不同，当 `SSH` 连接空闲时，不会发生基于数据的重新生成密钥，因此它们不应导致相同的问题。

顺便说一下，`SSH-1` 协议的完整性保护甚至比没有重新密钥的 `SSH-2` 更弱。



## 4.19 主机密钥面板

“主机密钥”面板允许您配置与主机密钥管理相关的选项。

图d15



主机密钥用于证明服务器的身份，并向您保证服务器没有被欺骗（通过中间人攻击或在网络上完全替换它）。

有关主机密钥的基本介绍，请参见[第 2.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter2.html#gs-hostkey)。

此面板的大部分内容仅与 `SSH` 协议版本 `2` 相关; `SSH-1` 仅支持一种类型的主机密钥。



### 4.19.1 主机密钥类型选择

`PuTTY` 支持多种 `SSH-2` 主机密钥类型，并允许您选择用于标识服务器的密钥类型。

配置类似于密码选择（请参阅[第 4.20 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-encryption)）。



`PuTTY` 目前支持以下主机密钥类型：

- `Ed25519` ：使用带模量 `2^255-19` 的扭曲爱德华兹曲线的爱德华兹曲线 `DSA` 。
- `Ed448` ：另一种爱德华兹曲线 `DSA` 类型，使用更大的椭圆曲线，具有 `448` 位而不是 `255` 位模数（因此它具有比 `Ed25519` 更高的安全级别）。
- `ECDSA` ：使用 `NIST` 标准化椭圆曲线之一的椭圆曲线 `DSA` 。
- `DSA` ：使用模幂的简单 `DSA` 。
- `RSA ：普通的 `RSA` 算法。



如果 `PuTTY` 已经为服务器存储了一个或多个主机密钥，则默认情况下，它将首选使用其中一个，即使服务器的密钥类型在首选项顺序中更高。

您可以使用“特殊命令”菜单从现有会话中将此类密钥添加到 `PuTTY` 的缓存中;请参见[第 3.1.3.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-specials)。

否则，`PuTTY` 将完全根据您在配置中指定的首选项顺序选择密钥类型。



如果 `PuTTY` 找到的第一个密钥类型位于“下面为警告选项”行下方，则在建立连接时将看到一个警告框，类似于密码选择的警告框（请参阅[第 4.20 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-encryption)）。



### 4.19.2 已知主机密钥的首选算法

默认情况下，`PuTTY` 将调整 `SSH-2` 主机密钥算法的首选项顺序，以便将它已经知道的任何主机密钥移动到列表顶部。

这样，您就不必检查并确认已有主机密钥的服务器的新主机密钥（例如，因为服务器生成了 `PuTTY` 首选项顺序中更高类型的备用密钥，或者因为您更改了首选项顺序本身）。

但是，另一方面，它可能会向网络中的侦听器泄露*有关您是否已经*知道此服务器的主机密钥的信息。

因此，此策略是可配置的。

通过关闭此复选框，您可以将 `PuTTY` 重置为始终使用[第 4.19.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-hostkey-order)中所述的首选项列表中配置的主机密钥算法的确切顺序，以便侦听器不会发现您存储了哪些密钥。



### 4.19.3 手动配置连接的主机密钥

在某些情况下，如果 `PuTTY` 的自动主机密钥管理未满足您的需求，您可能需要手动配置 `PuTTY` 以接受特定主机密钥或一组特定主机密钥之一。



您可能想要执行此操作的一个原因是，`PuTTY` 连接到的主机名使用轮询 `DNS` 返回多个实际服务器之一，并且它们都具有不同的主机密钥。

在这种情况下，您可能需要将 `PuTTY` 配置为接受可能服务器的主机密钥列表中的任何密钥，同时仍拒绝该列表中未包含的任何密钥。



另一个原因是如果 `PuTTY` 的自动主机密钥管理完全不可用，例如因为 `PuTTY` （或 `Plink` 或 `PSFTP` 等）在`Windows` 环境中运行，无法访问注册表。

在这种情况下，您可能希望使用命令行选项 `-hostkey` 来配置预期的主机密钥;请参见[第 3.11.3.22 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-cmdline-hostkey)。



对于 `PuTTY` 的自动主机密钥管理只是选择错误的主机名来存储密钥的情况，您可能需要考虑设置“注册主机名”;请参见[第 4.14.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-loghost)。



要通过 `GUI` 配置手动主机密钥，请在“手动配置本连接的主机密钥”的编辑框中输入一些描述主机密钥的文本，然后按“添加”按钮。

该文本将显示在“可接受的主机密钥或指纹”列表框中。

您可以使用“删除”按钮再次删除密钥。



描述主机密钥的文本可以采用以下格式之一：

- 基于 `SHA-256` 的 `PuTTY` 事件日志和主机密钥对话框中显示的表单的主机密钥指纹，比如 `SHA256:` 后跟 `43` 个区分大小写的字符。

- 基于 `MD5` 的主机密钥指纹，比如 16个 `2` 位由冒号分隔的十六进制数字，可选前缀 `MD5:`。（字符的大小写无关紧要。

- 一个 `base64` 编码的 `blob` ，以 `OpenSSH` 的单行公钥格式描述 `SSH-2` 公钥。

  获取此格式的公钥的方式取决于服务器;在 `OpenSSH` 服务器上，它通常可以在类似 `/etc/ssh/ssh_host_rsa_key.pub` 的位置找到。



如果 `PuTTY` 建立 `SSH` 连接时此框至少包含一个主机密钥或指纹，则完全绕过 `PuTTY` 的自动主机密钥管理：当且仅当服务器提供的主机密钥是此框中列出的密钥之一时，才允许连接，并且注册表中的主机密钥存储既不读取*也不写入*， 除非您明确这样做。



如果该框为空（通常为空），则 `PuTTY` 的自动主机密钥管理将正常工作。



### 4.19.4 配置 `PuTTY` 以接受主机证书

在某些环境中，许多服务器的 `SSH` 主机密钥都将由中央“证书颁发机构”（简称“CA”）轮流签名。

这简化了用户的主机密钥配置，因为如果他们将其 `SSH` 客户端配置为接受由该 `CA` 认证的主机密钥，则他们无需在首次连接到该服务器时单独确认每个主机密钥。



为此，请按“主机密钥”配置面板中的“配置主机 `CAs` ”按钮。

这将启动一个辅助配置对话框，您可以在其中配置 `PuTTY` 将接受哪些 `CA` 的签名。

图d16



**请注意，此配置对于所有已保存的会话都是通用的**。

主 `PuTTY` 配置中的所有内容都特定于一个保存的会话，您可以准备一个单独的会话，所有配置都不同。

但是主机 `CA` 配置只有一个副本，它适用于 `PuTTY` 运行的所有会话，无论是否保存。

（否则，这将毫无用处 - 为每个新主机手动配置 `CA` 并不比为每个新主机的主机密钥按“确认”按钮更方便。）



要使用此配置框设置新的 `CA` ，请执行以下操作：

首先，从文件加载 `CA` 的公钥，或将其直接粘贴到“证书颁发机构的公钥”编辑框中。

如果您的组织以这种方式签署其主机密钥，他们将发布其 `CA` 的公钥，以便 `SSH` 用户可以将其包含在他们的配置中。



接下来，在“信任此密钥进行认证的有效主机”框中，配置至少一个主机名通配符，以说明 `PuTTY` 应信任此 `CA` 的服务器。

例如，假设您为示例甲公司 （ `example.com` ） 工作，并且甲公司 `IT` 部门已公布一个对所有示例内部计算机的主机密钥进行签名的 `CA`。

然后，您可能希望信任该 `CA` 为域 `example.com` 中的计算机签署主机密钥，而不是其他任何东西。

因此，您可以在“有效主机”框中输入 `*.example.com` 。



**限制允许 `CA` 密钥签名的内容非常重要**。

不要只在那个框中输入 `*`  ！

如果您这样做，您是在说示例公司的 `IT` 部门有权为您可能决定连接*的任何内容*签署主机密钥 - 即使您从公司网络连接到其他地方的计算机，例如您自己的个人服务器。

因此，该配置将使示例 `IT` 部门能够充当 `PuTTY` 进程和服务器之间的“中间人”，并监听您的通信 - 这正是 `SSH` 应该避免的事情。

因此，如果 `CA` 是由负责 `example.com`（或其他任何操作）的系统管理员提供给您的，请确保 `PuTTY` *仅*信任域 `example.com` 中的计算机。

有关“有效主机”表达式的完整语法，请参见[第 4.19.4.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-cert-valid-expr)。



最后，为此 `CA` 选择一个标识名称;在窗口顶部的“此 `CA` 的名称”编辑框中输入该名称，然后按“保存”以在配置中记录 CA。

您选择的名称将显示在“保存”按钮左侧的已保存 `CA` 列表中。



标识名称可以是你喜欢的任何名称。

它的存在是为了，如果您存储多个证书，您可以在以后要编辑或删除它们时判断哪个是哪个。

当服务器提供由该 `CA` 签名的证书时，它还会显示在 `PuTTY` 事件日志中。

要重新加载现有 `CA` 配置，请在列表框中选择它，然后按“加载”。

然后，您可以进行更改，然后再次保存。

要从配置中完全删除 `CA`，请在列表中选择它，然后按“删除”。



#### 4.19.4.1 可以在“有效主机”中输入的表达式

您可以在“信任此密钥认证的有效主机”编辑框中输入的最简单的内容只是一个主机名通配符，例如 `*.example.com`。

这将匹配任何子域中的任何主机，因此 `ssh.example.com` 和 `login.dept.example.com` 都匹配，但 `prod.example.net` 不会。



但是，您也可以输入多个主机名通配符和端口号范围，并使用运算符 `&&` 表示“和”，`||` 表示“或”，`!` 表示“not”和括号，从中创建复杂的布尔表达式。

例如，您可以输入以下一些其他内容。

- `*.foo.example.com || *.bar.example.com` 这意味着，如果主机名与 `*.foo.example.com` 匹配*或*与 `*.bar.example.com` 匹配，则 `CA` 将受信任对连接的主机密钥进行签名。

  换句话说，`CA` 对 的两个特定子域 `example.com` 具有权限，但对像 `www.example.com` 的其他任何子域没有权限。

- `*.example.com && ! *.extrasecure.example.com` 这意味着，如果主机名与 `*.example.com` 匹配*但*不匹配 `*.extrasecure.example.com` ，则 `CA` 受信任对连接的主机密钥进行签名。

  （想象一下，如果您的公司中有一组绝密服务器，而主要的 `IT` 部门没有安全许可来管理。

- `*.example.com && port:22` 这意味着，如果主机名与 `*.example.com` 匹配*且*端口号为 `22` ，则 `CA` 可以对连接的主机密钥进行签名。

  在其他端口上运行的 `SSH` 服务器将不包括在内。

- `(*.foo.example.com || *.bar.example.com) && port:0-1023``example.com` 与以前一样，这将匹配 的两个子域*，但也将*端口号限制为 `0-1023` 的范围。



证书配置表达式由一个或多个单独的要求组成，每个要求可以是主机名通配符、单个端口号或端口号范围，并与这些布尔运算符组合在一起。

与 `C` 等其他语言不同，`&&` 和 `||` 之间没有隐含的优先级。

如果你写了 `A && B || C`（其中 `A` ， `B` 和 `C` 是一些特殊的要求），那么 `PuTTY` 将报告语法错误，因为你没有说 `&&` 和 `||` 中的哪一个严格优先。

您必须写 `(A && B) || C` ，意思是 ' `A` 和 `B` ，或者只是 `C`'，或者只是 `A && (B || C)`（' `A`，以及至少 `B` 和 `C` 其中一个'），以使其清楚。



#### 4.19.4.2 证书中的 RSA 签名类型

`RSA` 密钥可用于通过选择安全哈希函数生成签名。

通常，任何足以支持证书的 `OpenSSH` 版本也将足够新，以避免使用 `SHA-1` ，因此接受更现代的`SHA-256` 和 `SHA-512` 的默认设置应该适用于几乎所有情况。

但是，为了完整起见，您可以使用 `RSA` 密钥配置 `PuTTY` 在来自 `CA` 的证书中接受哪些类型的 `RSA` 签名。



## 4.20 加密面板

`PuTTY` 支持各种不同的加密算法，并允许您选择您喜欢使用的算法。

为此，可以在列表框中上下拖动算法（或使用“上移”和“下移”按钮移动算法）来指定首选项顺序。

当您建立 `SSH` 连接时，`PuTTY` 将从顶部向下搜索列表，直到找到服务器支持的算法，然后使用该算法。

图d17



`PuTTY` 目前支持以下算法：

- `ChaCha20-Poly1305` ，密码和 `MAC` 的组合（仅限 `SSH-2` ）
- `AES（Rijndael）` - `256` 、`192` 或 `128` 位 `SDCTR` 或 `CBC` ，或 `256` 或 `128` 位 `GCM`（仅限 `SSH-2` ）
- `Arcfour（RC4）` - `256` 或 `128` 位流密码（仅限 `SSH-2` ）
- `Blowfish` - `256` 位 `SDCTR`（仅限 `SSH-2` ）或 `128` 位 `CBC`
- `Triple-DES` - `168` 位 `SDCTR`（仅限 `SSH-2` ）或 `CBC`
- `Single-DES` - `56` 位 `CBC`（有关 `SSH-2` ，请参见下文）



如果 `PuTTY` 找到的算法位于“下面为警告选项”行下方，则在建立连接时将看到一个警告框：

```
The first cipher supported by the server
is single-DES, which is below the configured
warning threshold.
Do you want to continue with this connection?
```



这会警告您，第一个可用的加密不是非常安全的加密。

通常，您会在认为安全的加密和您认为不合格的加密之间放置“下面为警告选项”行。

默认情况下，`PuTTY` 提供优先顺序，旨在反映安全性和速度方面的合理偏好。



在 `SSH-2` 中，加密算法是针对连接的每个方向独立协商的，尽管 `PuTTY` 不支持单独配置首选项顺序。

因此，您可能会收到两个与上述类似的警告，可能使用不同的加密。



`SSH-2` 协议标准中不建议使用 `Single-DES` ，仅有一两个服务器实现支持它。

如果启用“启用 `SSH-2` 兼容使用单一 `DES` 算法”选项，`PuTTY` 可以使用单 `DES` 与这些服务器进行互操作;默认情况下，此功能处于禁用状态，`PuTTY` 将坚持使用推荐的密码。



## 4.21 认证面板

认证面板允许您配置 `SSH` 会话的身份验证选项。

图d18



### 4.21.1 “显示预身份验证提示”

`SSH-2` 服务器可以提供一条消息，供客户端在用户登录之前显示给潜在用户;这有时称为预身份验证“提示”。

通常，这用于提供有关服务器和法律声明的信息。



默认情况下，`PuTTY` 在提示输入密码或类似凭据之前显示此消息（尽管不幸的是，由于协议设计的性质，在提示输入登录名之前不会显示此消息）。

通过取消选中此选项，可以完全禁止显示提示。



### 4.21.2 “完全绕过认证”

在 `SSH-2` 中，原则上可以在不使用 `SSH` 的机制来识别或证明您是谁的情况下建立连接。

例如，`SSH` 服务器可能更喜欢在数据通道中处理身份验证，或者根本不要求任何用户身份验证。



默认情况下，`PuTTY` 假定服务器需要身份验证（我们从未听说过不需要身份验证），因此必须使用用户名启动此过程。

如果您发现收到无法回答的用户名提示，您可以尝试启用此选项。

但是，大多数 `SSH` 服务器会拒绝这一点。



如果您有用户名并且只想让 `PuTTY` 记住它，这不是您想要的选项;有关此内容，请参见[第 4.15.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-username)。

如果您尝试设置对主流 `SSH` 服务器的无密码登录，也可能不是这样;根据服务器的不同，您可能需要公钥身份验证（第 [8 章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter8.html#pubkey)）或 `GSSAPI` 身份验证（[第 4.23 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-auth-gssapi)）。

（这些仍然是身份验证形式，即使您不必与它们交互。）



此选项仅影响 `SSH-2` 连接。

`SSH-1` 连接始终需要身份验证步骤。



### 4.21.3 “如果身份验证成功，则断开连接”

此选项会导致 `PuTTY` 放弃 `SSH` 会话并与服务器断开连接，前提是服务器接受身份验证而从未要求输入任何类型的密码、签名或令牌。

这可以用作安全措施。

有一些针对 `SSH` 客户端用户的攻击形式，其工作方法是提前终止 `SSH` 身份验证阶段，然后在 `SSH` 会话的主要部分执行某些操作，这*看起来像*身份验证的一部分，但实际上并非如此。



例如，与其要求公钥提供签名（ `PuTTY` 会要求您提供密钥的密码），不如让受感染或恶意的服务器允许您完全不使用签名或密码登录，然后打印一条*模仿*  `PuTTY` 请求您的密码的消息，希望您输入它。（事实上，公钥的密码不应发送到任何服务器。）

`PuTTY` 对此类攻击的主要防御是“信任符号”系统：`PuTTY` 窗口中真正由 `PuTTY` 本身发起的消息显示在 `PuTTY` 图标的小副本旁边，服务器在尝试使用终端输出模仿同一消息时无法伪造。

但是，如果您认为自己无论如何都可能面临此类事情的风险（如果您没有密切关注信任符号，或者如果您认为自己有一台服务器恶意的额外风险），那么您可以启用此选项作为额外的防御。

然后，如果服务器尝试任何这些攻击，涉及让您通过身份验证阶段，`PuTTY` 将在发送后续虚假提示或其他类型的攻击之前断开与服务器的连接。



另一方面，某些服务器*合法地*让您轻松完成 `SSH` 身份验证阶段，因为它们是真正公开的，或者因为重要的身份验证步骤发生在终端会话期间。

（例如，SSH 服务器将您直接连接到旧式大型机的终端登录提示。）

因此，启用此选项可能会导致某些类型的会话停止工作。这取决于你。



### 4.21.4 “尝试使用 `Pageant` 进行身份验证”

如果启用此选项，则 `PuTTY` 将查找 `Pageant`（ `SSH` 私钥存储代理），并尝试使用 `Pageant` 当前持有的任何合适的公钥进行身份验证。

此行为几乎总是可取的，因此默认情况下处于启用状态。在极少数情况下，您可能需要将其关闭，以便通过某些非公钥方法（如密码）强制进行身份验证。

也可以使用 `-noagent` 命令行选项控制此选项。请参见[第 3.11.3.9 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-cmdline-agentauth)。

有关 `Pageant` 的更多信息，请参阅[第 9 章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter9.html#pageant)。



### 4.21.5 “尝试 `TIS` 或 `CyptoCard` 身份验证”

`TIS` 和 `CyptoCard` 身份验证是（尽管如此命名）仅在 `SSH` 协议版本 `1` 中可用的简单质询/响应身份验证的通用形式。

例如，如果您使用的是 `S/Key` 一次性密码，或者如果您有一个生成对身份验证质询的响应的物理安全令牌，则可以使用它们。

它们甚至可用于提示输入简单密码。



启用此开关后，如果服务器愿意尝试这些形式的身份验证，`PuTTY` 将尝试它们。

您将看到一个质询字符串（每次可能不同），并且必须提供正确的响应才能登录。

如果您的服务器支持此功能，您应该与您的系统管理员讨论这些质询和响应的确切形式。



### 4.21.6 “尝试键盘交互式身份验证”

相当于 `TIS` 身份验证的 `SSH-2` 称为“键盘交互”。

它是一种灵活的身份验证方法，使用任意请求和响应序列;因此，它不仅对质询/响应机制（如 `S/Key` ）有用，而且还可用于（例如）在旧密码过期时要求用户输入新密码。



`PuTTY` 默认启用此选项，但提供一个开关来关闭它，以防您遇到问题。



### 4.21.7 “启用代理转发”

此选项允许 `SSH` 服务器打开转发的连接，返回到您的本地 `Pageant` 副本。

如果您没有运行 `Pageant` ，则此选项将不执行任何操作。



有关 `Pageant` 的一般信息，请参阅第 [9 章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter9.html#pageant)，有关代理转发的信息，请参阅[第 9.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter9.html#pageant-forward)。请注意，启用此选项存在安全风险;有关详细信息，请参阅[第 9.6 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter9.html#pageant-security)。



### 4.21.8 “启用尝试在 `SSH-2` 中修改用户名”

在 `SSH-1` 协议中，身份验证失败后无法更改用户名。

因此，如果您在 `PuTTY` “登录为：”提示符下输入了错误的用户名，则除非重新启动 `PuTTY` ，否则您将无法更改它。



`SSH-2` 协议原则上*允许*更改用户名，但并不强制要求 `SSH-2` 服务器接受它们。

特别是，`OpenSSH` 不接受更改用户名;发送一个用户名后，它将拒绝尝试以其他用户身份进行身份验证的尝试。

（根据 `OpenSSH` 的版本，它可能会悄悄返回所有登录尝试的失败，或者可能会发送错误消息。）



因此，默认情况下，如果服务器拒绝，`PuTTY` 不会多次提示您输入用户名。

如果您知道您的服务器可以处理它，您可以启用“启用尝试在 `SSH-2` 中修改用户名”选项来修改 `PuTTY` 的行为。



## 4.22 凭据面板

“认证”面板的此子窗格包含配置选项，这些选项指定要提供给服务器的实际*凭据*：密钥文件和证书。

图d19



### 4.22.1 “用于认证的私钥文件”

如果您使用的是公钥身份验证，则可以在此框中输入私钥文件的名称。

有关 `SSH` 中的公钥身份验证的信息，请参阅[第 8 章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter8.html#pubkey)。



此密钥必须采用 `PuTTY` 的本机格式 （`*.PPK`）。

如果您有要与 `PuTTY` 一起使用的其他格式的私钥，请参阅[第 8.2.15 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter8.html#puttygen-conversions)。



您可以使用身份验证代理 `Pageant` ，这样您就不需要在此处显式配置密钥;见[第9章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter9.html#pageant)。



如果此处指定了私钥文件并运行 `Pageant` ，`PuTTY` 将首先尝试要求 `Pageant` 使用该密钥进行身份验证，并忽略 `Pageant` 可能拥有的任何其他密钥。

如果失败，`PuTTY` 将像往常一样要求提供密码。

在这种情况下，您还可以指定一个*公钥*文件（ `RFC 4716` 或 `OpenSSH` 格式），因为这足以识别 `Pageant` 的密钥，但当然，如果 `Pageant` 不存在，`PuTTY` 就不能回退到使用此文件本身。



### 4.22.2 “与私钥一起使用的证书”

在某些环境中，用户身份验证密钥可以由“证书颁发机构”（简称“CA”）依次签名，`SSH` 服务器上的用户帐户可以配置为自动信任由正确签名认证的任何密钥。



如果您有非常多的服务器，这可能是一个方便的设置。

更改密钥对时，可能必须单独编辑每台服务器上的文件，以使它们都接受新密钥。

但是，如果您将*所有这些服务器配置为*接受由 `CA` 签名的密钥，那么当您更改公钥时，您所要做的就是让新密钥由与以前相同的 `CA` 认证，然后您的所有服务器将自动接受它，而无需单独重新配置 `authorized_keys` 。

使用证书的一种方法是将其合并到私钥文件中。

[第 8.2.9 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter8.html#puttygen-cert)解释了如何使用 `PuTTYgen` 执行此操作。



但另一种方法是告诉 `PuTTY` 本身在哪里可以找到公共证书文件，然后在使用相应的私钥进行身份验证时自动显示该证书。

为此，请在“与私钥一起使用的证书”文件选择器中输入证书文件的路径名。

配置此设置后，无论私钥是在文件中找到还是加载到 `Pageant` 中，`PuTTY` 都会遵守它。



### 4.22.3 “提供身份验证响应的插件”

`SSH` 服务器可以使用“键盘交互”协议来呈现一系列任意问题和答案。有时这用于普通密码，但有时服务器会使用相同的机制来处理更复杂的事情，例如一次性密码系统。

其中一些系统可以自动化。为此，`PuTTY` 允许您提供一个单独的程序作为“插件”，它将接管身份验证并代表您发送问题的答案。

如果您已获得此类型的插件，则可以通过在“要运行的插件命令”框中输入完整的命令行来在此处对其进行配置。

（如果要*编写*这种类型的插件，请参阅[附录 H](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/AppendixH.html#authplugin)，了解插件预期行为的完整规范。



## 4.23 `GSSAPI` 面板

“认证”面板的“GSSAPI”子面板控制 `GSSAPI` 身份验证的使用。

这是一种将身份验证交换委托给客户端计算机上其他位置的库的机制，该库原则上可以通过许多不同的方式进行身份验证，但实际上通常与 `Kerberos` 单点登录协议一起使用以实现无密码登录。

图d20



`GSSAPI` 身份验证仅在 `SSH-2` 协议中可用。

`PuTTY` 支持两种形式的基于 `GSSAPI` 的身份验证。

在其中一个，`SSH` 密钥交换以正常方式进行，`GSSAPI` 仅参与对用户进行身份验证。

标有“尝试使用 `GSSAPI` 认证”的复选框控制此表单。



在另一种方法中，基于 `GSSAPI` 的身份验证与 `SSH` 密钥交换阶段相结合。

如果此操作成功，则 `SSH` 身份验证步骤无需执行任何操作。

有关此方法的详细信息，请参见[第 4.18.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-gssapi-kex)。

标有“启用 `GSSAPI` 密钥交换”的复选框控制此表单。

（相同的复选框显示在“密钥”面板上。）



如果启用了其中一个或两个控件，则将以一种或另一种形式尝试 `GSSAPI` 身份验证，并且（通常）如果您的客户端计算机加载了有效的 `Kerberos` 凭据，则 `PuTTY` 应该能够自动向支持 `Kerberos` 登录的服务器进行身份验证。

如果这两个复选框都被禁用，`PuTTY` 根本不会尝试任何形式的 `GSSAPI` ，并且此面板的其余部分将不会被使用。



### 4.23.1 “启用 `GSSAPI` 凭据委派”

`GSSAPI` 凭据委派是一种将 `Kerberos`（或其他）身份传递给 `SSH` 服务器上会话的机制。

如果启用此选项，则 `PuTTY` 不仅能够自动登录到接受您的 `Kerberos` 凭据的服务器，而且您将能够从该服务器连接到其他支持 `Kerberos` 的服务，并自动使用相同的凭据。

（此选项是 `SSH` 代理转发的 `Kerberos` 类似物;有关此内容的一些信息，请参见[第 9.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter9.html#pageant-forward)。）



请注意，与 `SSH` 代理转发一样，使用此选项存在安全隐患：您连接到的服务器的管理员或破解了该服务器上管理员帐户的任何其他人都可能在连接到其他支持 `Kerberos` 的服务时伪造您的身份。

但是，`Kerberos` 站点通常由中央机构运行，因此一台服务器的管理员也可能已经可以访问其他服务;因此，这通常比 `SSH` 代理转发的风险更小。

如果您的连接未使用 `GSSAPI` 密钥交换，则委派可能会在会话期间过期。有关更多信息，请参见[第 4.18.1.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-gssapi-kex)。



### 4.23.2 `GSSAPI` 库的优先顺序

`GSSAPI` 是一种允许通过同一接口访问多种身份验证方法的机制。

因此，您的系统上可能存在多个可以使用 `GSSAPI` 访问的身份验证库。



`PuTTY` 包含对一些众所周知的此类库（包括 `Windows` 的 `SSPI` ）的本机支持，并将在您的系统上查找所有这些库，并使用它找到的任何库。

如果系统上存在多个首选项，并且您需要使用特定的首选项列表控件，则可以使用此首选项列表控件调整其搜索顺序。



首选项列表中的选项之一是使用用户指定的 `GSSAPI` 库。

如果您要使用的库在 `PuTTY` 的选项列表中未按名称提及，您可以在“用户支持的 `GSSAPI` 库路径”字段中输入其完整路径名，然后在参考列表中移动“用户提供的 `GSSAPI` 库”选项，以确保先选中该库。



在 `Windows` 上，此类库是带有扩展名 `.dll` 的文件，并且必须以与您正在运行的 `PuTTY` 可执行文件相同的方式构建。

如果您有 `32` 位 `DLL` ，则必须运行 `32` 位版本的 `PuTTY` ，与 `64` 位版本相同（请参阅[问题 A.6.10](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/AppendixA.html#faq-32bit-64bit)）。

在 `Unix` 上，共享库通常有一个扩展 `.so` 。



## 4.24 `TTY` 面板

`TTY` 面板允许您配置远程伪终端。



### 4.24.1 “不分配伪终端”

当连接到 `Unix` 系统时，大多数交互式 `shell` 会话都在伪终端中运行，这允许 `Unix` 系统假装它正在与真实的物理*终端*设备通信，但允许 `SSH` 服务器捕获来自该假设备的所有数据并将其发送回客户端。



有时，您可能会发现需要运行*不在*伪终端中的会话。

在 `PuTTY` 中，这通常只对非常专业的目的有用;尽管在 `Plink`（见[第7章](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter7.html#plink)）中，这是通常的工作方式。



### 4.24.2 发送终端模式

`SSH` 协议允许客户端为远程伪终端发送“终端模式”。

这些通常控制服务器对本地终端行为的期望。



如果您的服务器对这些模式没有合理的默认值，您可能会发现在此处更改它们会有所帮助，尽管服务器可以自由地忽略您的更改。

如果您不了解这些内容，可以安全地保留这些设置。

（如果未请求或分配伪终端，则这些设置都不会产生任何影响。）



您可以通过在列表中选择特定模式，选择其中一个选项并在必要时指定确切值，然后点击“设置”来更改特定模式发生的情况。

选项的效果如下：

- 如果选择“自动”选项，`PuTTY` 工具将决定是否向服务器指定该模式，如果是，将发送合理的值。

  `PuTTY` 本身将发送它有意见的模式（目前只有退格键的代码 `ERASE` ，以及字符集 `IUTF8` 是否为 `UTF-8` ）。

  `Unix` 上的 `Plink` 将从本地终端传播适当的模式（如果有的话）。

- 如果选择“无”，则在任何情况下都不会为服务器指定模式值。

- 如果指定了值，则在任何情况下都会将其发送到服务器。

  指定模式值的精确语法取决于模式。



默认情况下，所有可用模式都列为“自动”，在大多数情况下应该做正确的事情。

每个设置的确切效果（如果有）取决于服务器。

它们的名称来自 `POSIX` 和其他 `Unix` 系统，它们最有可能对此类 `stty` 系统产生有用的影响。

（这些设置通常可以在登录到此类服务器后使用该命令进行更改。）



下面描述了一些值得注意的模式;有关更全面的说明，请参阅服务器文档。

- `ERASE` 是用户键入时将删除左侧一个空格的字符。

  当设置为“自动”（默认设置）时，这将遵循 `PuTTY` 中本地退格键的设置（请参阅[第 4.4.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-backspace)）。
  
  此字符和其他特殊字符使用 `^C` 的表示法指定 `Ctrl-C`，依此类推。

  使用 `^<27>` 或 `^<0x1B>` 以数字方式指定字符，并用 `^~` 来获取文本，其他非控制字符由它们本身表示。

  将该框完全留空表示不应为指定的函数*分配任何字符*，尽管并非所有服务器都支持此功能。`^`

- `QUIT`是一个特殊字符，通常强制结束服务器上的当前进程 （）。在许多服务器上，它的默认设置是 Ctrl 反斜杠 （），这很容易在许多键盘上意外调用。如果这妨碍了您，您可能需要将其更改为另一个角色或完全关闭它。`SIGQUIT``^\`

- 布尔模式（如 和）可以在 PuTTY 中以多种方式指定，例如 /、/ 和 /。（显式指定值 与根本不发送模式不同。`ECHO``ICANON``true``false``yes``no``0``1``no`

- 布尔模式向服务器发出终端字符集是否为 UTF-8 的信号，用于基本行编辑等目的;例如，如果设置不正确，退格键可能会擦除错误数量的文本。但是，仅设置此值通常不足以使服务器使用 UTF-8;POSIX 服务器通常还需要设置区域设置（通过某些依赖于服务器的方式），尽管许多较新的安装默认为 UTF-8。此外，由于此模式添加到SSH协议的时间比其他模式晚得多，因此许多服务器（尤其是较旧的服务器）不遵循通过SSH发送的此模式;事实上，一些写得不好的服务器反对它的存在，所以你可能会发现你需要把它设置为根本不发送。当设置为“自动”时，这将遵循本地配置的字符集（请参阅[第 4.10.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-charset)）。`IUTF8`

- 终端速度在其他地方配置;请参见[第 4.15.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-termspeed)。

## 4.25 X11面板

X11 面板允许您配置通过 SSH 连接转发 X11。

如果您的服务器允许您运行 X Window System 图形应用程序，则 X11 转发允许您安全地授予这些应用程序访问 PC 上的本地 X 显示器的权限。

要启用 X11 转发，请选中“启用 X11 转发”框。如果您的 X 显示器位置异常，您需要在“X 显示器位置”框中输入其位置;如果将其留空，PuTTY 将尝试在环境中查找合理的默认值，或者在失败时使用主本地显示 （）。`:0`

有关 X3 转发的更多信息，请参见第 [4.11 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-x-forwarding)。

### 4.25.1 远程 X11 身份验证

如果您使用的是 X11 转发，则在 SSH 服务器计算机上创建的虚拟 X 服务器将受到授权数据的保护。这些数据是由PuTTY发明和检查的。

通常用于此目的的授权方法称为 。这是一个简单的密码式协议：X 客户端向服务器发送一些 cookie 数据，服务器检查它是否与真正的 cookie 匹配。Cookie 数据通过未加密的 X11 连接发送;因此，如果您允许第三台计算机上的客户端访问虚拟 X 服务器，则 cookie 将以明文形式发送。`MIT-MAGIC-COOKIE-1`

PuTTY提供了替代协议。这是一个经过加密身份验证的协议：X 客户端每次发送的数据都不同，它取决于客户端连接端的 IP 地址和端口，并且还标记了当前时间。因此，捕获字符串的窃听者不能立即将其重新用于自己的 X 连接。`XDM-AUTHORIZATION-1``XDM-AUTHORIZATION-1`

PuTTY 的支持有点实验性，可能会遇到几个问题：`XDM-AUTHORIZATION-1`

- 有些X客户端可能甚至不支持，所以他们不知道如何处理PuTTY提供的数据。`XDM-AUTHORIZATION-1`
- 此身份验证机制仅适用于 SSH-2。在 SSH-1 中，SSH 服务器不会以机器可读的格式告诉客户端转发连接的源地址，因此无法验证数据。`XDM-AUTHORIZATION-1`
- 您可能会发现此功能会导致某些 SSH 服务器出现问题，这些服务器不会在会话后清理数据，因此，如果您随后使用仅执行并分配相同远程显示编号的客户端连接到同一服务器，您可能会发现过时的身份验证数据仍然存在于您的服务器上，并且您的 X 连接失败。`XDM-AUTHORIZATION-1``MIT-MAGIC-COOKIE-1`

PuTTY 的默认值为 。如果你改变它，你应该确保你知道你在做什么。`MIT-MAGIC-COOKIE-1`

### 4.25.2 用于本地显示的 X 规范文件

如果您使用的是 X11 转发，则转发的连接最终定向到的本地 X 服务器本身可能需要授权。

某些Windows X服务器不需要这样做：它们通过更简单的方式进行授权，例如接受来自本地计算机的任何连接，但不接受来自其他任何地方的连接。但是，如果您的 X 服务器确实需要授权，那么 PuTTY 需要知道需要什么授权。

提供此数据的一种方法是让 X 服务器将其存储在与 Unix 文件格式相同的文件中的某个位置。如果这是您的Windows X服务器的工作方式，那么您可以通过配置此选项告诉PuTTY在哪里可以找到此文件。默认情况下，PuTTY 不会尝试查找本地显示器的任何授权。`.Xauthority`

## 4.26 隧道面板

“隧道”面板允许您通过 SSH 连接配置任意连接类型的隧道。

端口转发允许您通过 SSH 会话通过隧道传输其他类型的网络连接。有关端口转发及其工作原理的一般讨论，请参见[第 3.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-port-forwarding)。

“隧道”面板中的端口转发部分显示 PuTTY 在连接到服务器时将尝试设置的所有端口转发的列表。默认情况下，不设置端口转发，因此此列表为空。

要添加端口转发：

- 设置“本地”或“远程”单选按钮之一，具体取决于是要将本地端口转发到远程目标（“本地”）还是将远程端口转发到本地目标（“远程”）。或者，如果您希望 PuTTY 在本地端口上提供本地 SOCKS 4/4A/5 代理，请选择“动态”（请注意，此代理仅支持 TCP 连接;SSH 协议不支持转发 UDP）。
- 在“源端口”框中输入源端口号。对于本地转发，PuTTY 将侦听您 PC 的此端口。对于远程转发，SSH 服务器将侦听远程计算机的此端口。请注意，大多数服务器不允许您侦听小于 1024 的端口号。
- 如果您选择了“本地”或“远程”（“动态”不需要此步骤），请在“目标”框中输入主机名和端口号，以冒号分隔。在源端口上收到的连接将定向到此目标。例如，要连接到 POP-3 服务器，可以输入 。（如果需要输入文字 IPv6 地址，请将其括在方括号中，例如“”。`popserver.example.com:110``[::1]:2200`
- 单击“添加”按钮。您的转发详细信息应显示在列表框中。

要删除端口转发，只需在列表框中选择其详细信息，然后单击“删除”按钮。

在“源端口”框中，您还可以选择输入要侦听的 IP 地址，方法是指定（例如）。有关其工作原理及其限制的更多信息，请参阅[第 3.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-port-forwarding)。`127.0.0.5:79`

您可以输入服务名称（如果本地系统知道这些名称），而不是端口号。例如，在“目的地”框中，您可以输入.`popserver.example.com:pop3`

您可以在会话中使用“更改设置”修改当前活动的端口转发集（请参阅[第 3.1.3.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-changesettings)）。如果在会话中途删除本地或动态端口转发，PuTTY 将停止侦听该端口上的连接，以便其他程序可以重复使用它。如果删除远程端口转发，请注意：

- SSH-1 协议不包含要求服务器停止侦听远程端口的机制。
- SSH-2协议确实包含这样的机制，但并非所有SSH服务器都支持它。（特别是，OpenSSH 在 3.9 之前的任何版本中都不支持它。

如果您要求删除远程端口转发，并且 PuTTY 无法使服务器实际停止侦听该端口，它将开始拒绝该端口上的传入连接。因此，尽管该端口不能被其他程序重用，但您至少可以合理地确定服务器端程序无法再访问端口转发端的服务。

如果删除转发，使用该转发建立的任何现有连接将保持打开状态。同样，对全局设置（例如“本地端口接受来自其他主机的连接”）的更改只会对新转发生效。

如果您通过 SSH 转发的连接本身是由另一个 PuTTY 副本建立的第二个 SSH 连接，您可能会发现“逻辑主机名”配置选项可用于警告 PuTTY 它应该需要哪个主机密钥。有关详细信息，请参见[第 4.14.5 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-loghost)。

### 4.26.1 控制转发端口的可见性

转发连接的源端口通常不接受来自除 SSH 客户端或服务器计算机本身以外的任何计算机的连接（分别用于本地和远程转发）。“隧道”面板中有一些控件可以更改此设置：

- “本地端口接受来自其他主机的连接”选项允许您设置本地到远程端口转发，以便客户端计算机以外的计算机可以连接到转发的端口。（这也适用于动态袜子转发。
- “远程端口执行相同的操作”选项对远程到本地端口转发执行相同的操作（以便 SSH 服务器计算机以外的计算机可以连接到转发的端口）。请注意，此功能仅在 SSH-2 协议中可用，并非所有 SSH-2 服务器都支持它（例如，OpenSSH 3.0 不支持）。

### 4.26.2 为转发端口选择互联网协议版本

此交换机允许您为转发端口的本地端选择特定的互联网协议（IPv4 或 IPv6）。默认情况下，它设置为“自动”，这意味着：

- 对于本地到远程端口转发，PuTTY 将侦听 IPv4 和（如果可用）IPv6 中的传入连接
- 对于远程到本地端口转发，PuTTY 将为传出连接选择合理的协议。

这将覆盖“连接”面板上的常规因特网协议版本首选项（请参阅[第 4.14.4 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-address-family)）。

请注意，即使您特别要求 IPv4，某些操作系统也可能会侦听 IPv6 中的传入连接，因为它们的 IPv4 和 IPv6 协议堆栈链接在一起。显然Linux这样做，而Windows没有。因此，如果您在 Windows 上运行 PuTTY 并且勾选“IPv6”进行本地或动态端口转发，则*只能*通过使用 IPv6 连接到它来使用它;而如果你在Linux上做同样的事情，你也可以在IPv4上使用它。但是，勾选“自动”应始终为您提供一个可以使用任一协议连接的端口。

## 4.27 错误和更多错误面板

并非所有 SSH 服务器都能正常工作。各种现有服务器中都有错误，这可能使客户端无法与它们通信，除非它知道错误并解决它。

由于大多数服务器在SSH连接开始时宣布其软件版本号，因此PuTTY将尝试检测它可能在服务器中看到的错误并自动启用解决方法。但是，有时它会犯错误;如果服务器被故意配置为隐藏其版本号，或者如果服务器是 PuTTY 的错误数据库不知道的版本，那么 PuTTY 将不知道会发生什么错误。

“错误”和“更多错误”面板（有两个，因为我们有很多错误兼容模式）允许您手动配置 PuTTY 希望在服务器中看到的错误。每个 bug 都可以配置为三种状态：

- “关闭”：PuTTY 将假定服务器没有该错误。
- “开”：PuTTY将假定服务器*确实*存在错误。
- “自动”：PuTTY 将使用服务器的版本号公告来尝试猜测服务器是否存在错误。（此选项不适用于*无法*从服务器版本中检测到的错误，例如，因为在知道服务器版本之前必须对它们执行操作。

### 4.27.1 “SSH-2 阻塞忽略消息”

忽略消息 （SSH_MSG_IGNORE） 是 SSH 协议中的消息，可以随时从客户端发送到服务器，或从服务器发送到客户端。任何一方在收到消息时都必须忽略该消息。PuTTY 使用 SSH-2 中的忽略消息来混淆加密的数据流，使其更难进行加密分析。它还使用忽略消息进行连接保持连接（请参阅[第 4.14.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-keepalive)）。

如果它认为服务器存在此错误，PuTTY 将停止使用忽略消息。如果在与正确的服务器通信时启用了此错误，则会话将成功，但保持连接将不起作用，并且会话的加密安全性可能不如应有的水平。

### 4.27.2 “处理 SSH-2 密钥重新交换不当”

某些 SSH 服务器根本无法处理重复密钥交换，并且会忽略客户端启动密钥交换的尝试。由于 PuTTY 在执行重复密钥交换时暂停会话，因此这样做会导致会话在一小时后挂起（除非您以不同的方式设置了重新密钥超时;有关重新密钥的更多信息，请参阅[第 4.18.2 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-kex-rekey)）。其他非常旧的SSH服务器处理重复密钥交换的方式更加糟糕，并且在收到重复密钥交换请求时断开连接。

如果检测到此错误，PuTTY 将永远不会启动重复密钥交换。如果在与正确的服务器通信时启用了此错误，则会话仍应正常运行，但安全性可能低于预期。

这是一个特定于 SSH-2 的错误。

### 4.27.3 “PuTTY 的 SSH-2 请求窒息”`winadj`

PuTTY 有时会在通道数据中间向 SSH 服务器发送特殊请求，名称为（参见 [G.1 节](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/AppendixG.html#sshnames-channel)）。此请求的目的是测量到服务器的往返时间，PuTTY 使用该时间来调整其流量控制。服务器实际上不必*理解*消息;它应该发回一条消息，指示它不理解它。（PuTTY在时序计算中所需要的只是*某种*响应。`winadj@putty.projects.tartarus.org``SSH_MSG_CHANNEL_FAILURE`

众所周知，某些SSH服务器会以某种方式对此消息感到困惑 - 因为它的名称很长，或者因为它们无法处理无法识别的请求名称，甚至无法发回正确的失败响应，或者因为它们明智地处理它，但用毫无意义的垃圾邮件填充服务器的日志文件， 什么的。因此，PuTTY 支持这个错误兼容性标志：如果它认为服务器有这个错误，它将永远不会发送其 '' 请求，并且不会使用其计时数据。`winadj@putty.projects.tartarus.org`

### 4.27.4 “对封闭渠道请求的回复”

RFC 4254 中发布的 SSH 协议存在歧义，如果连接的一端尝试关闭通道，而另一端同时在通道内发送请求并请求回复，则会出现歧义。RFC 4254 不清楚关闭方在宣布打算关闭通道后是否应该回复通道请求。

Discussion on the mailing list in April 2014 formed a clear consensus that the right answer is no. However, because of the ambiguity in the specification, some SSH servers have implemented the other policy; for example, [OpenSSH used to](https://bugzilla.mindrot.org/show_bug.cgi?id=1818) until it was fixed. `ietf-ssh`

Because PuTTY sends channel requests with the ‘want reply’ flag throughout channels' lifetime (see [section 4.27.3](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-bug-winadj)), it's possible that when connecting to such a server it might receive a reply to a request after it thinks the channel has entirely closed, and terminate with an error along the lines of ‘Received for nonexistent channel 256’. `SSH2_MSG_CHANNEL_FAILURE`

### 4.27.5 ‘Ignores SSH-2 maximum packet size’

When an SSH-2 channel is set up, each end announces the maximum size of data packet that it is willing to receive for that channel. Some servers ignore PuTTY's announcement and send packets larger than PuTTY is willing to accept, causing it to report ‘Incoming packet was garbled on decryption’.

If this bug is detected, PuTTY never allows the channel's flow-control window to grow large enough to allow the server to send an over-sized packet. If this bug is enabled when talking to a correct server, the session will work correctly, but download performance will be less than it could be.

### 4.27.6 ‘Discards data sent before its greeting’

Just occasionally, an SSH connection can be established over some channel that will accidentally discard outgoing data very early in the connection.

This is not typically seen as a bug in an actual SSH server, but it can sometimes occur in situations involving a complicated proxy process. An example is [Debian bug #991958](https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=991958), in which a connection going over the console of a User Mode Linux kernel can lose outgoing data before the kernel has fully booted.

You can work around this problem by manually enabling this bug flag, which will cause PuTTY to wait to send its initial SSH greeting until after it sees the greeting from the server.

Note that this bug flag can never be automatically detected, since auto-detection relies on the version string in the server's greeting, and PuTTY has to decide whether to expect this bug *before* it sees the server's greeting. So this is a manual workaround only.

### 4.27.7 ‘Chokes on PuTTY's full ’`KEXINIT`

At the start of an SSH connection, the client and server exchange long messages of type , containing lists of all the cryptographic algorithms they're prepared to use. This is used to negotiate a set of algorithms that both ends can speak. `SSH_MSG_KEXINIT`

Occasionally, a badly written server might have a length limit on the list it's prepared to receive, and refuse to make a connection simply because PuTTY is giving it too many choices.

A workaround is to enable this flag, which will make PuTTY wait to send until after it receives the one from the server, and then filter its own to leave out any algorithm the server doesn't also announce support for. This will generally make PuTTY's at most the size of the server's, and will otherwise make no difference to the algorithm negotiation. `KEXINIT``KEXINIT``KEXINIT`

This flag is a minor violation of the SSH protocol, because both sides are supposed to send proactively. It still works provided *one* side sends its without waiting, but if both client and server waited for the other one to speak first, the connection would deadlock. We don't know of any servers that do this, but if there is one, then this flag will make PuTTY unable to speak to them at all. `KEXINIT``KEXINIT`

### 4.27.8 ‘Requires padding on SSH-2 RSA signatures’

Versions below 3.3 of OpenSSH require SSH-2 RSA signatures to be padded with zero bytes to the same length as the RSA key modulus. The SSH-2 specification says that an unpadded signature MUST be accepted, so this is a bug. A typical symptom of this problem is that PuTTY mysteriously fails RSA authentication once in every few hundred attempts, and falls back to passwords.

If this bug is detected, PuTTY will pad its signatures in the way OpenSSH expects. If this bug is enabled when talking to a correct server, it is likely that no damage will be done, since correct servers usually still accept padded signatures because they're used to talking to OpenSSH.

This is an SSH-2-specific bug.

### 4.27.9 ‘Only supports pre-RFC4419 SSH-2 DH GEX’

The SSH key exchange method that uses Diffie-Hellman group exchange was redesigned after its original release, to use a slightly more sophisticated setup message. Almost all SSH implementations switched over to the new version. (PuTTY was one of the last.) A few old servers still only support the old one.

If this bug is detected, and the client and server negotiate Diffie-Hellman group exchange, then PuTTY will send the old message now known as in place of the new . `SSH2_MSG_KEX_DH_GEX_REQUEST_OLD``SSH2_MSG_KEX_DH_GEX_REQUEST`

This is an SSH-2-specific bug.

### 4.27.10 ‘Miscomputes SSH-2 HMAC keys’

Versions 2.3.0 and below of the SSH server software from compute the keys for their HMAC message authentication codes incorrectly. A typical symptom of this problem is that PuTTY dies unexpectedly at the beginning of the session, saying ‘Incorrect MAC received on packet’. `ssh.com`

If this bug is detected, PuTTY will compute its HMAC keys in the same way as the buggy server, so that communication will still be possible. If this bug is enabled when talking to a correct server, communication will fail.

This is an SSH-2-specific bug.

### 4.27.11 ‘Misuses the session ID in SSH-2 PK auth’

Versions below 2.3 of OpenSSH require SSH-2 public-key authentication to be done slightly differently: the data to be signed by the client contains the session ID formatted in a different way. If public-key authentication mysteriously does not work but the Event Log (see [section 3.1.3.1](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-eventlog)) thinks it has successfully sent a signature, it might be worth enabling the workaround for this bug to see if it helps.

If this bug is detected, PuTTY will sign data in the way OpenSSH expects. If this bug is enabled when talking to a correct server, SSH-2 public-key authentication will fail.

This is an SSH-2-specific bug.

### 4.27.12 ‘Miscomputes SSH-2 encryption keys’

Versions below 2.0.11 of the SSH server software from compute the keys for the session encryption incorrectly. This problem can cause various error messages, such as ‘Incoming packet was garbled on decryption’, or possibly even ‘Out of memory’. `ssh.com`

If this bug is detected, PuTTY will compute its encryption keys in the same way as the buggy server, so that communication will still be possible. If this bug is enabled when talking to a correct server, communication will fail.

This is an SSH-2-specific bug.

### 4.27.13 ‘Chokes on SSH-1 ignore messages’

An ignore message (SSH_MSG_IGNORE) is a message in the SSH protocol which can be sent from the client to the server, or from the server to the client, at any time. Either side is required to ignore the message whenever it receives it. PuTTY uses ignore messages to hide the password packet in SSH-1, so that a listener cannot tell the length of the user's password; it also uses ignore messages for connection keepalives (see [section 4.14.1](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-keepalive)).

If this bug is detected, PuTTY will stop using ignore messages. This means that keepalives will stop working, and PuTTY will have to fall back to a secondary defence against SSH-1 password-length eavesdropping. See [section 4.27.14](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-bug-plainpw1). If this bug is enabled when talking to a correct server, the session will succeed, but keepalives will not work and the session might be more vulnerable to eavesdroppers than it could be.

### 4.27.14 ‘Refuses all SSH-1 password camouflage’

When talking to an SSH-1 server which cannot deal with ignore messages (see [section 4.27.13](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-bug-ignore1)), PuTTY will attempt to disguise the length of the user's password by sending additional padding *within* the password packet. This is technically a violation of the SSH-1 specification, and so PuTTY will only do it when it cannot use standards-compliant ignore messages as camouflage. In this sense, for a server to refuse to accept a padded password packet is not really a bug, but it does make life inconvenient if the server can also not handle ignore messages.

If this ‘bug’ is detected, PuTTY will assume that neither ignore messages nor padding are acceptable, and that it thus has no choice but to send the user's password with no form of camouflage, so that an eavesdropping user will be easily able to find out the exact length of the password. If this bug is enabled when talking to a correct server, the session will succeed, but will be more vulnerable to eavesdroppers than it could be.

This is an SSH-1-specific bug. SSH-2 is secure against this type of attack.

### 4.27.15 ‘Chokes on SSH-1 RSA authentication’

Some SSH-1 servers cannot deal with RSA authentication messages at all. If Pageant is running and contains any SSH-1 keys, PuTTY will normally automatically try RSA authentication before falling back to passwords, so these servers will crash when they see the RSA attempt.

If this bug is detected, PuTTY will go straight to password authentication. If this bug is enabled when talking to a correct server, the session will succeed, but of course RSA authentication will be impossible.

This is an SSH-1-specific bug.

## 4.28 The ‘Bare ’ protocol`ssh-connection`

In addition to SSH itself, PuTTY also supports a second protocol that is derived from SSH. It's listed in the PuTTY GUI under the name ‘Bare ’. `ssh-connection`

This protocol consists of just the innermost of SSH-2's three layers: it leaves out the cryptography layer providing network security, and it leaves out the authentication layer where you provide a username and prove you're allowed to log in as that user.

It is therefore **completely unsuited to any network connection**. Don't try to use it over a network!

The purpose of this protocol is for various specialist circumstances in which the ‘connection’ is not over a real network, but is a pipe or IPC channel between different processes running on the *same* computer. In these contexts, the operating system will already have guaranteed that each of the two communicating processes is owned by the expected user (so that no authentication is necessary), and that the communications channel cannot be tapped by a hostile user on the same machine (so that no cryptography is necessary either). Examples of possible uses involve communicating with a strongly separated context such as the inside of a container, or a VM, or a different network namespace.

Explicit support for this protocol is new in PuTTY 0.75. As of 2021-04, the only known server for the bare protocol is the Unix program ‘’ that is also part of the PuTTY tool suite. `ssh-connection``psusan`

(However, this protocol is also the same one used between instances of PuTTY to implement connection sharing: see [section 4.17.5](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-ssh-sharing). In fact, in the Unix version of PuTTY, when a sharing upstream records ‘Sharing this connection at [pathname]’ in the Event Log, it's possible to connect another instance of PuTTY directly to that Unix socket, by entering its pathname in the host name box and selecting ‘Bare ’ as the protocol!) `ssh-connection`

Many of the options under the SSH panel also affect this protocol, although options to do with cryptography and authentication do not, for obvious reasons.

I repeat, **DON'T TRY TO USE THIS PROTOCOL FOR NETWORK CONNECTIONS!** That's not what it's for, and it's not at all safe to do it.

## 4.29 The Serial panel

The Serial panel allows you to configure options that only apply when PuTTY is connecting to a local serial line.

### 4.29.1 Selecting a serial line to connect to

The ‘Serial line to connect to’ box allows you to choose which serial line you want PuTTY to talk to, if your computer has more than one serial port.

On Windows, the first serial line is called , and if there is a second it is called , and so on. `COM1``COM2`

This configuration setting is also visible on the Session panel, where it replaces the ‘Host Name’ box (see [section 4.1.1](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-hostname)) if the connection type is set to ‘Serial’.

### 4.29.2 Selecting the speed of your serial line

The ‘Speed’ box allows you to choose the speed (or ‘baud rate’) at which to talk to the serial line. Typical values might be 9600, 19200, 38400 or 57600. Which one you need will depend on the device at the other end of the serial cable; consult the manual for that device if you are in doubt.

This configuration setting is also visible on the Session panel, where it replaces the ‘Port’ box (see [section 4.1.1](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter4.html#config-hostname)) if the connection type is set to ‘Serial’.

### 4.29.3 Selecting the number of data bits

The ‘Data bits’ box allows you to choose how many data bits are transmitted in each byte sent or received through the serial line. Typical values are 7 or 8.

### 4.29.4 Selecting the number of stop bits

The ‘Stop bits’ box allows you to choose how many stop bits are used in the serial line protocol. Typical values are 1, 1.5 or 2.

### 4.29.5 Selecting the serial parity checking scheme

The ‘Parity’ box allows you to choose what type of parity checking is used on the serial line. The settings are:

- ‘None’: no parity bit is sent at all.
- ‘Odd’: an extra parity bit is sent alongside each byte, and arranged so that the total number of 1 bits is odd.
- ‘Even’: an extra parity bit is sent alongside each byte, and arranged so that the total number of 1 bits is even.
- ‘Mark’: an extra parity bit is sent alongside each byte, and always set to 1.
- ‘Space’: an extra parity bit is sent alongside each byte, and always set to 0.

### 4.29.6 Selecting the serial flow control scheme

The ‘Flow control’ box allows you to choose what type of flow control checking is used on the serial line. The settings are:

- ‘None’: no flow control is done. Data may be lost if either side attempts to send faster than the serial line permits.
- ‘XON/XOFF’: flow control is done by sending XON and XOFF characters within the data stream.
- ‘RTS/CTS’: flow control is done using the RTS and CTS wires on the serial line.
- ‘DSR/DTR’: flow control is done using the DSR and DTR wires on the serial line.

## 4.30 The Telnet panel

The Telnet panel allows you to configure options that only apply to Telnet sessions.

### 4.30.1 ‘Handling of OLD_ENVIRON ambiguity’

The original Telnet mechanism for passing environment variables was badly specified. At the time the standard (RFC 1408) was written, BSD telnet implementations were already supporting the feature, and the intention of the standard was to describe the behaviour the BSD implementations were already using.

Sadly there was a typing error in the standard when it was issued, and two vital function codes were specified the wrong way round. BSD implementations did not change, and the standard was not corrected. Therefore, it's possible you might find either BSD or RFC-compliant implementations out there. This switch allows you to choose which one PuTTY claims to be.

The problem was solved by issuing a second standard, defining a new Telnet mechanism called , which behaved exactly like the original but was not encumbered by existing implementations. Most Telnet servers now support this, and it's unambiguous. This feature should only be needed if you have trouble passing environment variables to quite an old server. `NEW_ENVIRON``OLD_ENVIRON`

### 4.30.2 Passive and active Telnet negotiation modes

In a Telnet connection, there are two types of data passed between the client and the server: actual text, and *negotiations* about which Telnet extra features to use.

PuTTY can use two different strategies for negotiation:

- In *active* mode, PuTTY starts to send negotiations as soon as the connection is opened.
- In *passive* mode, PuTTY will wait to negotiate until it sees a negotiation from the server.

The obvious disadvantage of passive mode is that if the server is also operating in a passive mode, then negotiation will never begin at all. For this reason PuTTY defaults to active mode.

However, sometimes passive mode is required in order to successfully get through certain types of firewall and Telnet proxy server. If you have confusing trouble with a firewall, you could try enabling passive mode to see if it helps.

### 4.30.3 ‘Keyboard sends Telnet special commands’

If this box is checked, several key sequences will have their normal actions modified:

- the Backspace key on the keyboard will send the Telnet special backspace code;
- Control-C will send the Telnet special Interrupt Process code;
- Control-Z will send the Telnet special Suspend Process code.

You probably shouldn't enable this unless you know what you're doing.

### 4.30.4 ‘Return key sends Telnet New Line instead of ^M’

Unlike most other remote login protocols, the Telnet protocol has a special ‘new line’ code that is not the same as the usual line endings of Control-M or Control-J. By default, PuTTY sends the Telnet New Line code when you press Return, instead of sending Control-M as it does in most other protocols.

Most Unix-style Telnet servers don't mind whether they receive Telnet New Line or Control-M; some servers do expect New Line, and some servers prefer to see ^M. If you are seeing surprising behaviour when you press Return in a Telnet session, you might try turning this option off to see if it helps.

## 4.31 The Rlogin panel

The Rlogin panel allows you to configure options that only apply to Rlogin sessions.

### 4.31.1 ‘Local username’

Rlogin allows an automated (password-free) form of login by means of a file called on the server. You put a line in your file saying something like , and then when you make an Rlogin connection the client transmits the username of the user running the Rlogin client. The server checks the username and hostname against , and if they match it does not ask for a password. `.rhosts``.rhosts``jbloggs@pc1.example.com``.rhosts`

This only works because Unix systems contain a safeguard to stop a user from pretending to be another user in an Rlogin connection. Rlogin connections have to come from port numbers below 1024, and Unix systems prohibit this to unprivileged processes; so when the server sees a connection from a low-numbered port, it assumes the client end of the connection is held by a privileged (and therefore trusted) process, so it believes the claim of who the user is.

Windows does not have this restriction: *any* user can initiate an outgoing connection from a low-numbered port. Hence, the Rlogin mechanism is completely useless for securely distinguishing several different users on a Windows machine. If you have a entry pointing at a Windows PC, you should assume that *anyone* using that PC can spoof your username in an Rlogin connection and access your account on the server. `.rhosts``.rhosts`

The ‘Local username’ control allows you to specify what user name PuTTY should claim you have, in case it doesn't match your Windows user name (or in case you didn't bother to set up a Windows user name).

## 4.32 The SUPDUP panel

The SUPDUP panel allows you to configure options that only apply to SUPDUP sessions. See [section 3.10](https://the.earth.li/~sgtatham/putty/0.78/htmldoc/Chapter3.html#using-supdup) for more about the SUPDUP protocol.

### 4.32.1 ‘Location string’

In SUPDUP, the client sends a piece of text of its choice to the server giving the user's location. This is typically displayed in lists of logged-in users.

By default, PuTTY just defaults this to "The Internet". If you want your location to show up as something more specific, you can configure it here.

### 4.32.2 ‘Extended ASCII Character set’

This declares what kind of character set extension your terminal supports. If the server supports it, it will send text using that character set. ‘None’ means the standard 95 printable ASCII characters. ‘ITS’ means ASCII extended with printable characters in the control character range. This character set is documented in the SUPDUP protocol definition. ‘WAITS’ is similar to ‘ITS’ but uses some alternative characters in the extended set: most prominently, it will display arrows instead of and , and instead of . ‘ITS’ extended ASCII is used by ITS and Lisp machines, whilst ‘WAITS’ is only used by the WAITS operating system from the Stanford AI Laboratory. `^``_``}``~`

### 4.32.3 ‘**MORE** processing’

When **MORE** processing is enabled, the server causes output to pause at the bottom of the screen, until a space is typed.

### 4.32.4 ‘Terminal scrolling’

这控制终端是执行滚动，然后光标进入最后一行下方，还是光标返回到第一行。

## 4.33 将配置存储在文件中

PuTTY 目前不支持将其配置存储在文件而不是注册表中。但是，您可以使用几个批处理文件解决此问题。

您将需要一个名为（例如）的文件，它将文件的内容导入注册表，然后运行PuTTY，将注册表的内容导出回文件中，并删除注册表项。这一切都可以使用 Regedit 命令行选项完成，因此这一切都是自动的。以下是您需要的内容：`PUTTY.BAT``PUTTY.BAT`

```
@ECHO OFF
regedit /s putty.reg
regedit /s puttyrnd.reg
start /w putty.exe
regedit /ea new.reg HKEY_CURRENT_USER\Software\SimonTatham\PuTTY
copy new.reg putty.reg
del new.reg
regedit /s puttydel.reg
```

此批处理文件需要两个辅助文件：为随机种子文件设置初始安全位置，并在成功保存回文件后销毁注册表中的所有内容。`PUTTYRND.REG``PUTTY.RND``PUTTYDEL.REG`

这是 ：`PUTTYDEL.REG`

```
REGEDIT4

[-HKEY_CURRENT_USER\Software\SimonTatham\PuTTY]
```

下面是一个示例文件：`PUTTYRND.REG`

```
REGEDIT4

[HKEY_CURRENT_USER\Software\SimonTatham\PuTTY]
"RandSeedFile"="a:\\putty.rnd"
```

应替换为要存储随机数数据的位置。如果目的是在一个USB记忆棒上携带PuTTY及其设置，您可能希望将其存储在USB记忆棒上。`a:\putty.rnd`







