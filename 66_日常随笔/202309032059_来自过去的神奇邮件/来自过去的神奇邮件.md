来自过去的神奇邮件

副标题：来自过去的神奇邮件

英文：a-magical-email-from-the-past

关键字：email,mail,past,邮件,邮箱,电子邮件,smtp,过去,received



“你来自哪里？”

“观众朋友们好，评委老师们好，我叫刘小谦，来自江苏。”

“你要表演什么节目呢？”

“接下来我为大家表演一个魔术。”

“好，开始你的表演……”



随着场景音乐的切换，刘小谦向观众深鞠一躬，然后淡定地从上衣口袋中掏出一部手机和一张A4 纸。

他面带微笑举着那张A4纸，示意其中一位评委老师登录纸上所写的一个QQ邮箱，说他接下来会发送一封神秘而又离奇的邮件。

评委老师向观众高调声明，他并不是这位魔术师的托儿，接着按纸上所写使用帐号和密码成功登录了那个神秘邮箱。

很显然，邮箱空空如也，并没有任何邮件。

不一会儿，手机弹出新消息，邮箱收到了一封新邮件，标题是送给XX老师的礼物，其他并没有什么特别的地方。

此时，刘小谦告诉评委老师，请先不要着急打开这封邮件，它的神秘之处需要稍后才能揭晓。

这位年轻魔术师的葫芦里到底卖的什么药呢？



紧接着刘小谦让几位评委老师在观众席中随机选取25名观众，并请他们走上舞台。

他让这些观众5人一组排成5行，并让工作人员给每人发了一张小纸条。

准备工作虽然花了一点点时间，不过很快一切就绪。

刘小谦这时向观众和评委娓娓道来，上台来的每一位朋友都依次按顺序站好，他们每人手握纸条，纸条上写着不同的词汇。

话音刚落大屏幕上立刻打出了一副画面，几行感人的文字印在观众的眼前。



> 我，长年漂泊在外，却一直有一个心愿，趁年轻带着爸妈去旅行。
>
> 我要和爸妈一起坐上 ▁▁▁▁，
> 飞一般地来到他们年轻时最向往的 ▁▁▁▁，
> 欣赏最美丽的 ▁▁▁▁，
> 品尝他们最钟爱的 ▁▁▁▁，
> 玩一次他们一直没有尝试过的 ▁▁▁▁。
>
> 不管一路充满荆棘，他们都会一路陪着你。
>
> 不管是酸甜或苦辣，他们都不会放弃你。
>
> 爸爸妈妈，你们辛苦了！我想你们！



刘小谦眼含泪水，向观众深情述说，希望能有空陪伴远在家乡的父母双亲。

他的愿望就是在有生之年能够带他们出去尽情游玩，欣赏美景，领略祖国大好河山。

话说完，刘小谦正对评委，请各位老师们随机选取台上从1到5每一排观众中的其中一位。

被选取观众手中纸条所写的文字将填写到大屏幕上的缺失部分。



比如，第一个空行，可选择的名词有，飞机、高铁、汽车、轮船、火箭。

第二个空行，可选择的名词有，北京、海南、成都、新疆、西藏、长沙。

第三个空行，可选择的名词有，日落、岛屿、雪山、瀑布、星海、峡谷。

第四个空行，可选择的名词有，火锅 、涮羊肉、 灌汤包 、热干面、烤鸭。

第五个空行，可选择的名词有，风驰赛车 、玻璃栈道、 索道缆车 、漂流水道、梦回大唐。



最后，评委们选择完毕，屏幕上打出了最终的结果。

> 我，长年漂泊在外，却一直有一个心愿，趁年轻带着爸妈去旅行。
>
> 我要和爸妈一起坐上 <u>高铁</u>，
> 飞一般地来到他们年轻时最向往的 <u>新疆</u>，
> 欣赏最美丽的 <u>星海</u>，
> 品尝他们最钟爱的 <u>涮羊肉</u>，
> 玩一次他们一直没有尝试过的 <u>玻璃栈道</u>。
>
> 不管一路充满荆棘，他们都会一路陪着你。
>
> 不管是酸甜或苦辣，他们都不会放弃你。
>
> 爸爸妈妈，你们辛苦了！我想你们！



就在观众评委们感动之时，刘小谦忽然郑重宣布，现在就是见证奇迹的时刻！

此时此刻镜头转向那部登录神秘邮箱的手机，观众们目不转睛地盯着大屏幕，在确认了接收时间没有任何变化后，评委老师在众目睽睽之下点开了那封神秘的邮件。

天啊，奇迹发生了，邮件里的内容和大屏幕上展示给观众的文字一模一样、分毫不差！

瞬间，台下爆发出热烈的掌声，久久不息！



有人瞠目结舌，有人呆若木鸡。

难道魔术师真有未卜先知的能力？

不可能。

但是上台来的观众都是随机选取，根本不存在全是托儿的可能！

要么托儿是评委老师，使用的手机遥遥领先，高科技无人驾驶？

也不可能。

纸条是随机发放的，选取也是随机的，众目睽睽之下想要这么精准地作弊，这完全是做不到的。



魔术师究竟是怎样做到那种效果的呢？

后来我研究了一下，原来这可能是利用了邮件 `SMTP` 协议的漏洞，通过发送过去时间的邮件来达到效果。

简单地说就是当你刚刚收到一封新邮件时，却发现这封邮件的时间居然不是现在当前的，而是过去时间的，比如是一个小时之前的。

那具体是怎么回事呢？

怎么发送这个所谓的过去时间的邮件呢？



为了说得再明白一些，我再举一个例子。

某双一流高校某网红系某天坑专业大三学生梅某，于9月7日收到老师发来的邮件，要求在三日内完成作业并以回复邮件的方式提交。

可是梅某大小是个网红，由于忘情于直播，并没有及时看到这封邮件。

直到9月11日凌晨2点60才看到邮件，此时已是三天之后，完美错过了提交作业的最后期限。

虽然作业已经找人搞定，但是此时的他希望老天开眼能穿越回去，只求回到前一天将邮件发送了事。

可这在早已破除封建迷信崇尚科幻的新时代是完全不可思议，也是不可能做到的。

谁能料到他冥思苦想居然心生一计，利用系统漏洞把邮件给发了。

而在老师看来，邮件的确是在期限之内收到的，并没有逾期。



众所周知，我们可以通过定时的方式来发送未来时间的邮件，比如预定明天上午8点发送邮件。

但是这种发送过去时间邮件的方法似乎并不那么容易实现。

话虽如此，但这也并不是说一点也不可能实现，偏偏 `SMTP` 邮件发送协议中就有这么一些漏洞仍然有效，其中就有这个接收时间漏洞，是可以人为修改的。

当然了，需要事先声明的是，协议漏洞只是早期设计时不完善造成的，随着后来各种技术手段的强化使用，这些所谓的漏洞多多少少也就失去了利用的可能。

不过话又说回来，我们现在提到的邮件接收时间，其实仍然是可以利用的。

但请注意，即便如此现在的各大邮件系统也会识别这种修改，一旦发现时间是过去时间会自动纠正，或者导致邮件发送失效。



那么这个传说中的修改发送时间的漏洞现在到底灵不灵呢？

我动手自制了一个小程序（文末下载），并做了一些测试实验。

图01



图中所示是正式版程序，可以任意填写邮件主题、正文，以及添加附件。

当然最主要的还是修改时间，然后就可以发送邮件了。

这里需要多说一句，这个时间设定没有限制，自然也可以包括未来时间。

只不过这个未来时间是即时发送即时接收，并不是指预定时间发送哦！



其实我事先做的是一个测试版程序，文末可下载。

与正式版的区别是，测试版不能自定义主题和正文，当然也没有附件功能。

测试版程序可发送过去一个小时的邮件。

图02



我们来测试一下吧！

填写好邮件服务器、帐号密码等信息（可参看以前文章或咨询邮件供应商），点击发送邮件，OK！

图03



登录到QQ邮箱，可以看到收到了一封新邮件。

这封新邮件是刚刚收到的，但是它显示的接收时间却是一个小时之前。

图04



打开封邮件，与当前时间做个对比吧！

下午2点14分，这封邮件是下午1点11分收到的，的确是一个小时之前啊，哈哈！

图05



有几个注意点希望小伙伴们能够了解，也是我研究了一番的心得。

正如前面所说，虽然是早期的漏洞，但是毕竟时间这么久了，系统更新迭代N次也早已将漏洞堵住了。

所以说从某种程度上漏洞的利用还得看运气。

比如网易 `163` 、 `126` 之类的邮箱系统，在前几年还可以利用一下这类漏洞，但是现在不太行了。

所谓的不太行，指的是你不能发送超过当天的过去时间，就是你不能发送前一天甚至更早时间的邮件。

不过吧根据我实际的测试结果来看，当天24小时之内还是可以实现的。

比如某天晚上，你猛然发现今天上午9点就应该给老板发送的邮件因为刷某音太投入给忘了。

别急着跺脚摔手机，我可以保证你下次还会犯病，放心哈，只要没到第二天，当天的还能给救回来！

除网易之外，像QQ邮箱等倒是没有这个识别屏蔽功能，可以放心大胆的利用，像我测试发现可以发送几个月甚至1年之前都是没问题的。



另外还有一个小问题，这个过去时间只是修改了邮件头中的接收时间，其实邮件真正的接收时间只能是以接收邮件的服务器时间为准。

事实上邮件的真实接收时间并没有被修改，因此有时邮件看上会很奇怪，比如预览状态下。

由此我们可以得出一个结论，建议尽量少用可以预览的邮件系统，哈哈！

图06



**网管小贾的发送过去时间邮件小工具安装包测试版.7z(2.96M)**

下载链接：https://pan.baidu.com/s/1Y3Y5qiRoA-NR3M-ynIo1qg

提取码：0a29



在节目的最后，提供给小伙伴们测试版程序，可以学习研究一下，仅供娱乐，作者可不承担使用后的责任哦。

如果真的要实现发送过去时间邮件的话，还请各位务必要保证在合情合理合法合规的前提下进行哦！

好了，难得这几天放假休息，在此祝小伙伴们节日快乐，吃好喝好，玩得尽兴！



**将技术融入生活，打造有趣之故事**

网管小贾 / sysadm.cc









