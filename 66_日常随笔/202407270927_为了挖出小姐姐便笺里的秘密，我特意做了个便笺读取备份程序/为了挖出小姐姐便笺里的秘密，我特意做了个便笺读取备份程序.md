为了挖出小姐姐便笺里的秘密，我特意做了个便笺读取备份程序

副标题：为了挖出小姐姐便笺里的秘密，我特意做了个便笺读取备份程序

英文：in-order-to-uncover-the-secrets-in-sticky-notes-I-specially-created-a-sticky-notes-reading-backup-program

关键字：sticky notes,便笺,便签,微软便笺



书接前文。

前两天，新来的关系户小姐姐找我问诊，解决了关于微软便笺程序打不开的问题。

当时我也是折腾了好一会儿才搞定的，全部过程都写在了前一篇文章中。



之后的一段日子里，我总是能听到别人说起这位小姐姐的一些流言蜚语。

什么跟老板表面是远房亲戚，其实有那种关系，什么也不和别人说话，感觉就像个怪人……。

再加上那天，便笺打不开，她显得非常焦躁，说里面有重要的机密信息。

现在想来，这多少引起了我的好奇。



我心想，这便笺里能有什么鬼机密信息。

银行卡密码？

像我这种月薪不到3万，卡里还能剩3千的，银行卡密码告诉你是666666我也不在乎！

你看我多坦诚的一个人啊！

但凡重要的东西，要么就记在文档里，要么就存在手机中，怎么会写在便笺里呢？

便笺又没加密功能，随便谁都能看见，能机密到哪去！

嗯，看样子是她说漏了嘴，难道说有什么见不得光的事？



我正胡思乱想，范大嘴把他那大猪脑袋贴了过来，把我吓了一跳。

俗话说相由心生，这家伙一脸皮笑肉不笑地说道：“哎，你怎么了？我看你两眼无神，还淌着个大鼻涕，是不是想啥可遇而不可求的美事呢？”

我抹了把鼻子，一脸嫌弃回敬道：“我说范哥，公司里都说您是江湖百晓生，人送绰号万事通，您倒给说道说道，这新来的小姐姐，老是一惊一乍的，她到底能有啥机密？”

范大嘴一听问这事，顿时来了劲头，冲我挤眉弄眼，四下里还看了看，完事直往我这儿凑合。

“嘿，你可问着人了。我说啊，你可别不信！”

“我猜啊，这小姐姐肯定是个没家没口的，就这两天，她天天下班第一个走人，跑得比谁都快！”

“后来你猜怎么着？我回家路上瞅着好几回，她都没往她家走，而是往那个反方向，感觉都是往那个万达那边去！”

“按理说这也够奇怪的了，问题是每次我看见的时候，碰巧老板也是往那边走，你就说说，这里边到底有没有猫腻！”

范大嘴说完了，还不忘朝两边瞅一眼，一副故作神秘的样子。



“哦哦，原来如此！是有点奇怪哈！”

没想到我也成了吃瓜群众。

大家都知道，我是个本分的老实人，靠技术吃饭，一般情况下我不是那样爱八卦的人啊，可恶的范大嘴！



又聊了几句，范大嘴走了，我立马打开电脑，查起了资料。

经过一番查找，我大概了解了关于微软便笺的一些技术信息。



便笺要保存文字内容，那肯定得有个地方，通常便笺数据保存在以下路径的数据库文件 `plum.sqlite` 中。

```
%UserProfile%\AppData\Local\Packages\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\LocalState\plum.sqlite
```



前面这个 `%UserProfile%` 是个环境变量，是指用户配置文件的意思，你可以简单地理解为用户配置的所在路径。

比如，如果你的用户名是 `老六` ，那么便笺的数据应该是保存在这儿。

```
C:\Users\老六\AppData\Local\Packages\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\LocalState\plum.sqlite
```

图01



一看 `plum.sqlite` 这个文件名字就知道，是个 `SQLite` 数据库。

随便找个可以打开 `SQLite` 数据库的程序，比如我用的是 `SQLITE Expert` 。

可以看到其中一个叫 `Note` 的表中，有我们写的便笺数据。

图02



对照实际便笺内容，没错了！

图03



不过直接查看数据库文件，除了我们需要的内容外，里面还会有很多乱七八糟的字符，这些是我们不需要的。

因此干脆自制了一款简易查看备份程序。

（文末有下载）

图04



用法很简单，先点击“加载便笺数据”。

然后在“便笺ID号”列表中选择便笺，左侧即可显示“便笺内容”。



因为程序需要读取 `SQLite` 数据组件支持，程序开启时会自动注册扩展组件。

所以启动程序时会出现警告提示，我们直接让其允许运行即可。

图05

图06



如果便笺程序打不开了，或者不方便打开，那么我们使用这个工具程序也是可以查看到便笺里面的内容的，非常方便，也可以用来紧急备份便笺内容。

经过反复测试，确认没有问题了，我就把工具程序拷贝到了U盘里。

过了两天终于让我等来了机会……



小姐姐又在吵吵，埋怨电脑又不好使了。

还没等她喊我，我“滋溜”一下，自动出现在了她的面前。

面对我那像雪山一般纯净的笑容，她可能没想到会有这么一出，先是一愣，后是有点尴尬的说：“电……电脑，有点……卡……”

“得嘞！瞧我的……请好吧您嘞！”

我一把拉过旁边的椅子占了C位。

用了百米跨栏12秒98的速度将便笺数据库文件拷了出来，然后重启电脑，搞定！



小姐姐用了一下电脑，感觉是比之前快了很多，真夸我本领高强，要给我长按点赞。

我心说话，我的本事还没曾使出来呢！

随后我客气了几句，退回到了工位。

一刻也没耽误，我瞅旁边没人，立马将刚才拷出来的便笺数据库用自制程序打开了。

结果这么一瞧，我就愣住了……

>周一：18:05 ~ 21:10 神秘学初级入门 （二楼左手第三个门）
>周二：17:40 ~ 20:30 魔法理论与实践 （四楼右手第六个门）
>周三：18:18 ~ 21:18 平行空间七日通 （五楼左侧楼梯下去两层右拐第三个门口）
>周四：17:50 ~ 19:19 超自然调查案例烹饪大全 （一楼杂物间旁入口）
>周五：18:20 ~ 22:22 60天紫微斗数全搞定 （三楼肯得机里面厕所旁入口）
>周六：19:28 ~ 23:59 手把手教你梦境解析与操控 （十八楼9988号房间，务必单独一人）
>周日：22:00 ~ 23:00 灵异专修汇编 （走员工通道上七楼1314号玻璃门）





**网管小贾的微软便笺备份程序**

下载链接：https://pan.baidu.com/s/19SGK4xcD2rpTrGPcZN3TRg

提取码：6jvy





**将技术融入生活，打造有趣之故事**

网管小贾 / sysadm.cc