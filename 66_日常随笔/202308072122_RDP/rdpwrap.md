rdpwrap

副标题：

英文：

关键字：





就在前几天面试的时候，公司负责招聘的经理一下子就相中了我，来来回回问我三遍能不能尽快来上班。

当时吧我寻思着这工资也不高啊，就有点犯犹豫。

招聘经理一眼就瞧出来了，连忙跟我说老板这两天去海南旅游了，过几天等他回来就立马帮我申请加工资，并且还承诺后面等招了新人让我当个小领导。

我转念一想这两年形势不咋地，一狠心只好先委曲求全答应留下来。



招聘经理喜上眉梢当场乐开了花，说是最近公司人手不够，他还要上外面招聘，让我明天开始在公司当班一周。

我是愉快地答应了，可是怎么每天早上我都是第一个来公司！

呸！什么上市大公司，世界508强，我就有点不爽。

还好工作不忙，没啥事做，行吧，既来之则安之，我先管好自己吧！



某天一早照常上班来，习惯性地打开电脑，泡上热茶，二郎腿一翘，小曲一哼……

电脑屏幕上的文字不断地滚动，我正看得爽处，忽然门一推，进来三个人。

我甩脸观瞧，进在头前的是个白净脸的中年人，40左右岁，普通身材，戴副眼镜，留着两撇小黑胡。

紧跟在后头的一个红脸、一个黑脸。

只见那红脸汉一双大豹子眼，高鼻梁、方开口，面如重枣，不怒自威，个头至少一米八。

一旁的黑脸汉一张大圆脸，立剑眉、大环眼，满脸的胡碴子，身高没一米九也有一米八八，膀大腰圆，一看就是猛人。



这怎么个茬，你们是谁啊，谁让你们进来的？

我是这么想的，可还没等我喊出来，那个黑脸汉上前一个箭步将我按在。

“妈呀”一声，我嘴里的苏打饼干掉了出来碎了一地。



“喂！你们曹老板人呢？！”白脸汉两手按在桌面上，瞪着两眼直勾勾地盯着我，看得我寒毛直竖。

“快说！要不俺对你不客气了！”黑脸汉一旁攥紧我的胳膊。



怎么个意思，跟我这儿演黑涩会哪？！

我是吓大的吗？

这是有砖有瓦有尺寸有王法的地方，我堂堂大男子汉能让你们这帮肖小给唬住吗？！

想到这儿，我猛然挣脱黑脸汉，当场给跪了！

“几位好汉爷，怎么得空上我这儿来串门？您老几位是打尖啊还是住店，不不，是有什么公干吗？”



红脸汉瞥了一眼电脑屏幕，“哼”了一声：“什么年代了还看网文小说，你们老板都跑路了，还有闲心在这儿摸鱼！”

看我一脸蒙逼，白脸汉义正辞严道：“我们是下属分公司的，公司欠了我们三个月的工钱，到现在还没给，所以上这儿来找曹大老板碰碰运气！”

“就在昨天，我们听说曹大老板跑路了！你可知情？”



这时我才注意到，他们的确穿着公司统一的工作服，上面还绣着名字。

我定睛一看，白脸的叫刘贝，红脸的叫关逾，黑脸的叫张辉，好么，刘关张哥仨到齐！

我只好苦苦哀求：“皇叔……不不……小人实在是不知情啊，我也是刚来没几天……”



“呔！你小子的嘴，骗人的鬼！跑路关门，事实俱在，还敢巧言令色，替姓曹的辩解！我看你是……”

黑脸汉将蒲扇大的巴掌高高举起，还没等它落下，我“腾”地一下自个站起来了！

给这哥们吓一跳，我一把拉住白脸汉，“啥都甭说了！三位大哥，我也是受害者啊！”

我一把鼻涕一把眼泪：“我也是被骗来的，才来一个礼拜，他们答应我加工资，还说招了新人让我当领导！”

“啊呸！三位大哥，你们发个话，要让我怎么帮你们？”



那白脸汉往旁边闪了闪身，估计是让我的吐沫星子给贱着了，也许对我这180度大转弯的态度表示怀疑。

他眼珠一转，问道：“姓曹的办公室在哪儿？我们要查查他的电脑！里面肯定有什么猫腻！”

“对……对……我们要查查……”后面两位也跟着来劲儿。



我一咧嘴：“这……老板办公室都上了锁了，恐怕是进不去啊！”

在确认老板办公室的门的确打不开后，这哥仨又开始对我新一轮的“刑讯逼供”。

左右一边一人架着我，另一人咯吱我，你说我从小到大蜜罐里长大的哪受过这种罪啊！

最后泪一流、心一横，又给跪了……



我偷偷告诉这仨人，这个曹老板有个习惯，喜欢用台式电脑大屏幕，且常年不关机，为的是看某某曲线图，就这么放在办公室。

兴许他临走前匆忙，电脑没来得及关也说不准，可以远程连接试试！



听完这番话，三个人紧锁的眉头略微舒展了一些：“你小子特么也是学计算机的？”

我愣愣地点了点头，红脸的一拍大腿默默流泪，“嘿！我们哥几个都是学计算机的，原以为有大好前程，如今却沦落得……”

白脸垂下头，摆了摆手示意他的兄弟不要再说下去。

转过脸来冲我说道：“你，赶紧给连上去看看！”



我哪敢怠慢啊，这三个没一个是好惹的，于是我立马把小说给关了，打开了远程桌面程序。

`IP` 地址没错，`Ping` 也OK（电脑的确开着），结果连接却失败了！

图z01



顿时我这汗就下来了，心想不能吧！

结果我猛地一拍脑袋想起来了，老板的系统是家庭版的Windows，这家庭版的系统它就没有远程连接的功能啊！

“你小子不是学计算机的嘛，赶紧想办法啊！快点！”

哎哟，这可要了命了！



就在这千钧一发之际，我灵光一现，记起了之前曾经有这么一个程序，是可以开启多连接远程桌面的。

什么意思呢？

就是说，如果是家庭版系统，用它可以开启远程桌面，如果已经开启远程桌面的系统，用它可以增加连接数（默认只有2个连接）。



经我这么一说，白脸提醒黑脸，去把哥几个放车上的笔记本电脑都拿过来，一会儿大伙一块儿找效率高。

我仗着胆子半开玩笑，说你们开着车来的啊？

红脸指了指放在一旁桌上的头盔，意思是哥几个都快沦落到黄袍加身了！



我见气氛有所缓和，于是将珍藏已久的 `RDPWrap` 程序找了出来，边操作边向他们解说……



===================注意！这部分删除

项目地址：

> https://github.com/stascorp/rdpwrap

> https://github.com/stascorp/rdpwrap/issues

===================



首先，我们要想办法将 `RDPWrap` 安装到对方的电脑上。

（当然我是有方法远程安装的，不过这部分内容不方便说，所以在此省略一万字，请理解。）

本地安装方法非常简单，将安装包下载后解压，然后再使用 `RDPWinst.exe` 来安装。



安装包包含以下几个文件：

* `install.bat` - 快速安装批处理程序
* `RDPCheck.exe` - 本地 `RDP` 检查器（检查 `RDP` 是否工作正常）
* `RDPConf.exe` - `RDP` 封装配置程序
* `RDPWinst.exe` - `RDP` 封装库安装或卸载程序
* `uninstall.bat` - 快速卸载批处理程序
* `update.bat` - 快速升级批处理程序

图z02



一般情况下，你只要双击 `install.bat` 即可开始安装。

如果你是个熟练工，那么直接用 `RDPWinst.exe` 也可以完成同样的工作。

安装时大概是这个样子的。

图b01



安装完成后又是这个样子。

图b02



如果是用 `update.bat` 来安装，那么它会自动在线检查新版本，然后再安装之。

图b03



安装之后程序放在哪儿了呢？

它在这儿，并且只有两个文件，你说简单不简单！

```
C:\Program Files\RDP Wrapper
 |___ rdpwrap.dll
 |___ rdpwrap.ini
```



有的小伙伴会说了，这也没有 `exe` 文件啊，可怎么玩呢？

其实它不用 `exe` 文件的，它是基于 `Windows` 产品策略编辑器带来的灵感实现的。

它是建立在调用原始的未修改的 ` termsrv.dll ` 文件基础之上的，因此在使用它之前你要先确保这个 `termsrv.dll ` 文件是纯天然无污染的哦！



OK，我们找到配置程序 `RDPConf.exe` ，打开它看看有什么设定。

图c04



左上角分别是 `RDPWrapper` 是否安装，服务状态是否正常，侦听状态是否正常。

右上角是 `RDPWrapper` 的版本号和当前 `Windows` 系统的版本号，以及是否完全支持当前系统。

左下角的 `Enable Remote Desktop` 当然是要开启了，端口号可以用默认的 `3389` ，也可以自定义了，看你喜欢哪个数字了。

其他的基本保持默认即可，除非你比较专业，建议不要轻易去动它。



好了，安装及配置就这样轻松搞定了，接下来我们玩一把连连看！

打开远程桌面，输入对方的 `IP` 地址，点击连接吧！

图c01



通常我们会看到这样一个警告提示，不用管它，点击 `是(Y)` 继续连接。

图c02



一口气连接了三个，虽然是在同一台电脑上连接，但其实也可以在三个不同电脑上这么干。

图c03



这时有人会质疑，我只看到你出现了三个窗口，但是没有登录成功不作数！

好吧，那我就挨个登录一遍吧！

好好瞧瞧，至少 `Windows 10` 和 `Windows 11` 上都能登录成功，而且不管是家庭版还是专业版还是什么版，统统都在碗里来。

图c05



说实话，当时我太紧张了，没和他们说这个 `RDPWrapper` 现在早已失灵了，其实我用的是在此基础上的升级版程序。

像这个样子，**文末有下载**。

安装方法与之前的类似，不过默认服务未启动状态，需要确认启动服务。

图d01



服务启动后，一切就都OK了！

图d02



从 `termsrv` 的版本号可以看出，`Windows 10` 是完全支持的。

如下 `Windows 11` 也是完美支持的，没有任何问题。

图d03



除此之外，我们还可以看到升级版程序还能选择不同的显示分辨率。

当然这个升级版程序最最最关键的就是它对绝大多数版本的 `Windows` 是完全支持的。

而最开始提到的 `RDPWrapper` 实际上是要你自己找到相应版本的配置文件才能做到完全支持，非常麻烦，兼容性很差，几乎没法使用。



前面我们看到，多个远程连接已经登录成功，那么这是真的吗？

不信的话，我们可以打开任务管理器，几个登录的用户名就是铁证。

图e01



如果用户离线，也能从这儿看到。

图e02



如再次登录的话，还可以看到上次断开前的会话。

图e05



因此，优雅的做法应该是注销退出，而不是简单粗暴点叉叉。

图e04



还有一种注销用户的办法，就是直接在任务管理器里这么干。

图e03



**RDPWrap**

下载链接：





经过一顿骚操作，这哥几个的电脑都成功连接到了曹老板的电脑上，于是开始找起了账本资料。

不一会儿，黑脸哥一脸兴奋地叫唤了一声，引得众人围观。

白脸哥瞅了一眼，推了一脑袋黑脸哥，“特么都啥时候了，还有这闲心看动作版！麻溜的！”

我差点笑出声，黑脸哥瞬间收了一脸坏笑，还好一张黑脸，要不那大脸蛋上爬满的黑线令人尴尬。

又过了一盏茶的功夫，红脸哥喊了一嗓子：“有了！”





**将技术融入生活，打造有趣之故事**

网管小贾 / sysadm.cc