rdpwrap

副标题：

英文：

关键字：





曹操集结十八路诸侯反董卓。

可是董卓有上将吕布，勇冠三军、无人能敌！



虎牢关北临黄河，地势险峻，自古以来都是一夫当关万夫莫开的重要关隘！

关羽、张飞骁勇善战，打仗的一把好手。

小刀拉屁股——开了眼了！





最近很开心，老板给加了工资，还承诺等招了新人让我当领导。

这两天老板不在公司，真是逍遥自在啊！



我正做着美梦呢，忽然进来三个人。

进在头前的是个白净脸的中年人，戴副眼镜，留着两撇小黑胡。

紧跟在后头的一个红脸、一个黑脸。

红脸的一双大豹子眼，高鼻梁、方开口，面色不怒自威，个头至少一米八。

黑脸的大圆盘、立剑眉大环眼，满脸的胡碴子，身高九尺，膀大腰圆。



这怎么个茬，谁让他们进来的？

还没等我喊出来，那个黑脸的上前一步一把将我按在座位上。

“妈呀”一声，我嘴里的小甜饼掉了出来碎了一地。



“你们曹老板人呢？！”白脸瞪着两眼直勾勾地看着我。

“快说！要不俺对你不客气！”黑脸攥紧我的胳肢用力按了按。



怎么，跟我这儿演黑涩会哪？！

我是吓大的吗？

这是有砖有瓦有尺寸有王法的地方，我堂堂大男子汉能让你们给唬住吗？！

我想到这儿，猛得挣脱黑脸当场给跪了！

“几位好汉爷，怎么有空上我这儿来串门，您老几位是打尖啊还是住店，不不，是有什么事吗？”



红脸瞥了一眼我的电脑屏幕，“哼”了一声：“什么年代了还看网文小说，你们老板都跑路了，你还有闲心在这儿摸鱼！”

看我一脸难以置信，白脸严肃地说道：“我们是下属分公司的三个工人，公司欠了我们三个月的工钱，到现在还没给，所以上这儿来找曹大老板碰碰运气！”

“就在昨天，我们听说曹大老板跑路了！你可知情？”



这时我才注意到，他们的确穿着公司统一的工作服，上面还绣着名字。

我仔细一看，好家伙，白脸的叫刘贝，红脸的叫关逾，黑脸的叫张辉，刘关张哥仨到齐！

你看看，哪个都不好惹啊！

我只好哀求道：“皇叔、二爷三爷，小人实在是不知情啊，老板临走前只说是去海南旅游，过几天就回来……”





哎？也是啊，这办公室里什么时候只剩我一个人了？

哎哟，我上了当了！

当时我那汗就下来了，这下可真是吃了暴亏了！



“呔！你小子的嘴，骗人的鬼！跑路关门，事实俱在，还敢巧言令色，替姓曹的辩解！我看你是……”

黑脸的将蒲扇大的巴掌高高兴起，还没等它落下，我“刷”地一下自个站起来了！

给这哥们吓一跳，“啥都甭说了！三位大哥，我也是受害者啊！”

我一把鼻涕一把眼泪：“我也是被骗来的，才来两个礼拜，姓曹的答应我招了新人给我加工资，还让我当领导！”

“啊呸！三位大哥，你们说吧，要让我怎么帮你们？”



那白脸的往旁边闪了闪身，也许是怕我的吐沫星子贱着，也许对我这180度大转弯的态度表示怀疑。

他眼珠转了转，说道：“姓曹的办公室在哪儿？我们要查查他的电脑！里面肯定有什么猫腻！”

“对……对……我们要查账本……”后面两位也跟着来劲儿。



我一咧嘴：“这……老板临走前，办公室都上了锁了，恐怕是进不去啊！”

在确认老板办公室的门的确打不开后，这哥仨又开始对我新一轮的“刑讯逼供”。

左右一人一边拽着我胳膊，一人咯吱我，你说我从小到大哪受过这种酷刑啊！

最后心一横，又给跪了。



我告诉这三人，这个曹老板有个习惯，他喜欢用台式电脑大屏幕，并且常年不关机，估计是为了看某某曲线图，就这么放在办公室。

兴许他临走前匆忙，忘记关电脑了也说不准，可以远程连接试试！



听完我这一番话，三个人紧锁的眉头略微舒展了一些，不过却带着几分疑惑的表情。

“你小子也是学计算机的？”

我愣愣地点了点头，红脸的一拍大腿默默流泪，“嘿！我们哥几个都是学计算机的，原以为有大好前程，如今却沦落得……”

白脸垂下头，摆了摆手示意他的兄弟不要再说下去。

转过脸来冲我说道：“赶紧给我连上去看看！”



我哪敢怠慢啊，这三个没一个是好惹的，于是我立马把小说给关了，打开了远程桌面程序。

`IP` 地址没错，`Ping` 也OK（电脑的确开着），结果连接却失败了！

图z01



顿时我这汗就下来了，心想不能吧！

结果我猛地一拍脑袋想起来了，老板的系统是家庭版的Windows，这家庭版的系统它就没有远程连接的功能啊！

“你小子不是学计算机的嘛，赶紧想办法啊！快点！”

哎哟，这可要了命了！



就在这千钧一发之际，我灵光一现，记起了之前曾经有这么一个程序，是可以开启多连接远程桌面的。

什么意思呢？

就是说，如果是家庭版系统，用它可以开启远程桌面，如果已经开启远程桌面的系统，用它可以增加连接数（默认只有2个连接）。



经我这么一说，白脸提醒黑脸，去把哥几个放车上的笔记本电脑都拿过来，一会儿大伙一块儿找效率高。

我仗着胆子半开玩笑，说你们开着车来的啊？

红脸指了指放在一旁桌上的头盔，意思是哥几个都快沦落到黄袍加身了！



我见气氛有所缓和，于是将珍藏已久的 `RDPWrap` 程序找了出来，边操作边向他们解说……



===================注意！这部分删除

项目地址：

> https://github.com/stascorp/rdpwrap

> https://github.com/stascorp/rdpwrap/issues

===================



首先，我们要想办法将 `RDPWrap` 安装到对方的电脑上。

（当然我是有方法远程安装的，不过这部分内容不方便说，所以在此省略一万字，请理解。）

本地安装方法非常简单，将安装包下载后解压，然后再使用 `RDPWinst.exe` 来安装。



安装包包含以下几个文件：

* `install.bat` - 快速安装批处理程序
* `RDPCheck.exe` - 本地 `RDP` 检查器（检查 `RDP` 是否工作正常）
* `RDPConf.exe` - `RDP` 封装配置程序
* `RDPWinst.exe` - `RDP` 封装库安装或卸载程序
* `uninstall.bat` - 快速卸载批处理程序
* `update.bat` - 快速升级批处理程序

图z02



一般情况下，你只要双击 `install.bat` 即可开始安装。

如果你是个熟练工，那么直接用 `RDPWinst.exe` 也可以完成同样的工作。

安装时大概是这个样子的。

图b01



安装完成后又是这个样子。

图b02



如果是用 `update.bat` 来安装，那么它会自动在线检查新版本，然后再安装之。

图b03



安装之后程序放在哪儿了呢？

它在这儿，并且只有两个文件，你说简单不简单！

```
C:\Program Files\RDP Wrapper
 |___ rdpwrap.dll
 |___ rdpwrap.ini
```



有的小伙伴会说了，这也没有 `exe` 文件啊，可怎么玩呢？

其实它不用 `exe` 文件的，它是基于 `Windows` 产品策略编辑器带来的灵感实现的。

它是建立在调用原始的未修改的 ` termsrv.dll ` 文件基础之上的，因此在使用它之前你要先确保这个 `termsrv.dll ` 文件是纯天然无污染的哦！



OK，我们找到配置程序 `RDPConf.exe` ，打开它看看有什么设定。

图c04



左上角分别是 `RDPWrapper` 是否安装，服务状态是否正常，侦听状态是否正常。

右上角是 `RDPWrapper` 的版本号和当前 `Windows` 系统的版本号，以及是否完全支持当前系统。

左下角的 `Enable Remote Desktop` 当然是要开启了，端口号可以用默认的 `3389` ，也可以自定义了，看你喜欢哪个数字了。

其他的基本保持默认即可，除非你比较专业，建议不要轻易去动它。



好了，安装及配置就这样轻松搞定了，接下来我们玩一把连连看！

打开远程桌面，输入对方的 `IP` 地址，点击连接吧！

图c01



通常我们会看到这样一个警告提示，不用管它，点击 `是(Y)` 继续连接。

图c02



一口气连接了三个，虽然是在同一台电脑上连接，但其实也可以在三个不同电脑上这么干。

图c03



这时有人会质疑，我只看到你出现了三个窗口，但是没有登录成功不作数！

好吧，那我就挨个登录一遍吧！

好好瞧瞧，至少 `Windows 10` 和 `Windows 11` 上都能登录成功，而且不管是家庭版还是专业版还是什么版，统统都在碗里来。

图c05



说实话，当时我太紧张了，没和他们说这个 `RDPWrapper` 现在早已失灵了，其实我用的是在此基础上的升级版程序。

像这个样子，**文末有下载**。

安装方法与之前的类似，不过默认服务未启动状态，需要确认启动服务。

图d01



服务启动后，一切就都OK了！

图d02



从 `termsrv` 的版本号可以看出，`Windows 10` 是完全支持的。

如下 `Windows 11` 也是完美支持的，没有任何问题。

图d03



除此之外，我们还可以看到升级版程序还能选择不同的显示分辨率。

当然这个升级版程序最最最关键的就是它对绝大多数版本的 `Windows` 是完全支持的。

而最开始提到的 `RDPWrapper` 实际上是要你自己找到相应版本的配置文件才能做到完全支持，非常麻烦，兼容性很差，几乎没法使用。



前面我们看到，多个远程连接已经登录成功，那么这是真的吗？

不信的话，我们可以打开任务管理器，几个登录的用户名就是铁证。

图e01



如果用户离线，也能从这儿看到。

图e02



如再次登录的话，还可以看到上次断开前的会话。

图e05



因此，优雅的做法应该是注销退出，而不是简单粗暴点叉叉。

图e04



还有一种注销用户的办法，就是直接在任务管理器里这么干。

图e03



**RDPWrap**

下载链接：





经过一顿骚操作，这哥几个的电脑都成功连接到了曹老板的电脑上，于是开始找起了账本资料。

不一会儿，黑脸哥一脸兴奋地叫唤了一声，引得众人围观。

白脸哥瞅了一眼，推了一脑袋黑脸哥，“特么都啥时候了，还有这闲心看动作版！麻溜的！”

我差点笑出声，黑脸哥瞬间收了一脸坏笑，还好一张黑脸，要不那大脸蛋上爬满的黑线令人尴尬。

又过了一盏茶的功夫，红脸哥喊了一嗓子：“有了！”





**将技术融入生活，打造有趣之故事**

网管小贾 / sysadm.cc