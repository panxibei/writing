便笺备份

副标题：

英文：

关键字：



书接前文。

前两天，关系户小姐姐找我问诊，解决关于微软便笺程序打不开的问题。

当时我也是折腾了一会儿才搞定的，折腾过程写在了前一篇文章中。



之后我总是听别人说起新来这位小姐姐的风言风语。

什么跟老板有那种关系啊，什么是老板的远房亲戚之类的。

再加上那天，便笺打不开，她很焦躁地说里面有机密信息，就引起了我的好奇心。



我心想，这便笺里能有什么机密信息。

但凡重要的东西，要么就记在文档里，或是手机中，怎么会写在便笺里呢？

便笺又没加密功能。

看样子是她说漏了嘴，难道说有什么见不得光的事？



我正胡思乱想着，范大嘴把他那猪头大脸贴了过来，着实把我吓了一跳。

这家伙不怀好意，皮笑肉不笑地说道：“哎，我看你两眼无神，是不是想什么可遇而不可求的美事呢？”

我一脸嫌弃：“我说范哥，都说您是江湖百晓生，人送绰号万事通，您给说道说道，这新来的小姐姐，她到底有啥机密？”

范大嘴一听问这事，顿时来了劲头，直往我这儿凑合。

“嘿嘿，我说啊，你可别不信！”

“这两天，她天天第一个下班走人，跑得比谁都快！”

“后来你猜怎么着？我回家路上瞅着好几回，她都没往她家走，而是往那个反方向，感觉都是往那个万达那边去！”

“按理说这也没啥是吧，不过每次我看见的时候，老板也是往那边走，你就说说，这里边到底有没有猫腻！”

范大嘴说完了，还不忘往两边瞅一眼，一副故作神秘的样子。



“哦哦，原来如此！”

没想到我也成了吃瓜群众。

大家都知道，我是个本分的老实人，靠技术吃饭，一般情况下我不是那样爱八卦的人啊，可恶的范大嘴！



之后等范大嘴走了，我立马打开电脑，查起了资料。

经过一番查找，我大概了解了关于微软便笺的一些技术信息。



便笺要保存文字内容，那肯定得有个地方，通常便笺数据保存在以下路径的数据库文件 `plum.sqlite` 中。

```
%UserProfile%\AppData\Local\Packages\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\LocalState\plum.sqlite
```



前面这个 `%UserProfile%` 是个环境变量，是指用户配置文件的意思，你可以简单地理解为用户配置的所在路径。

比如，如果你的用户名是 `老六` ，那么便笺的数据应该是保存在这儿。

```
C:\Users\老六\AppData\Local\Packages\Microsoft.MicrosoftStickyNotes_8wekyb3d8bbwe\LocalState\plum.sqlite
```

图b03



一看 `plum.sqlite` 这个文件名字就知道，是个 `SQLite` 数据库。

随便找个可以打开 `SQLite` 数据库的程序，比如我用的是 `SQLITE Expert` 。

可以看到其中一个叫 `Note` 的表中，有我们写的便笺数据。

图b01



对照实际便笺内容，没错了！

图b02



不过直接查看数据库文件，除了我们需要的内容外，里面还会有很多乱七八糟的字符，这些是我们不需要的。

因此干脆自制了一款简易查看备份程序。

图b04



用法很简单，先点击“加载便笺数据”。

然后在“便笺ID号”列表中选择便笺，左侧即可显示“便笺内容”。



因为程序需要读取 `SQLite` 数据组件支持，程序开启时会自动注册扩展组件。

所以启动程序时会出现警告提示，我们直接让其允许运行即可。

图c01

图c02



如果便笺程序打不开了，或者不方便打开，那么我们使用这个工具程序也是可以查看到便笺里面的内容的，非常方便，也可以用来紧急备份便笺内容。

经过反复测试，确认没有问题了，我就把工具程序拷贝到了U盘里。

过了两天终于让我等来了机会……



小姐姐又在吵吵，埋怨电脑又不好使了。

还没等她喊我，我“滋溜”一下，自动出现在了她的面前。

面对我那像雪山一般纯净的笑容，她先是一愣，后是有点尴尬的说：“电……电脑，有点……卡……”

“得嘞！瞧我的……请好吧您嘞！”

我一把拉过旁边的椅子占了C位。

用了百米12秒98的速度将便笺数据库文件拷了出来，然后重启电脑，搞定！



小姐姐用了一下电脑，感觉是比之前快了很多，说我本领强，要给我长按点赞。

我心说话，我的本领还没曾使出来呢！



我瞅旁边没人，就将刚才拷出来的便笺数据库用自制程序打开了。

结果这么一看，我就愣住了。

里面尽是些教培G告，什么暑期班、游泳班。