网页版的在线红白机游戏，怎么做到的？

副标题：网页版的在线红白机游戏，怎么做到的？

英文：how-to-make-an-online-fc-nes-game-system-of-the-web-version

关键字：fc,nes,game,jsnes,js,web,红白机,在线游戏,游戏,在线,online



我有一哥们“烧鸡”，大名白赞记。

光听名字就感觉挺大气是吧，其实和我一样就是个不起眼的普通90后。

虽说这小子年纪轻轻，人却比较怀旧，尤其痴迷红白机之类的复古游戏（当然我也喜欢）。

很奇怪的是到现在好像有两个月没见着这小子了，没成想前两天在菜市场门口给撞上了。

搁以前只要一打照面这小子铁定三句话不离游戏，不过这回好像有点不一样了。



我一瞅他购物袋里那一片绿油油就大概知道怎么回事了。

果不其然，这小子一上来就和我吐槽最近过得有多惨，然后又怀念上以前那小日子有多美。

以前划水摸鱼、带薪拉屎，想怎么玩就怎么玩，别提多得劲了，可如今日薄西山、今非昔比，好日子是一去不复返啊！

自从换了新东家，不但工作忙得脚后跟直打后脑勺，而且上下班通勤时间都比原先拉长了好多。

这小子一顿扒拉扒拉，直言少壮不努力，老大徒伤悲，这整得都没空玩游戏了。

我去，这小嘴儿巴巴的，我愣是插不上话！

得，江山易改，这本性难移啊，我一瞅这小子还这副德性，硬是把想劝慰的话又给咽了回去。



好么，接着听这小子闲聊扒拉，结果他告诉我，还好有时还能偷懒玩一会在线红白机游戏。

“只要打开浏览器就行，不用安装任何软件，随时随地方便非常。”

“哦，是么，还能这么玩？呵呵...”，我得配合尬笑一下，做出我非常好奇的样子接着听他吹。

我心想他说的这个在线红白机游戏我知道，就是通过 `Web` 网页呈现，并且可以和正常模拟器一样地玩游戏。

这个我是见过，没啥新鲜，瞧这小子眉飞色舞那得瑟样......



不知道是不是我当时的表情演技有点过劲儿，他顿了一下，冷不丁地问了我一句：“这玩意挺好挺方便，你有空也玩两把哈！只是不知道这玩意是啥原理，怎么给整出来的，挺牛叉滴！”

俗话说，言者无心，听者有意！

过后三言两语我打发了这小子，事后在回家的路上我就琢磨了，是哈，这玩意是怎么做到只要打开网页就能玩红白机游戏的呢？



### `JSNes`







`bfirsh` 项目地址：

```
https://github.com/bfirsh/jsnes
```



大神官网：

```
https://jsnes.org/
```

图b01

图b02

图b03

图b04









`nes-embed.html` 中有以下代码。

```js
<script>window.onload = function(){nes_load_url("nes-canvas", "InterglacticTransmissing.nes");}</script>
```

这行代码意思为在页面加载完成后再加载 `nes` 游戏到 `canvas` 。

可是代码似乎还是有缺陷，涉及到 `AJAX` 的异步提交，在使用 `window.onload` 时总是会失败。





按键



设定按键的代码如下：

```
function keyboard(callback, event){
	var player = 1;
	switch(event.keyCode){
		case 38: // UP
			callback(player, jsnes.Controller.BUTTON_UP); break;
		case 40: // Down
			callback(player, jsnes.Controller.BUTTON_DOWN); break;
		case 37: // Left
			callback(player, jsnes.Controller.BUTTON_LEFT); break;
		case 39: // Right
			callback(player, jsnes.Controller.BUTTON_RIGHT); break;
		case 65: // 'a' - qwerty, dvorak
		case 81: // 'q' - azerty
			callback(player, jsnes.Controller.BUTTON_A); break;
		case 83: // 's' - qwerty, azerty
		case 79: // 'o' - dvorak
			callback(player, jsnes.Controller.BUTTON_B); break;
		case 9: // Tab
			callback(player, jsnes.Controller.BUTTON_SELECT); break;
		case 13: // Return
			callback(player, jsnes.Controller.BUTTON_START); break;
		default: break;
	}
}
```

图a01



`case` 后面用于判断按键的数字是该按键的 `ASCII` 码，可以到官方查询。

```
https://www.ascii-code.com/
```

比如我们想将 `上` 、 `下` 、 `左` 、 `右` 设定为 `W` 、 `S` 、 `A` 、 `D` ，那么我们先找到这几个按键的 `ASCII` 码，分别是十进制的 `87` 、 `83` 、 `65` 、 `68` ，然后将它们写到代码中就可以了。



比如修正后的按键 `上` ，应该是这样写。

```
case 87: // UP
	callback(player, jsnes.Controller.BUTTON_UP); break;
```



类似的 `A` 和 `B` 按钮也是一样操作，找相应 `ASCII` 码并修改为你喜欢的按钮。





```
<iframe src="https://127.0.0.1/Joomla/wgxj/jsnes-bfirsh/nes-embed.html" width="720px" height="640px" frameborder="0" scrolling="no"> </iframe>
```





将它嵌入页面中。

```
<iframe src="https://127.0.0.1/Joomla/wgxj/jsnes/src/index.html" width="720px" height="820px" frameborder="0" scrolling="no"> </iframe>
```





`dafeiyu`

```
https://gitee.com/feiyu22/jsnes
```







### 写在最后

通过我自己的各种折腾测试，最后将凑合可用的程序给整理好打包，就放在这儿分享给小伙伴们吧！

声明：付费只针对文章内容，如果你看完了文章不想付费请出门左拐，无论付费与否，请尊重作者的辛苦劳动，谢谢支持！



* `jsnes-bfirsh.7z` - `bfirsh` 网管小贾修改版
* `jsnes-dafeiyu.7z` - `dafeiyu` 网管小贾修改版
* `jsnes-master-bfirsh.zip` - `bfirsh` 源码
* `jsnes-master-dafeiyu.zip` - `dafeiyu` 源码

下载链接：



需要向小伙伴们说一下，我打包的这些程序并非完美版本，仍然还有修改增加功能的余地，请有余力的小伙伴自行调整吧。

关于 `JsNes` 如果我的文章有什么错误，或者你有好的想法和建议，欢迎留言评论。

最后，请各位排好队，点赞、关注、分享转发。

对了，谁有葱借我点，刚菜场忘记买了，回家又要被骂了......





**将技术融入生活，打造有趣之故事。**

网管小贾 / sysadm.cc

