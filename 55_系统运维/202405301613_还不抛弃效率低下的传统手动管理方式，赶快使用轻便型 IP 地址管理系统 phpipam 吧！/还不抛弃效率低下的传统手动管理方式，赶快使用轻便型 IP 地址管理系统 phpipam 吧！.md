还不抛弃效率低下的传统手动管理方式，赶快使用轻便型 IP 地址管理系统 phpipam 吧！

副标题：还不抛弃效率低下的传统手动管理方式，赶快使用轻便型 IP 地址管理系统 phpipam 吧！

英文：abandoning-inefficient-traditional-manual-methods-and-quickly-use-the-light-modern-and-useful-ip-address-management-application-phpipam

关键字：phpipam,ip,php,pear,地址管理



前两天有个同行的兄弟，突然打电话，说是要请我吃饭。

我平时工作满负荷，还要抽空费劲没好处地码字，就想推辞。

没想到人家热情不减，说是最近多送了几单外卖有几个零花钱，另外是真心请教问题，所以才极力邀请。

哎，你看我这小说才刚看完两页，行吧，真是盛情难却啊……



让人破费，多不好意思啊，我多了个心问了一下，这才了解人家是想问关于网络IP地址管理的问题。

通常我们管理一个网络，需要建立一套账目。

其中最直接最简单的办法，就是按照网络中设备的IP地址为主键来管理。

因为在一个网络中，IP地址通常是提前规划好的，相对来说比较稳定，有利于我们分类、收集和整理基于不同IP的各种设备。

相信很多小伙伴在管理自家网络时，肯定会用 `Excel` 表格的方式，先将IP地址罗列出来，然后再据此记录下对应的设备信息。



如果网络规模比较小，涉及的设备信息不多，那么用个表格管理起来并不是件困难的事，挺方便。

但是我要说的就是这个但是，一旦网络规模大起来了，其中的设备信息更加复杂多样化了，那么自然是需要配备更高级的管理手段才行。

基于此，我找了一款可能有些小伙伴已经在用的 `IP` 地址管理系统：`phpipam` 。



这个 `phpipam` 没什么神秘的，就是基于 `IP` 地址来分门别类地管理我们网络和设备。

为了赴宴时不至于露怯，我特意提前整理了一些关于 `phpipam` 的相关使用方法和说明。



这个 `phpipam` 是基于 `php` 环境的一款 `web` 管理程序，自然需要在 `php` 运行环境。

还好 `php` 可以在 `Linux` 下运行，也可以在 `Windows` 下运行，可选度比较高。

我常用的是 `WAMPServer` ，其实用哪个 `php` 环境都可以。

至于 `php` 的版本要求，只要满足 `7.2` 到 `8.3` 之间的任意版本即可。

接下来我们看看它怎么安装。

（文末有下载包及其他所需辅助安装文件）



先将 `phpipam` 压缩包解压到 `web` 目录中。

接着找到 `config.dist.php` ，将其复制一份并命名为 `config.php` 。

图01



没错，看名字就知道这就是配置文件，用文本编辑软件打开它吧。

找到相关设置，比如数据库设定，修改为你的实际环境参数。

图02



还有另一个比较重要的设定，就是网址链接访问路径。

如果你的 `phpipam` 不是放在 `web` 站点的根目录中，那么就需要添加一下子目录路径。

比如你的站点子目录是 `phpipam` ，那么对于当前站点来说，它的相对根目录就应该在 `/phpipadm/` 上，而不是在 `/` 上。

```
# phpipam在根目录
define('BASE', "/")

# phpipam在子目录
define('BASE', "/phpipam/")
```

图03



如果安装过程中出现缺少 `PEAR` 支持的提示，那么我们需要安装 `PEAR` 。

图04



以管理员权限打开命令行窗口，切换到 `php.exe` 的相关路径下，执行以下命令安装 `pear` 。

```
php go-pear.phar
```

图05



`go-pear.phar` 可以不需要到网上查找，在文末就有最新版下载。

命令执行后，基本上可以一路无脑回车，不过需要注意的是，应该确保 `php.exe` 的 `CLI` （即命令行）路径务必要正确！

图06



其他提示下直接回车，最后完成安装。

图07



可以使用如下命令测试查看 `pear` 是否正常输出内容。

```
pear help
pear version
```

图08



如果出现错误，可能是 `pear.bat` 文件不存在造成的。

找到 `php.exe` 所在路径，看看是不是有个以 `pear` 开头并且以 `old` 结尾的文件。

如果有，将它重命名为 `pear.bat` 即可。

图09



如果还是有问题，那么可以将 `PEAR.php` 分别拷贝到以下 `phpipam`  路径中。

```
phpipam/PEAR.php
phpipam/function/PEAR/Net/PEAR.php
```

图10

图11



好，一切准备就绪后，我们在浏览器的地址栏中输入以下链接。

```
# phpipam放在根目录，就这样写
http://localhost
或者
http://ip

# phpipam放在子目录，就这样写
http://ip/phpipam
或者
http://localhost/phpipam
```



出现了安装界面，一般选择 `新的 phpipam 安装` 。

图12



紧接着就是安装数据库了，一般选择 `自动数据库 安装` 。

图13



填写数据库所必需的用户名、密码及名称等信息开始安装吧。

图14



然后给管理员一个密码，给网站起一个标题，保存 `Save settings` ！

图15



最后就可以登录我们的 `phpipam` 站点啦！

图16



登录进去看看吧，这个样子的。

图17



这个，怎么玩呢？

先简单介绍一下吧。

点击右上角的 `管理员` > `部门` 。

图18



接着添加一个新部门。

图19



给这个部门起个易于分辨的名字，然后设定好访问权限。

通常管理员 `Operators` 拥有读写权限 `rw` ，访客 `Guests` 则给个只读或干脆不给权限。

图20



有了部门，我们就可以在这个部门下面添加子网了。

图21



输入子网的IP和掩码，务必按 `CIDR` 格式填写，其他的可以酌情填写或不填写。

图22



其中的IP和掩码解析会用到前面的 `PEAR` 及一些其他 `php` 扩展，因此需要确保这些扩展已成功加载并且工作正常。

由于时间仓促给忙忘了，后续没有更进一步的记录。

其实官网上有很多详细的说明，但基本的使用方法就是这么简单，有兴趣的小伙伴可以参考官网文档。



**phpipam安装包（含所需辅助程序）**

下载链接：https://pan.baidu.com/s/157-q_0ufNHaDWblfEOXRiw

提取码：o84v



之后到了赴宴的那天，我按图索骥循着定位找到了那条美食街。

当我抬头望见那块牌匾之时，心中激动却已荡然无存。

只见那块牌匾上写着极其醒目的标准方正字体：正宗兰州拉面！

还好我并非那未经事的毛头小子，镇定几分后我鼻孔里边轻轻“哼”了一声。

看左右无人，心中暗道：要是搞错了还则罢了，要是没错，可别怪我不提还有自动IP扫描发现 `phpipam-agent` 这个茬……



**将技术融入生活，打造有趣之故事**

网管小贾 / sysadm.cc