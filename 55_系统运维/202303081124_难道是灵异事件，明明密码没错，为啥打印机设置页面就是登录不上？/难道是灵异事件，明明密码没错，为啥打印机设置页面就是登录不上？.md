难道是灵异事件，明明密码没错，为啥打印机设置页面就是登录不上？

副标题：难道是灵异事件，明明密码没错，为啥打印机设置页面就是登录不上？

英文：strange-event-even-if-the-password-is-correct-why-can-not-i-log-in-to-the-printer-settings-page

关键字：打印机,https,405,300,300 Multiple Choices,403 Forbidden,密码错误,password



最近加班挺猛，又赶上个周日还得上班，这样下去如何对得起躺平的小伙伴们，吾辈颜面何存！

于是乎哥几个一商议，约着某日大家早点下班，凑一块儿开个扒体喝个小酒，吐吐槽、解解闷。



酒过三巡，菜没几个，哥几个慢慢的话就多了起来。

一阵七嘴八舌过后，大家伙一商量，要不干脆轮流说说自己遇到的奇葩闹心事吧！

小酒一杯下了肚，轮到我来开个头。

得，那我就献丑给大家说一说最近我遇到的一桩奇葩故事吧！



就在前不久的一天，百忙之中的我趁着老板打电话的功夫上了趟厕所。

好家伙，给我憋坏了，就在我骄傲地站在小便池前时，突然我用余光看到旁边距离我隔着两个位置的小便池居然自动冲起了水。

我立马一哆嗦，当时就不敢骄傲了，看了看那个方向，没人啊！

又看了看其他 `VIP` 蹲位，一个人没有！

来回瞅了半天，整个厕所压根就只有我一个人！

我咽下口水，大前门只拉了一半就落荒而逃……



正在我惊魂未定之时，冷不丁一只手搭在我肩膀上。

我攥起拳头就想回头猛击，我打你个王八龟儿子……

一回头，好么，出现了一张老板微笑的脸庞。



“老板早！”还好我反应快，顺势给老板敬了个礼！

“你快去看看，他们反映打印机有问题打不了，赶紧处理一下！”

“好的，老板！我马上去！”



就前两天，公司新添加了几台 `HP LaserJet Pro 4004` 系列的打印机。

一直工作的好好的，突然前一天出了问题，于是找我处理。

我一开始也没多想，先看看设置有没有问题吧！

于是我稳坐工位上，熟练地打开浏览器，输入打印机的 `IP` 地址，回车走起。

`Web` 管理页面顺利打开，并提示输入密码。

图01



密码…密码…多少来着？

哦，想起来了，123456……

结果把我这小脸打得啪啪作响，提示密码错误！

图02



这…不能啊！

一般情况下我不会留多复杂的密码啊，我这都快过40大寿的人了，也记不住那么多密码啊！

换了几个密码，又尝试了几遍，无疑都失败了！

问了问其他人，也确认没有修改过密码。

再仔细回忆回忆，遥记得上周我还登录设置来着，密码绝对不会有错，这就搞笑了，到底是怎么回事？



遇到问题就要解决它，办法总比困难多，嗬，我咋想起这鸡汤话来了！

不过不解决是真不行啊，要不老板又多了个给你加班的理由了。

于是我果断打开浏览器的调试窗口，看到了如下的错误提示。

```
GET请求    https://192.168.1.123/AuthChk
返回状态    403 Forbidden
响应信息	空
```

图03



通过图中我们可以看到，在我登录提交密码时， `GET` 请求是发送到 `/AuthChk` 路径上的。

观其字面意思，很明显是指检查认证，提交路径是没问题的。

不过接着查看，好像返回的响应不正常，啥都没有的样子啊！

图04



看返回的状态码是 `403 Forbidden` 禁止访问，好像是密码错误登录失败，但的确我记得密码就是这个，这就很奇怪了！



然而我再反复尝试过后，发现同样是请求 `AuthChk` 返回的状态码又变成了 `300 Multiple Choices`  。

真是奇哉怪也，怪事频频！

```
GET请求    https://192.168.1.123/AuthChk
返回状态    300 Multiple Choices
响应信息	空
```

图05



最后我总结了一下，当我打开登录页面时，它的状态是 `403` ，而当我提交密码时，它的状态又变成了 `300` ，总之是无法成功登录。

这一不正常现象让我一度怀疑我的电脑出了问题。

好吧，我干脆跑到车间的电脑上，直接尝试访问打印机。

结果邪门的事情出现了，我去，居然可以正常登录！



吓得我赶紧在胸前划了个十字，然后打开调试窗口，仔细一瞧，请求 `AuthChk` 没错，不过这次居然正常返回了响应信息。

```
{"hasAuth": true}
```

图06

图07



是的，你没看错，返回了一个 `Json` 格式的字符串，我盲猜应该是可以或允许认证的意思。

虽然不是通过认证的意思，但至少事情发生了变化，问题解决也就有转圜的余地。

经过对比前后发生的变化以及不同之处，我这才发现，同样是访问同一台打印机，前后使用的 `IP` 地址居然是不一样的！

这是怎么回事呢？



原来啊，生产车间与办公区域通过防火墙隔离开来，两者之间通讯可能是通过路由或 `NAT` 映射的方式实现的。

因此相当于是在两个不同的局域网内访问同一台打印机，所以说使用的 `IP` 地址不是一个。

比如，办公区使用的 `IP` 地址是 `192.168.1.x` ，而生产区的 `IP` 地址是 `192.168.100.x` 。

```
办公区 --- 192.168.1.x
生产区 --- 192.168.100.x
```



说到这儿肯定会有小伙伴会说，即使 `IP` 地址不同，那不都是同一台打印机，连登录页面都打开了，会有什么问题？

是的，我一开始也是这么想的，百思不得其解。

不过经过我1个小时36分07秒的思考后，这才发现，它们都是以 `https` 开头加 `IP` 地址的形式来访问的。

哈哈，估计又有人说了，那还不是一个样，有啥区别？

是啊，我也感叹，问题太过刁钻，人生苦短啊！

其实说白了，这个问题很可能就出在 `https` 的加密认证上，要知道 `https` 访问证书通常不会以 `IP` 地址的形式申请的。

什么意思？

简单地说就是，`https` 证书决定了你最好是用域名的形式来访问网址，而不是用 `IP` 地址的形式。

有过申请 `https` 证书的小伙伴们应该有过经验，哪怕是自签名证书，证书中的 `通用信息` ，  `IP` 地址是不建议的，而应该填写域名。

图08



虽然我说得有点啰嗦，但这至少是个解决问题的突破口。

想到这儿，我翻找出之前打印机的备忘记录，找到了当时登记的打印机的主机名称。

随后我尝试改用主机名称（域名）的形式来访问打印机设置页面。

```
https://hpxxxxxx/
```

这时奇迹终于出现了，终于响应信息就这么来了！

图09

图10



小伙伴们可以看一下图中，我是用打印机域名来访问它的，而非 `IP` 地址。

再回过头看看前面的截图，很容易看出是用 `IP` 地址直接访问的。

好了，之后也就没啥稀奇了，试着输入我的万能密码，点击提交登录！

OK，这下没跑了，成功登录，哇哈哈！

图11



不错不错，再确认一下成功登录是个啥样子。

出现了 `PwdChk` 的请求路径，并且返回了 `hasPwd: true` 这样的响应。

```
GET请求    https://192.168.1.123/PwdChk
返回状态    200 OK
响应信息	{hasPwd: true}
```



至此真相大白，打完收工！



“喂喂…打住打住……少说工作的事哈！”

“你还没说明白，那个厕所诡异事件是不是真的啊？！”

我正说得带劲，只见在座的各位脸上泛着红晕，都埋怨我老是三句话不离工作。

好吧，的确这是真事，为了听上去不像走进科学系列，后来我听人说估计是那个位置靠近窗户，大概齐由于光线的原因导致小便池感应器敏感触发了冲水动作。

其实日常生活中解释不了的事情不在少数，我们也不必过于惊慌失措。

就好比我们面临工作上的诸多奇葩事情，又有谁能解释得清楚呢？



**将技术融入生活，打造有趣之故事**

网管小贾 / sysadm.cc