磁盘空间不足的红色警告条到底能不能关闭？

副标题：还剩100多个G就空间不足啦？

英文：is-it-possable-to-turn-off-low-disk-space-red-indicator-bar

关键字：low,disk,space,win10,red,indicator,usage,bar



直到之前的某一天，我的 C 盘突然变红了，我才意识到我应该清理一下磁盘空间了。

可是翻来覆去整了半天，也没有什么好清理的，我的 C 盘就这样依然保持着刺眼的红色。

我再仔细打量了一番我的 C 盘，发现它还有 10 多个 G 的空间，这就不让人放东西了？

我有些坐不住了，这么欺负人的设定是怎么搞出来的？

图1



翻看了小半个互联网，我才发现和我遭遇此类问题的人还真不少，其中不乏众多老外。

还有 100 多个 G 的空间，那得放多少小姐姐啊！

拥有大容量硬盘的老外发出惊叹之余也让我们深刻体会到了他所遭受的心灵伤害。

图2



在为老外祈祷的同时，当我通过开始菜单，依次打开 `设置` > `系统` > `存储` 后，我发现同样的剩余空间比例之下，此处我的 C 盘并没有变红。

我发出了小岳岳一般的喊声，我的天呐，这是怎么回事？

图3



随后我故意丢了几个文件进去之后，此处的 C 盘也变红了，难道文件资源管理器和这里的显示不一致吗？

此时此刻我的脑海中不禁蹦出一个大大的问号，这到底是一个怎样的设定？



### 怎样的设定

搜索网络，包括微软官方的论坛中，我们大概地可以得出一个结论，那就是当磁盘剩余空间低于 10% 时，状态条就会变成红色，警告使用者是时候要清理磁盘了。

我用计算器简单地算了一下，的确如结论所述，大致在低于 9% 或 8% 时，状态条就红了。

那为什么是 10% 呢？



### 为什么是 10%

我没有找到官方的确切说法，但在某论坛上，似乎有位网友简单地阐述了原因。

> The ways relatively intelligent filesystems try to reduce file fragmentation as new files are created and old ones extended can backfire badly when space is low because the space that is left becomes very fragmented, so by the time you are down to 10Gb that could be lots of blocks no more than a few blocks in size.
>
> So while 10% might be over doing it for large drives for most uses, letting a filesystem get to 1% before warning could cause noticeable inefficiency.



我猜测大致意思是，剩余空间很容易碎片化，当只剩下 10G 的空间时，碎片化变得非常严重，就会影响到系统性能和效率，所以如此设定的缘故即是早一些提醒用户清理空间，以免降低系统性能。

此外 Windows 为了保证安装更新等等原因，也需要保留不小的一块空间。

如此说来，按 10G 剩余空间占 10% 的比例来算的话，那么这个磁盘应该在 100G 左右。

可是我的磁盘它要是有 1000G ，难道还会怕剩下 100G 的碎片化空间吗？

那可以不理会它吗？

感觉似乎是可以的，它只是个警告，只不过看着有点碍眼不是吗？

那有没有什么地方可以把它给改了？

比如将 10% 改成 5%。



### 可以设定百分比吗

在早期的网络上似乎流传着一种方法，可以通过注册表来修改磁盘空间报警比例。

找到如下注册表项，新建一个 `DWord` 类型的键 `DiskSpaceThreshold` ，将其值设定为 0 到 99 即可表示 0% 到 99% 的比例。

其默认值正是 10% 。

```
Windows Registry Editor Version 5.00

[HKEY_LOCAL_MACHINE\SYSTEM\CurrentControlSet\Services\LanmanServer\Parameters]
"DiskSpaceThreshold"=dword:10
```

除此之外，还有一个名为 `LowDiskSpaceMinimum` 的注册表键，指的是剩余空间的最小值，其默认值是 `400MB` 。



这似乎是个绝佳的答案，我们可以任意调整我们想要的报警比例。

但是非常遗憾，通过测试甚至观察这些文章或帖子是2011年左右的发布时间来看，我想你也可能猜到些什么。

是的，这种方法太过完美，但它只存在于 `XP/2003` 时代，总之对于我们的 Win10 是无效的。



### 关闭磁盘空间不足警告的传言

网络上流传甚广的关于关闭磁盘空间不足警告的方法之一，就是我们现在要说的这个。

通过修或新建改注册表键值来达到目的。

>  禁用-磁盘空间不足警告
>
> `NoLowDiskSpaceChecks`（DWORD 1）

甚至出现了关于此项因系统版本不同而导致其所在位置不同的说法。

> Win10之前，注册表项位于 HKEY_CURRENT_USER
> HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer
>
> Win10之后，注册表项位于 HKEY_LOCAL_MACHINE
> HKEY_LOCAL_MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer



不过这并不是我们想要的，因为它只是关闭了系统托盘处的警告消息，红条依然颜色鲜明地横在那里。

真是可惜了，可是这个红条真的很碍眼啊，要不我们把它直接关掉？



### 关闭红色状态条

10% 这个比例值应该是 Windows 固定在系统中的设定，我们无法改变它。

那么有可能将红色状态条关闭吗，毕竟它只是个警告，眼不见心不烦。

你别说，还真有，方法也是修改注册表。



找到如下注册表项。

```
HKEY_LOCAL_MACHINE\SOFTWARE\Classes\Drive
```

找到注册表键 `TileInfo` ，我们修改它就行了。



**修改前键值为：**

```
prop:*System.PercentFull;System.Computer.DecoratedFreeSpace;System.Volume.FileSystem
```

将键值中的 `System.PercentFull;` 删除（注意有一个分号）。



**修改后键值为：**

```
prop:*System.Computer.DecoratedFreeSpace;System.Volume.FileSystem
```



很明显，被删除的 `System.PercentFull;` 应该表示的就是那个状态条，删除后即为将其隐藏而不再显示。

图4



除此这外还有其他类似的注册表键，如 `PreviewDetails` 表示详细预览，其键值也如之前可修改隐藏状态条。

修改之后磁盘总空间及剩余空间仍有显示，我们仍然可以观察到磁盘空间的使用情况。

最后别忘记重启电脑生效。



### 及时清理磁盘空间

红色状态条虽然被我们给关了，但毕竟它还在那儿，磁盘空间低于 10% 的问题本质并没有改变啊！

好像有点掩耳盗铃的感觉，那如何是好？

说一千道一万，最初我们讨论的系统为什么要有 10% 报警的设定，其实就是让我们大家及时地清理不必要的文件来释放空间。

那么问题来了，如何清理磁盘空间呢？



方法有很多，大概有这么几种。

* 删除不必要的文件
* 转移应用程序到其他磁盘
* 减少交换文件和休眠文件的大小
* 减少或删除系统还原空间的大小
* 清空回收站
* 及时备份，转移文件
* 扩展磁盘空间容量
* 其他一切让磁盘剩余空间大起来的方法



具体如何操作，可能一两句话说不清楚了，可以参考一下网络。

总之定时整理文件应该成为我们的一个好习惯。



### 最后的话

随着磁盘容量的日益增长，似乎 10% 的剩余空间警告有点不合时宜。

这也是被网络上不少网友所诟病的原因之一。

随处可见的 T 级容量硬盘，还有几百G剩余空间就被标记以红色，我想换谁都不太情愿吧。

而我折腾了一番后所得出的结论是，目前看我们是无法改变这一设定的。

唯一让自己不堵心的办法，就只能是将红色状态条隐藏起来。

虽然我们可以继续往磁盘里放我们喜欢的东西，但是这多少有点此地无银三百两的感觉哈。

不过希望在不久的将来，官方能做出相应的调整，毕竟固态硬盘已然成为了主流，而固态硬盘通常是没有碎片化概念的。

话说到这儿，各位小伙伴，你们中不会真的有人开启了固态硬盘的磁盘整理优化吧？

如果是，那么我要恭喜你了，请早做换新打算，哇哈哈！



**扫码关注@网管小贾，阅读更多**

**网管小贾的博客 / www.sysadm.cc**
