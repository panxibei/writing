下载的文档打不开是什么鬼

副标题：原来是附件管理器的锅



某日，正在处理项目的我接到用户求助，说是系统某个模块功能有异常。

跑去一看，原来是从系统中下载的模板文档打开出错。

这个模板损坏了？

文档在服务端的路径有问题？

还是用户的电脑出了问题？

脑中浮现出无数个问号，好吧，我先到测试环境下调试看看吧。

回到座位，打开 `firefox`，登录测试系统，下载模板，打开模板，一切是那么的顺利。。。

同样再打开生产系统，登录，下载，打开，WHAT？！问题再次出现了！



图1



不会吧！难道是服务端系统真的有什么不测？

我紧张地抓着鼠标，手心有点冒汗。

我努力让自己冷静下来，大致地回忆了一下近期修改代码的场景，可以肯定的是，即使有改动的部分，但也不涉及到出现问题的这部分功能啊。

换个浏览器，用 `chrome` 问题依旧。

这都是什么鬼啊？

病急乱投医，此时就靠乱猜了，会不会是文档权限问题，会不会是文档属性只读？

顺手右键点击文档，查看起了属性信息。

唉？这是什么？



图2



发现了这段提示，会不会和现在的问题有关？

尝试着钩选 `解除锁定`，点击 `确定`。

再打开试试，嘿，居然成功进入文档了！

再下载别一个模板文档，解除锁定后也正常打开！

我的天，这么神奇吗！

不过每次下载后都要这么操作一下的确有些讨厌啊喂！

方向明确就好办了，于是查找了有关资料，做了以下整理，分享给大家参考。



这次的问题根源是由一个叫做 `附件管理器（Attachment Manager）`的安全机制引起的。

一般来讲，通过浏览器下载的文档，都会被它检查处理。

好吧，我不要你觉得安全，我要我觉得安全。

再烦就把你关掉！

超级简单的方法：

复制以下文本到文本文件，保存为reg格式后，双击导入注册表即可。

导入成功后记得要重新启动电脑才能生效哦！

```vbscript
Windows Registry Editor Version 5.00

[HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Policies\Attachments]
"SaveZoneInformation"=dword:00000001
```

好了，问题找到了，马上回复用户处理。

懒懒的同学可以直接下载链接文件导入。

https://t.cn/A6zRryGJ 密码：s39h

**网管小贾**