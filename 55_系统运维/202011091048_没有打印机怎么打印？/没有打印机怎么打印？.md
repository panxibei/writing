没有打印机怎么打印？

副标题：虚拟打印了解一下



上周末应流浪哥邀请做客，到他家时他正忙于双十一购物。

见我来了，他迫不及待的问我：“如果一台不联网的电脑，同时又没有连接任何打印机，想要打印东西应该怎么办？”

他狡黠地微笑着表示如果我能帮他解决这个问题，那他就可以省下一台打印机的钱。

我瞅了一眼他购物车里的网红打印机，心想，不愧是久经沙场的老将，早已深谙商家的各种算计，搞了半天算计到我这儿来了啊！

这个问题嘛...我低头沉思，开始搜肠刮肚找起了办法。



猛然间我想了 `XPS Viewer` ，通常 `Windows` 系统都有预装 `Microsoft XPS Document Writer` 虚拟打印机。

完全可以先把内容打印成 `xps` 或 `oxps` 虚拟文件然后再用 `XPS Viewer` 打印。

图1



如果是 `Windows7` ，那么只要在 `控制面板 > 程序 > 打开或关闭 Windows 功能` 里开启 `XPS Viewer` 即可。

图2



如果是 `Windows10` ，那么只要在 `开始 > 设置 > 应用 > 可选功能 > 添加功能` 里安装 `XPS 查看器` 即可。

图3









### 寻找安装源（包）

搜索到网站上相关的帖子链接：

```
https://social.technet.microsoft.com/Forums/en-US/0acc5178-9336-41b6-8a0f-ae4ea1ced453/feature-on-demand-empty-add-xps-viewver-win1803?forum=winserverwsus
```

找到安装源（包）应该是这个样子的

图



于是再一次利用联网安装找出了系统自动下载的安装源（包）。

路径如下，`135dad3ce3fd44ea6c6aa650cb70f324` 应该是临时命名的文件夹名称。

```
C:\Windows\SoftwareDistribution\Download\135dad3ce3fd44ea6c6aa650cb70f324
```

图





### 尝试离线安装 `XPS.Viewer`





获取映像中关于 `XPS.Viewer` 的功能信息。

```
Dism /Online /Get-CapabilityInfo /CapabilityName:XPS.Viewer~~~~0.0.1.0
```

图11



将 `XPS.Viewer` 功能添加到系统中。

```
Dism /Online /Add-Capability /CapabilityName:XPS.Viewer~~~~0.0.1.0
```

图12



此时会报错，因为它会自动尝试连接网络下载安装。

我们没有联网，当然会出错了，所以必须要指定安装源（包）才可以。

源路径为 `C:\sysadm` ，即存放文件 `Microsoft-Windows-Xps-Xps-Viewer-Opt-Package~31bf3856ad364e35~amd64~~.cab` 的目录。

```
Dism /Online /Add-Capability /CapabilityName:XPS.Viewer~~~~0.0.1.0 /LimitAccess /Source:"C:\sysadm"
```

图13



这样就可以安装成功了。

我测试用的系统版本是 `Windows 10 2004 (19041.208)` ，仅供参考。

下载链接：[Microsoft-Windows-Xps-Xps-Viewer-Opt-Package~31bf3856ad364e35~amd64~~.cab](http://#)





Windows 10 2004 (19041.208)