糟糕，电脑密码忘了，不用U盘还有救吗？

副标题：糟糕，电脑密码忘了，不用U盘还有救吗？

英文：

关键字：



年迈的老山姆晕倒不省人事被送医院，至今仍在昏迷中。

他的三个儿子为了遗产发生了争执。



一台特制的电脑是老山姆心爱之物，外面包着铁皮，里面藏着秘密。

通上电打开电脑，`Windows` 系统正常启动，可是却卡在了登录界面。

谁也不知道密码是什么，进不去系统什么都白搭！

这可怎么办？

只有拿到电脑里保存的银行密钥才能从银行领到那笔遗产，这伙人议论纷纷，谁也拿不出个主意。



恰巧简睿路过小镇，他的好奇心被聚集的人群吸引。

人群中有小镇的警察杰克，他一眼就认出了简睿。

“尊敬的先生，您怎么在这儿？”

“一定是上帝的旨意让您出现在这里，请您帮个忙吧！”

简睿拉了拉厚重的口罩，心说这你也能认出来，得，看热闹不怕管闲事，说来就来哈！



简睿走进屋内，一番查看后对警察杰克说，只能试一试，不敢保证一定能解决。

一顿噼里啪啦骚操作唬得众人私下里交头接耳，这定是位高人啊！

一盏茶的功夫，简睿手捻须髯笑道：原来如此......



### 还原真相

诸位，我说两句

`SAM` 文件是个啥？

`SAM` 是英文 `Security Account Manager` 的缩写，翻译过来就是 `安全账号管理器` 的意思。

简单地说就是这个 `SAM` 文件专门保存了 `Windows` 系统的账号及密码信息。

它里面有安全标识，相当于人的身份证号码，是唯一的，即使同名同姓的两个人也是拥有不同的安全标识。

这其中还存着密码，不过肯定不是明文了，都是些哈希值，给你看你也只会眼晕，没法直接用。



就是这么一个玩意，虽然通常情况下被系统锁定无法访问，但是至少并不是无坚不摧的，还是有一点点突破口的。

那怎么突然这玩意呢？

常规做法是，将当前系统挂载到其他系统中后，通过工具软件清除密码。

为啥非要挂在其他系统上？

你可以试一下子，反正我试过了，结果就像这样。

图a01



之所以无法修改密码，正是因为 `SAM` 里放的是一串串哈希值，这玩意算法不可逆，猜不出来明文密码是啥。

因此清除密码就成了无奈之举，但至少无伤大雅，对系统没有任何影响，接着奏乐接着舞！





还原真相

### 当前系统中建立小分区。

打开 `计算机管理` ，找到 `磁盘管理` 。

右键点击最后一个分区（比如本例只有一个 `C` 盘），在弹出的菜单中选择 `压缩卷(H)...` 。

图d01



输入压缩空间量，比如 `8192` ，表示大约 `8G` 的容量。

这个分区不需要太大，但至少保持在 `4G` 以上比较合适。

图d02



点击 `压缩(S)` 后，我们就获得了一个 `8G` 大小的新分区。

图d03



接着，右击这个新分区，选择 `新建简单卷(I)...` 。

图d04



保持默认的卷大小，以及驱动器号等。

图d05

图d06



不过需要注意的是，文件系统必须选择 `FAT32` 格式。

图d07



OK，点击完成开始格式化，新分区就准备就绪了。

图d08

图d09



### 拷贝文件到新分区

利用 `PE` 盘生成启动及程序文件，然后将它们直接拷贝到刚刚建立好的新分区中。

图d10



具体如何制作我就不啰嗦了，我把文件放这儿，小伙伴们有需要拿去用就行了。



下载链接：





注意，如果你拷贝的文件是隐藏属性，那么可以用以下命令将它们的隐藏属性去除。

```
cd E:
attrib -r -s -h ./* /s /d
```

命令的意思是，先进入新分区（比如 `E` 盘），然后用 `ATTRIB` 命令把所有文件和文件夹的只读隐藏属性清除。

我提供的文件没有隐藏属性，一般来说这一步可以跳过。





### 从新分区启动

这里需要说明一下，前面拷贝的文件仅支持 `UEFI` 启动方式（现在较新的电脑都支持）。

想要从新分区启动，需要我们眼疾手快具有一定的武功段位。

OK，注意看，是这么个操作法！



当系统正常启动时，我们看到启动画面 `LOGO` ，并且气泡正在旋转，这时我们直接按住电源按钮不放，直到关机。

过几秒我们开机，然后等到 `LOGO` 画面加气泡旋转时再次按住电源按钮不放直到关机。

好，如此这般，通常这么干两次以上，系统开机就会进入自动修复程序。

图f01



稍等一会儿，我们就可以看到这样的画面，然后选择 `高级选项` 。

图f02



接下来再选择 `使用设备` 。

图f03



好，我们可以看到有好几项，我们选择 `EFI Internal Shell` 。

图f04



这是加载 `EFI`  `Shell` 程序的入口。

等到 `Shell>` 提示符出现后，依次输入以下命令并回车。

```
fs1:
efi\boot\bootx64.efi
```



在这儿我们需要注意两点。

一，`fs1:` 最后面有个英文冒号，别忘记。

二，`fsX:` 中的 `X` 数字通常表示第几个分区。

如果前面我们建立的 `FAT32` 分区是第二个（比如 `D` 盘），那么它就应该是 `fs1:` （第一个是 `fs0:` ，即 `C` 盘）。

如果 `FAT32` 分区是第五个（比如 `G` 盘），那么它就应该是 `fs4:` ，以此类推。



不出意外的话，它就会启动 `PE` 盘了。

图f06



接下来就简单了，进入 `PE` 环境后，我们就可以利用 `NTPWEdit` 来修改或重置用户密码了。

图f07



### 重置用户密码

在这儿简单说下如何重置用户密码吧。

打开 `NTPWEdit` ，然后点击 `打开` 按钮。

通常 `SAM` 文件都在系统默认 `C` 盘，因此直接打开即可。

```
C:\Windows\System32\Config\SAM
```

图b01



打开后即可看到系统中的账号，找到我们要用的用户账号，点击 `修改密码` 。

图b02



如果要重置密码，那么直接点击确认就行了。

如果要设置新密码，那么就输入密码后再点击确认，灰常简单。

图b03



密码重置了，心情很愉快是不是？

可别高兴得太早了，如果你不保存修改的话，那么等于什么都没做哦！

图b04



顺便说一下，如果所选用户是被禁用的，那么 `解锁` 按钮会自动生效。

点击 `解锁` ，用户就被激活了，很容易理解吧？

图b05





### 写在最后







**将技术融入生活，打造有趣之故事**

网管小贾 / sysadm.cc

