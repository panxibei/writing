自动批量安装富士施乐打印机，真的很简单！

副标题：积极践行信息自动化~



今年（2020年）席卷全球的新冠疫情到底是好事还是坏事？

答案似乎众说纷纭，不过目前暂时看整个大环境下对中国来说可能利大于弊，是好事。

那么对于我们普通人来说呢？

我想，可能也是利大于弊的，有时人还是需要一些压力的。

就拿安装打印机这么简单得不能再简单的事儿来说，在疫情压力下都可以变得自动化起来，部署效率也比以往有了大大的提高。



有的小伙伴儿们会说，难道没有疫情就不能自动化部署了吗？

哈哈，其实我这儿只是举个例子，人往往喜欢偷懒的时候比较多。

事实上有更多的情况是，很多人情愿一台一台的安装，也不愿提高效率批量部署。

究其原因可能和近几年的内卷化概念有关，有兴趣的小伙伴儿们可以自行百度。



话说回来，以往是怎么安装打印机的？

安装本身很简单没花样，但至少你要移驾到用户那边，面对着用户的电脑屏幕，触摸着用户的键盘鼠标......

哎呀呀，是不是有些细思极恐呢？

好了放松，现在你可以暂时放下心，因为完全可以全自动安装，而不用跑东跑西，完全彻底高效地遵守着保持社交距离的准则。

正好手头有一台富士施乐5570一体机，废话不多说，我就拿它来简述自动安装的制作方法吧。



#### 从官方获取驱动程序包

打开富士施乐官网，搜索并转到 `ApeosPort 5570` 的驱动程序下载页面。

默认操作系统即为 `Windows 10 64bit` ，直接点击右侧下载按钮开始下载。

图1



下载完成，得到一个名称为 `fxap5570pcl6200610w616iml.exe` 的自解压程序包文件。

双击 `fxap5570pcl6200610w616iml.exe` 文件，自动解压到当前目录，同时自动打开安装向导。

图2



这里要先注意一下，如果想创建自动安装盘，必须要事先在本机上安装好打印机。

据此，先按通常方法安装好打印机，然后在此基础上开始创建自动安装盘。

在安装向导界面上，点击左下角的 `支持工具` ，接着点击 `制作驱动程序安装盘(C)` 。

图3



#### 创建自动安装盘

点选想要安装的打印机名称（刚才说了，必须先正常安装好），再点击 `创建安装盘` 按钮。

图4



安装盘设置界面中，需要确定好端口。

通常我们都是通过网络连接打印机的，故此处选择带IP地址的标准TCP/IP端口，点击 `创建安装盘(S)` 继续下一步。

图5



指定需要生成安装盘文件的目标文件夹路径，钩选 `设置时不显示画面` 。

图6



在选择 `允许一般用户执行(K)` 时，弹出 `管理员具体设定(S)` 。

域环境中通常批量安装需要域管理员权限，填写相应信息即可。

图7



点击 `确定` ，安装盘创建成功。

图8



OK，我们可以在前面指定的目标文件夹中找到新生成的安装盘文件。

以后只要在目标电脑上运行 `UserSetup.exe` 文件即可自动安装打印机了。

图9



如果你想修改设定，亦或是安装测试不够理想，那么可以直接在路径 `fxap5570pcl6200610w616iml\Software\MakeDisk\i386_amd64\Common` 下找到 `MakeDisk.exe` 文件，双击它就可以再次重新制作安装程序文件了。

图10



#### 批量部署实现自动安装

最后，就是想个办法让用户也能自动安装打印机而无需人工干预。

说白了就是如何调用 `UserSetup.exe` 来执行自动安装的问题。

这里使用批处理来实现，注意，卸载时打印机的名称一定要保证正确。

```
@echo off

echo.
echo 卸载已安装的打印机，避免重复安装
@START /b /w rundll32 printui.dll,PrintUIEntry /dl /n "FUJI XEROX ApeosPort 5570" /q

echo.
echo 开始安装打印机 ApeosPort 5570 .... 请稍等 ...."
@START /b /w \\Server\share\5570\UserSetup.exe

cls
echo.
echo "恭喜！！！打印机 ApeosPort 5570 安装成功！！！"
pause
```



将上面的代码保存为 `bat` 或 `cmd` 后缀的批处理文件，然后将它和之前制作的安装盘文件一同放到大家都能访问的共享文件夹内。

之后只要用户执行这个批处理文件即可自动实现卸载安装打印机操作了。



#### 结语

转眼2020年年底将近，我想，今年的年度关键字中肯定有“疫情”两个字。

不管是国家也好，还是个人也好，它给我们带来的究竟是灾难还是重生，只有等到疫情完全过去后才能定论。

但不管怎么样，我们每一个人每一天都是在进步的，因为年度关键字里还应有“真情”和“希望”！

待到挺过这场疫情，我们暮然回首时，想必我们每一个人都会更加健康，更加自信，对未来更加充满了希望！



> WeChat@网管小贾 | www.sysadm.cc

