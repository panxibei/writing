简单而快速地搞定 SQL Server 高可用

副标题：

英文：

关键字：



开场白



### 准备工作



##### 1、各系统命名、IP地址及功能备注

这里啰嗦几句，为了保证系统的可靠性（域名解析、故障转移和身份验证等），我们直接采用域环境的方式来搭建 `SQL Server` 高可用系统。

至于网络上还有使用证书验证的方式，反正我没有测试成功过，而且设定非常麻烦复杂又容易出错，所以我还是建议小伙伴们通过AD域环境来实现高可用。



* A89230	192.168.89.230	SQL Server 节点一

* A89231	192.168.89.231	SQL Server 节点二
* A89219	192.168.89.219	文件共享服务器（共享见证）
* A89220	192.168.89.220	AD 服务器（域名服务器）

* MSSql_Cluster	192.168.89.232	群集名称，虚拟 IP 地址

* MSSql_Listener	192.168.89.233	SQL Server Always On 可用性组侦听器，虚拟 IP 地址



##### 2、安装 `Net Framework 3.5` 





##### 3、安装 `故障转移群集管理器` 





##### 4、系统服务

确保系统服务是否正常启用并处于运行中

* 网络共享服务器 server

* 远程注册表服务 `Remote Registry`

* WMI 服务 `Windows Management Instrumentation`



##### 5、组策略

使用命令 `gpedit.msc` 打开组策略编辑器。

在窗口左侧依次找到 `计算机配置` > `Windows 设置` > `安全设置` > `本地策略` > `安全选项` 。

在窗口右侧找到 `网络访问：本地帐户的共享和安全模型` ，确保设定为 `经典 - 对本地用户进行身份验证，不改变其本来身份` 。



##### 6、防火墙

开启 `Windows Management Instrumentation (WMI)` 应用访问。

图？



1433和5022端口

