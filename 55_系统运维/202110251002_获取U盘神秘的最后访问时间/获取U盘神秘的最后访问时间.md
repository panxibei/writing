获取U盘神秘的最后访问时间

副标题：

英文：getting-the-last-mysterious-attach-timestamps-of-usb-flash-disk

关键字：usb,attach,timestamps,udisk,utc,time,插拨,时间,U盘





叮铃......“据最新消息，从11月1日起，《中华人民共和国个人信息保护法》正式实施......”。

叮、叮铃.......“据本台记者最新报道，我市公安局近期成功打掉一伙非法倒卖公民个人信息的犯罪团伙......”。

桌上的手机屏幕连续蹦出了几条新闻信息，可是简睿丝毫没有将目光从案件卷宗上移开的意思。

正在他若有所思的时候，蔡学飞从外面推门进来。



“师傅，您怎么还在这儿呢？“，蔡学飞风风火火地走近简睿，将一盒点心放在了简睿的面前。

蔡学飞一边打开盒子，一边埋怨道，”我就猜您还在办公室。您要是不回去休息可就会累垮的！”

正在思考中的简睿被蔡学飞打断了思路，倒也没生气，他看了一眼盒子里的东西，正是他喜欢吃的桃酥饼。

正好，肚子有点饿了，简睿也不客气，拿起一块桃酥饼吃了起来。

蔡学飞一瞅老师的吃相，扑哧乐了，“味道怎么样？这可是我珍藏了一个星期的高档点心，我爸都没舍得给他吃呢！”

简睿正想说话，没想到被桃酥噎呛得说不出话来，蔡学飞吓了一跳，立马递上水杯。

“您倒是慢点啊！您要是有个三长两短的，秦队可要拿我开刀了啊！”

“我三长两短，秦队干吗拿你开刀？”简睿喝了几口水，舒服多了。

“那我不是得把您的手艺学会学精嘛！我现在就一小菜鸟，啥也不会啊！”

“你还啥都不会啊，你不是正规警官学校毕业的？”简睿白了他一眼，拿起了第二块桃酥。

“嘿嘿，师傅见笑啦！我那点本事师傅还不知道嘛！”

“就拿最近那个个人信息倒卖案来说，要不是师傅，我们也不可能拿到指认胡莉莉的关键证据啊！”

蔡学飞嘻笑着凑近简睿耳边，“师傅，嘿嘿，其实我就想跟您请教来着，您是怎么从牛老二电脑里把胡莉莉的U盘使用时间记录给查出来的？”

简睿吞下最后一口桃酥，拍了拍手，“哦？你小子真想学？”

“那是那是，师傅本事多，徒弟我学个一两样的就能保我穿衣吃饭了。”









手动查看注册表中的属性项

如果你直接点击 `Properties` 这一项时，就会收到一个打开错误的提示。

上面写得很清楚，无法打开，拒绝访问，即便是管理员权限也会被拒之门外。

图a01



为什么到这里就打不开了呢？

我不知道原因，可能里面有一些秘密，它并不想让我们普通的用户知道吧。

那我就是想看看里面应该怎么办呢？

其实也是有办法的，需要设置权限，而这个权限就是我们一般用不到的 `SYSTEM` 权限。

这也就是我们用管理员权限也无法打开的缘故，`SYSTEM` 权限似乎更高级一些吧。

好了，我们来看看如何撬开这把需要 `SYSTEM` 权限的锁。



右键点击 `Properties` ，在菜单中选择 `权限(P)...` 。

图a04



来了个警告，没关系，只是警告而已，告诉你没有权限，但可以更改权限。

这不废话嘛，我就冲着修改权限来的，吓唬别人还行，我可不怕哈，点击确定忽略之。

图a05



打开的 `Properties` 权限窗口一片空白，别事，我们点击 `高级(V)` 按钮。

图a06



在 `Properties` 的高级安全设置中，窗口最上面的那个所有者一项，点击 `更改(C)` 。

图a07



在对象名称框中输入 `administrators` ，点击确定。

图a08



`Properties` 所有者更改为 `administrators` ，点击确定直到退出。

注意，不要勾选 `替换子容器和对象的所有者` ，可能会报错。

图a09



OK，这时由于所有者变更为管理员了，所以我们就允许任意添加权限了。

右键 `Properties` 项，选择 `权限(P)...` 后，在权限窗口中添加管理员为完全控制权限。

图a10



再来展开一下 `Properties` 项，你会发现可以看到里面的内容啦。

如果没有展开，可以按 `F5` 刷新一下。

图a11





随后按以下子项即可查询相应时间。

```
名称				属性路径

第一次安装时间		{83da6326-97a6-4088-9453-a1923f573b29}\0065
最后一次连接时间	{83da6326-97a6-4088-9453-a1923f573b29}\0066
最后一次拨出时间	{83da6326-97a6-4088-9453-a1923f573b29}\0067
```

图a12







自制USB时间记录查看器。

图a13







大尾端或小尾端的十六进制时间格式，可以参考以前我写的文章。

其中包括转换成直观可读格式的算法。

>参考前文：《十六进制的时间格式到底是个什么鬼？》
>
>链接：https://www.sysadm.cc/index.php/vbbiancheng/798-what-the-hell-is-hexadecimal-datetime-format

