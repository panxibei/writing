程序打开的历史记录怎么清除？

副标题：

英文：

关键字：MRU



程序打开的历史记录怎么清除？



### 快速访问

文件资源管理器的快速访问窗口中，罗列了我们最近使用的文件记录。

图01



```
C:\Users\用户名\AppData\Roaming\Microsoft\Windows\Recent
```

这个 `Recent` 文件夹往往显示为 `最近使用的项目` 这样一个名称。

图02



### 快速使用



右键点击任务栏图标，就会看到最近曾经打开过的文件记录项。

图03

图04



如果清除呢？

打开 `Windows` 设置，找到 `个性化` 。

图05



然后定位左侧导航栏到 `开始` ，在右侧的 `在“开始”菜单或任务栏的中转列表中以及文件资源管理器的“快速使用”中显示最近打开的项` 这一项下方点击开启或关闭按钮。

如果关闭的话，当我们再右键点击任务栏上的程序图标时，就不会看到以往打开过的文件记录了。

图06





### `Office` 记录

拿 `Excel` 举例，在 `选项` > `高级` 中，找到 `显示此数目的“最近使用的工作簿(R)”` 一项。

如果此项设定为大于 `0` 小于等于 `50` 的数字，那么我们在打开 `Excel` 时，首页面会呈现给我们最近访问过的数个文件记录。

图07

图08



`Office` 记录在以下注册表项中。

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\16.0\Excel\User MRU\ADAL_XXXXXXXX
```

图09



其中的 `Item` 项就是最近记录。

```
[F00000000][T01D87AF60CCE4DA0][O00000000]*C:\Users\用户名\Desktop\网管小贾的工作记录.xlsx
```

图10



看上去字符串的格式的固定的，其中以字母 `T` 开头的看上去像是十六进制的字符串实际上是时间戳，这在以前我写的文章中有过详细的解读，有兴趣的小伙伴可以去找来看看。

> 《十六进制的时间格式到底是个什么鬼？》





还有隐藏的地方。

### 对话框

不知道小伙伴们有没有一个体会，当我们打开或保存文档时，系统会自动帮我们定位到最后一次打开或保存文件的那个文件夹路径。

你肯定能猜到，系统又在“偷窥”我了，只是我们并不明白系统是怎么记录这些不同的程序它们最后一次的操作动作的呢？

这里我们就要说到以下注册表路径了。

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32
```



看着 `ComDlg32` 是不是有点眼熟呢？

没错，它就是对话框控件 `Common Dialogue` 嘛！

就在这个 `ComDlg32` 下面保存着我们平时使用程序的一举一动！



大概地 `ComDlg32` 有以下几个子项。

* `CIDSizeMRU` -  应用程序运行信息记录（针对应用程序）
* `FirstFolder` -  跟踪应用程序的安装位置（针对应用程序）
* `LastVisitedPidIMRU` - 跟踪最近访问的文件（针对应用程序）
* `LastVisitedPidIMRULegacy` - 跟踪最近访问的文件（32位）（针对应用程序）
* `OpenSavePidIMRU` - 跟踪最近打开保存的文件（针对被操作的对象文件）



它们各司其职，有具体负责的工作，不过它们之间也有一部分交叉内容，但总之都是为了尽最大可能地记录我们使用电脑所留下来的痕迹。



`OpenSavePidIMRU` 可分为各种扩展名以及星号 `*` ，这个星号是指所有扩展名（也包含没有扩展名的文件）文件。

因此我们也能知道，星号项所记录的多多少少会和具体扩展名项的内容有重复。

举几个例子吧！



看看最近我们都打开过哪些 `JPG` 图片。

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidIMRU\JPG
```

图11



再看看最近打开过哪些 `Excel` 文档。

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidIMRU\xlsx
```

图12



最后再看看最后访问的都有哪些文件。

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidIMRU
```

图13



看到这儿可能有的小伙伴会有点头晕，`LastVisitedPidIMRU` 和 `OpenSavePidIMRU` 到底有啥不一样，傻傻分不清啊！

其实我们可以理解为 `LastVisitedPidIMRU` 向我们展示了用于打开要保存在 `OpenSavePidIMRU` 中文件的应用程序。

也就是说，前者保存的是应用程序（工具），而后者则是具体你操作加工的对象文档文件（材料）。

比如我用记事本打开并保存了一个说明文件，那么 `LastVisitedPidIMRU` 保存的就是 `Notepad.exe` 的使用情况，而 `OpenSavePidIMRU` 则将说明文件的相关信息保留了下来。



此外，`ComDlg32` 各子项中，各个记录项的先后顺序并不一定从 `0` 开始往后排的，实际上它们的顺序应该参考 `MRUListEx` 这个二进制项。

`MRUListEx` 里面包含了实际的排序，八位十六进制数字为一个单元，比如下列图示中开头是 `3` 而并非 `0` 。

图14



还有其他一些关于最近使用记录的说明。

具体请参考以下链接说明。

> https://winreg-kb.readthedocs.io/en/latest/sources/explorer-keys/Most-recently-used.html



### 使用工具软件

如何查看前面介绍的这些历史记录呢？

难道还要文件夹、注册表里挨个翻找吗？

是啊，人生苦短，大家已经都很苦逼，就不要再浪费时间在一些小细节上面了，于是自然有大神出手，将我们解救了出来。

嗯，想必小伙伴们也听说过大名鼎鼎的 `Nirsoft` ，大神早已为我们准备好了一款神器软件：`RecentFilesView` ！

啥也不说了，拿来用就是了！

我们来看看它长啥样！



程序很简单小巧，打开就能自动读取最近的文件使用记录。

图15



这一大堆记录当中，有的是保存在 `“我最近的文档”文件夹` 。

图16



也有的是保存在 `注册表` 。

图17



要想删除这些记录也就变得非常简单了，都不用知道它具体存放的位置，直接右键再删除即可。

图18



这么好用的工具，当然要分享给大家了。



**recentfilesview.7z (77.8K)**

下载链接：

提取码：



### 写在最后







