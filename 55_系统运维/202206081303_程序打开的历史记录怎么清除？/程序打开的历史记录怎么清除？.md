程序打开的历史记录怎么清除？

副标题：

英文：

关键字：MRU



程序打开的历史记录怎么清除？





文件资源管理器的快速访问窗口中，罗列了我们最近使用的文件记录。

图y01



```
C:\Users\用户名\AppData\Roaming\Microsoft\Windows\Recent
```

这个 `Recent` 文件夹往往显示为 `最近使用的项目` 这样一个名称。

图b03







右键点击任务栏图标，就会看到最近曾经打开过的文件记录项。

图b01

图b02





### `Office` 记录

拿 `Excel` 举例，在 `选项` > `高级` 中，找到 `显示此数目的“最近使用的工作簿(R)”` 一项。

如果此项设定为大于 `0` 小于等于 `50` 的数字，那么我们在打开 `Excel` 时，首页面会呈现给我们最近访问过的数个文件记录。

图y04

图y05



`Office` 记录在以下注册表项中。

```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Office\16.0\Excel\User MRU\ADAL_XXXXXXXX
```

图b04



其中的 `Item` 项就是最近记录。

```
[F00000000][T01D87AF60CCE4DA0][O00000000]*C:\Users\用户名\Desktop\网管小贾的工作记录.xlsx
```

图b05



看上去字符串的格式的固定的，其中以字母 `T` 开头的看上去像是十六进制的字符串实际上是时间戳，这在以前我写的文章中有过详细的解读，有兴趣的小伙伴可以去找来看看。

> 《十六进制的时间格式到底是个什么鬼？》





还有隐藏的地方。

对话框





* `CIDSizeMRU` -  可以跟踪全局应用程序
* `FirstFolder` -  跟踪应用程序的安装位置
* `LastVisitedPidlMRU` - 跟踪最近访问的文件
* `LastVisitedPidlMRULegacy` - 跟踪最近访问的文件（32位）
* `OpenSavePidlMRU` - 跟踪最近打开保存的文件



其中各项记录的先后顺序并不一定从 `0` 开始往后排的，实际上它们的顺序应该参考 `MRUListEx` 这个二进制项。

`MRUListEx` 里面包含了实际的排序，八位十六进制数字为一个单元，比如下列图示中开头是 `3` 而并非 `0` 。

图y06





```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU\JPG
```

图c01



```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\OpenSavePidlMRU\xlsx
```

图c02



```
HKEY_CURRENT_USER\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ComDlg32\LastVisitedPidlMRU
```

图c03







参考说明：

> https://winreg-kb.readthedocs.io/en/latest/sources/explorer-keys/Most-recently-used.html



* `CIDSizeMRU` - 应用程序运行信息记录

* `LastVisitedPidlMRU` - 上次访问的文件
* `LastVisitedPidlMRULegacy` - 最近访问的文件夹
* `OpenSavePidlMRU` - 最近开启/储存的文件



应用程序运行信息记录在 `ComDlg32\CIDSizeMRU` 键中。

