Batocera

副标题：

英文：

关键字：





在 `Windows` 电脑上再加入 `Batocera` 游戏系统。



### 创建两个分区

打开 `磁盘管理` ，找到我们的硬盘。

如果你只有一块硬盘，那么就是它了，只要在这上面划拉个空间给 `Batocera` 就行了。

如果不止一块硬盘，那就根据你的个人喜好，只要有地方腾出来就行。

我在这儿只拿一块硬盘做演示，往下看你就知道，本质上是一样的。



首先找到 `C` 盘，看看能不能从这儿划一块地盘出来。

当然你想动 `D` 盘或其他盘的脑筋也不是不可以，只要空间够用就行。

图a01



右键点击 `C` 盘，点击菜单中的 `压缩卷(H)...` 。

图a02



先给空出 `16G` 的空间给引导分区吧，在 `输入压缩空间量(MB)(E)` 中打上 `16000` 。

图a03



点击 `压缩` 按钮后，我们就得到了一块 `16G` 大小的未分配空间。

图a04



右键刚才划分出来的未分配分区，在菜单中点击 `新建简单卷(I)...` 。

图a05



我们来创建两个新分区，先来个引导区，给 `8G` 空间就够了。

注意，需要给新分区分配一个盘符（此处是 `E` 盘），但不需要格式化它。

图a06

图a07

图a08

图a09

图a10



第一个引导用的新分区创建好后，它应该是这个样子滴。

图a11



紧接着，我们来创建第二个数据分区。

老一套手法，右键剩下的未分配空间并点击 `新建简单卷(I)...` 。

图b01



确认好卷大小后，给它分配一个盘符（此处是 `F` 盘），但是不用格式化。

图b02

图b03

图b04

图b05

图b06



最后，两个分区准备完毕，注意一定都要有盘符，否则后面不好操作哦！

图b07



### 解剖 `Batocera` 安装镜像

我们使用压缩软件管理器（比如 `7zip` ）打开 `Batocera` 的镜像文件，会发现它实际上包含了两个较小的镜像文件。

没错，你猜对了，这两个较小的镜像就是两个分区镜像。

在前面我们刚刚准备好了两个空白分区，就是为了将这两个镜像放回到上面去。

图c01



那这两个镜像怎么对应两个空白分区呢？

很简单，从名称和文件系统两个地方我们就能分辨出来。

我们先看名称，一个是 `vfat` ，另一个是 `userdata` 。

那么很清楚，前者是 `FAT` 引导分区，后者是用户数据分区，这样基本可以判定前者是以 `UEFI` 方式启动的。

我们再来文件系统，一个是 `Windows BDP` ，另一个是 `Linux Data` 。

也很清楚，前者的确是引导分区（ `Boot Disk Partition` ），而后者则是数据分区。

最后我们就可以得出结论了，引导镜像覆盖到第一个空白分区，用户数据镜像则覆盖到第二个空白分区。

* `vfat.img` - 第一空白分区
* `userdata.img` - 第二空白分区



可以说，网上绝大多数现存的 `Batocera` 安装镜像都可以这么解剖拆分。



### 如何将镜像放回到分区上？

关于这个问题，网上曾有大神通过先制作U盘然后再将U盘上的分区覆盖回硬盘分区的做法。

实际上并不需要这么麻烦，我们掌握了前面的解剖原理，可以说连U盘都不用。

不信？走着！



欲善其工，必先利器，在正式开始之前，我们需要准备好三样神器。

* `DiskGenius`
* `SysLinux`
* `Bootice`



下载地址：



小伙伴们，准备好了吗？

开始！

我们首先打开 `DiskGenius` ，在顶部菜单中找到 `工具` > `扇区复制` 。

这里插句话，对于前面介绍的分区操作，比较专业的小伙伴也可以用 `DG` 来分区。

如果你不太熟悉 `DG` 操作，那么并不建议你用它，专业工具比较危险哦！

图d01



在打开的 `扇区复制` 窗口中，我们点选 `源盘（或镜像文件）` 一项右侧的文件图标。

图d02



然后选择 `vfat.img` 镜像文件，这个就是引导镜像。

图d03



接着我们点选 `目标（或镜像文件）` 一项右侧的磁盘图标。

图d04



选择未格式化的第一个空白分区（此处是 `E` 盘）。

图d05



最后确认源镜像文件与目标盘是否选择正确，确认无误后点击 `复制` 按钮开始覆盖。

图d06

图d07



同样的操作，选择 `userdata.img` 镜像文件，将其覆盖到未格式化的第二个空白分区。

图d08



两个分区都覆盖操作完成后，`DG` 可能会提示分区错误。

这其实是指引导镜像原分区大小与现分区大小不一致的问题，实际上没有什么影响，我们直接点击 `取消` 忽略错误即可。

图d09



### 修改引导配置

如果我们制作的是U盘，那么由于U盘是一个独立的磁盘，因此在制作过程中系统会自动写入相应的分区信息。

但是现在情况有所不同了，我们是在现在有的硬盘上划分分区来制作的 `Batocera` ，所以我们还有一项工作要做，就是修改分区信息，让系统引导正确识别数据分区。

具体这么做。



在 `DG` 中，我们找到用户数据分区（就是 `Batocera` 第二个分区）的参数界面，记下这个分区的 `GUID` ，也就是它的身份证号（形如：xxxxxxx-xxxx-xxxx-xxxxxxxxxxxx）。

图d10



然后我们用记事本或其他什么文本编辑器打开 `Batocera` 引导分区（就是第一个分区）中一个叫 `batocera-boot.conf` 的配置文件。

将参数 `sharedevice` 修改成刚才我们记下的数据分区的 `GUID` 。

```
sharedevice=INTERAL

```





















```
X:
CD boot/syslinux
syslinux64.exe -f -d /boot/syslinux/ X:
```





不同机器开启按钮也不尽相同。

| 组装机主板   | 启动键     | 笔记本品牌     | 启动键          | 台式机电脑     | 启动键 |
| ------------ | ---------- | -------------- | --------------- | -------------- | ------ |
| 华硕主板     | F8         | 联想笔记本     | F12             | 联想台式机     | F12    |
| 技嘉主板     | F12        | 宏基笔记本     | F12             | 惠普台式机     | F12    |
| 微星主板     | F11        | 华硕笔记本     | ESC             | 宏基台式机     | F12    |
| 映泰主板     | F9         | 惠普笔记本     | F9              | 戴尔台式机     | ESC    |
| 梅捷主板     | ESC或F12   | 联想 Thinkpad  | F12             | 神舟台式机     | F12    |
| 七彩虹主板   | ESC或F11   | 戴尔笔记本     | F12             | 华硕台式机     | F8     |
| 华擎主板     | F11        | 神舟笔记本     | F12             | 方正台式机     | F12    |
| 斯巴达克主板 | ESC        | 东芝笔记本     | F12             | 清华同方台式机 | F12    |
| 昂达主板     | F11        | 三星笔记本     | F12             | 海尔台式机     | F12    |
| 双敏主板     | ESC        | IBM笔记本      | F12             | 明基台式机     | F8     |
| 翔升主板     | F10        | 富士通笔记本   | F12             |                |        |
| 精英主板     | ESC 或 F11 | 海尔笔记本     | F12             |                |        |
| 冠盟主板     | F11 或 F12 | 方正笔记本     | F12             |                |        |
| 富士康主板   | ESC 或 F12 | 清华同方笔记本 | F12             |                |        |
| 顶星主板     | F11 或 F12 | 微星笔记本     | F11             |                |        |
| 铭瑄主板     | ESC 或 F11 | 明基笔记本     | F9              |                |        |
| 盈通主板     | F8         | 技嘉笔记本     | F12             |                |        |
| 捷波主板     | ESC        | Gateway笔记本  | F12             |                |        |
| Intel主板    | F12        | eMachines      | F12             |                |        |
| 杰微主板     | ESC或F8    | 索尼笔记本     | ESC             |                |        |
| 致铭主板     | F12        | 苹果笔记本     | 长按 “option”键 |                |        |
| 磐英主板     | ESC        |                |                 |                |        |
| 磐正主板     | ESC        |                |                 |                |        |
| 冠铭主板     | F9         |                |                 |                |        |