OUTLOOK 缓存模式下调整缓存保留时间的滑动块为什么是灰色的？

副标题：我不仅找到了破解方法，而且还做了个方便的小工具~



周一上班的一大早，孔大力正忙得晕头转向，偏偏这个时候手机响了。

孔大力的第一反应是，这天煞的骚扰电话也太TMD敬业了吧，它们上班也这么早吗？

想到这儿，他看都没看就把电话给挂了。

从一数到九，不超过十秒钟，手机又响了。

平时悦耳的铃声，此时却异样地令人反感，孔大力无奈地接了电话。



“喂，哪位？”孔大力有点上火，提高了嗓门喊道。

“喂，大力哥吗？我是彼得啊！我是你老乡！”

“哪...哪个彼得？”孔大力一脸懵逼，这又是从哪儿蹦出来个外国老乡啊！

“哎，哥你真是贵人多忘事！我找你帮个忙啊，一会儿加我微信，我微信里跟你说吧！”

“Can you speak Eng......？”话未说完，电话已经挂断，孔大力两眼无神木木地呆在了原地。

好一会儿，孔大力缓了过来，噘着嘴心中居然暗暗感叹起如今的电信诈骗什么时候变得如此技高一筹。



正在胡思乱想之际，微信收到一条好友请求，留言自称是孔大力的老乡二柱子。

孔大力还以为第二次骗局即将开始，忽然间却想起在老家的确有这么一位老乡，当时鼻子就给气歪了。

好友请求通过后，还没等他发消息骂人，对方就先发了个笑脸。

“大力哥，我是二柱子。我现在在一家外企工作，公司里都用英文名，他们给我起个名叫彼得毕，所以一时叫习惯了没改过来，让你见笑了！”

“哎，好你个二柱子，你还英文名，你咋不叫比特币啊，多趁钱啊！”

“大力哥，让你笑话了，我有个小忙需要你帮忙啊！”

“你小子都外企白领了，还需要我给你帮忙？”

“瞧你说的，我算哪门子白领，我就一打工人。”

“行行，说吧，什么事儿？赶紧的，我这儿忙着呢。”

“好，那我就直说了，是这样，我们公司的 Outlook 只能看半年的邮件。最近我们领导要一份生产图表资料，我记得在去年的邮件里有，可我查起来太费劲了，还得等它下载完。于是我就想调整一下缓存保留时间，却发现我们公司系统有策略它调不了，那个滑块是灰色的。大力哥你给看看有什么办法，我这儿以后经常要查以前的邮件，这也太麻烦了......”

到这儿，孔大力总算是听明白了，“哦，我明白了，你是想要调整 Outlook 的缓存模式是吧？”

“对对对...一会我给你发个图，你帮忙看看哈，完了有空找你喝酒请你吃饭哈！好了你先忙，我就不打扰了哈，88！”

“行行行，有办法了我就回复你，88！”孔大力一听有酒喝，态度来了个180度大转弯。



过了一会儿，对方发来一张图片。

图1



孔大力一瞧，的确没办法移动滑块，然后他又打开自己的 Outlook ，发现自己的邮件缓存是可以调整时间的。

图2

图3

图4



嘿，这 `Outlook` 滑块无法移动，也就无法调整保留缓存邮件的时间了。

孔大力眯缝着眼睛，觉得这个问题倒挺有意思，以前也没碰到过，为了喝上一顿酒他决定研究一下。

他是怎么研究的，后来有没有喝上酒，我不得而知，但我也碰到了和他一样的问题，也就同样折腾了一番，也研究出了点东西。

当然我是没人请喝酒的，要是你可怜我的话就请先关注我的公众号吧，感谢！



#### 邮件缓存

这个缓存模式（Cached Mode）实际上是为了提高访问邮件的性能而临时性地将邮箱中的邮件以副本的方式事先下载到本地电脑中。

当我们读取邮件时，实际上我们看到的邮件只是下载到本地的副本。

虽然现在的网络速度比以往已经有很大的改善，但缓存模式依然还是有一定的作用。

其中它还有一个好处，就是可以在网络不好甚至没有网络的时候我们可以脱机处理邮件。

当网络恢复后，邮箱会自动读取或发送之前我们处理过的邮件。



既然缓存模式对我们还是有好处的，那么怎么有的时候滑块却无法移动从而无法调整保存时间呢？

有此公司为了统一管理系统，会统一制定相关的域组策略。

通常在 `Outlook` 批量导入或升级时，为了避免大量的邮件下载而挤占带宽，所以通过制定一定的策略来临时限制邮件缓存的保留时间。

而这正是导致调整滑块变成了灰色无法移动的原因所在。



#### 怎么做

想要把它变回来，一般可以通过组策略来解决这个问题，但是需要用到 `Office` 的组策略管理模板。

这个神操作感觉挺复杂，反正我怎么整都没折腾明白，请有懂行大神赐教。

不过我找到了通过修改注册表的方法来达到解锁滑块的目的。

这个方法就简单得多了，通常是如下路径：

```
HKEY_CURRENT_USER\Software\Policies\Microsoft\Office\xx.0\Outlook\Cached Mode
```

如果注册表中没有这一项，则可以新建之。

其中的 `xx.0` 应按照不同版本号替换，比如：

* Outlook 2016 = 16.0
* Outlook 2013 = 15.0
* Outlook 2010 = 14.0
* Outlook 2007 = 12.0
* Outlook 2003 = 11.0



在 `Cached Mode` 项下创建一个名为 `SyncWindowSetting`  的 `DWORD` 键，键值参考如下设定：

* 0 = 全部（整个邮箱）
* 1 = 1 个月
* 3 = 3 个月
* 6 = 6 个月
* 12 = 1 年
* 24 = 2 年
* 36 = 3 年（仅支持 Outlook 2016）
* 60 = 5 年（仅支持 Outlook 2016）



以上对于早期版本的 `Outlook` 来说基本完事了，但对于 `Outlook 2016` 则还有一个叫作 `SyncWindowSettingDays` 的特殊注册表键来另外设定特殊的时间范围。

* 3 = 3 天
* 7 = 1 周
* 14 = 2 周



很显然，这个特殊键值比一个月要小，同时又比0（不缓存）大。

而实际上对于 `Outlook 2016` 来说，`SyncWindowSetting`  和`SyncWindowSettingDays` 这两个键必须都要同时设定同时存在。

那么问题来了，同时使用这两个明显会产生歧义的键值会不会让系统产生冲突呢？

答案是，你要管好它它就不会乱来，一旦配置好某一项键值后，另一项键值则必须保持为0。

比如：

* 想将滑块移动到 `3天` ，那么应该配置 `SyncWindowSetting` 为 `0`，同时将 `SyncWindowSettingDays` 配置为 `3` 。
* 想将滑块移动到 `6个月` ，那么应该配置 `SyncWindowSetting` 为 `6`，同时将 `SyncWindowSettingDays` 配置为 `6` 。
* 想将滑块移动到 `全部` ，那么应该配置 `SyncWindowSetting` 为 `0`，同时将 `SyncWindowSettingDays` 配置为 `0` 。

图5



好，说到这儿，我们基本能明白这个缓存时间限制是怎么来的了，可是滑块好像还是灰色无法移动的啊？

没错哦，只要存在以上那两个键值，那么就是被锁定状态（灰色）。

其实只要你删除这两个键值，那么滑块就变得可以移动啦，是不是有点狗血的感觉？





#### 高效工具

前面说的方法真心简单，但手改注册表的操作是非常不人性滴！

有那时间偷个懒吃个瓜它不香吗？

好吧，操作都这么简单了，能不把它工具化嘛！

我做了个简单的小工具，拿去用用看吧。



首先，选择版本，比如 `365` 就可以选择第一项，和 `2016` 是通用的。

图6



其次，就可以移动滑块了，想怎么整就怎么整。

注意，这个时候 `Outlook` 里的滑块依然还是灰色的。

图7



最后，如果你觉得还是在 `Outlook` 中自己调整缓存保留时间方便，想让灰色滑动条变得可用，那么干脆彻底解锁。

图8



记得要管理员权限运行，每次调整或解锁后，`Outlook` 都要重新打开才能生效。

小工具，大用场，如果小伙伴们用着挺爽，记得点赞在看走一波哦！



**网管小贾的Outlook邮件缓存保留时间调节器**

下载链接：https://www.90pan.com/b2267073

提取码：071t



WeChat@网管小贾 | www.sysadm.cc

